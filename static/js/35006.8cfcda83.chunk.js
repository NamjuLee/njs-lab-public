"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[35006],{35006:(t,e,s)=>{s.r(e),s.d(e,{Demo300GA:()=>v});const o=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;e=e||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let s="";for(let o=0;o<t;o++){let t=Math.floor(Math.random()*e.length);s+=e.substring(t,t+1)}return s},i=t=>{let e=t.length,s=new Array(e);for(var o=0;o<e;++o)s[o]=o;return s.sort(((e,s)=>t[e]<t[s]?-1:t[e]>t[s]?1:0)),s};class n{constructor(){const t=new h(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"NJnamju6178607084");console.log(t.Evloution()),console.log(t.history),console.log(t.historyScore)}}class h{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"00110001";this.history=[],this.historyScore=[],this.keyword="00110001",this.numGeneration=5e3,this.numPopulation=100,this.best_sample=20,this.lucky_few=0,this.n_child=5,this.length=10,this.chance_of_mutation=.5,this.keyword=t,this.length=t.length,this.history=[]}Evloution(){let t=this.InitPopulation(this.numPopulation),e=0;for(let s=0;s<this.numGeneration;++s){const o=this.ComputeFitness(t,this.keyword),i=o.scoreOrdered,n=o.popOrdered;if(e=o.pred_len,1===i[0])return console.log('SUCCESS! The word is "'+n[0]),this.history.push(s+" Iter, Done: "+n[0]+", Score: "+i[0]),this.historyScore.push(i[0]),n[0];const h=this.Selection(n,this.best_sample,this.lucky_few,e),r=this.ComputeReproductions(h,this.n_child);t=this.ComputeMutations(r,this.chance_of_mutation),this.history.push(s+" Iter: "+n[0]+", Score: "+i[0]),this.historyScore.push(i[0])}return""}ComputeMutations(t,e){for(let s=0;s<t.length;++s)Math.random()<e&&(t[s]=this.Mutation(t[s]));return t}Mutation(t){const e=o(5),s=Math.fround(Math.random()*t.length);return i=t,n=s,h=e[0],i.substr(0,n)+h+i.substr(n+h.length);var i,n,h}ComputeReproductions(t,e){const s=[];for(let o=0;o<t.length/2;++o)for(let i=0;i<e;++i)s.push(this.Reproduction(t[o],t[t.length-1-o]));return s}Reproduction(t,e){let s="";for(let o=0;o<this.length;++o)Math.random()<.499?s+=t[o]:s+=e[o];return s}Selection(t,e,s,i){const n=[];for(let o=0;o<e;++o)n.push(t[o]);for(let o=0;o<s;++o){const s=Math.floor(Math.random()*(t.length-e));n.push(t[s+e])}for(;n.length<e+s;)n.push(o(i));return(t=>{let e=t.length;for(;e>1;){e--;let s=Math.floor(Math.random()*(e+1)),o=t[s];t[s]=t[e],t[e]=o}})(n),n}ComputeFitness(t,e){let s=-1;const o=[],n=[];for(let i=0;i<t.length;++i){const h=t[i],r=this.Fitness(e,h);r>0&&(s=h.length),o.push(h),n.push(r)}const h=i(n),r=[],l=[];for(let i=h.length-1;i>-1;--i)r.push(o[h[i]]),l.push(n[h[i]]);return{popOrdered:r,scoreOrdered:l,pred_len:s}}Fitness(t,e){let s=0;if(t.length!==e.length)return s;s+=.5;for(let o=0;o<t.length;++o)t[o]===e[o]&&(s+=1);return s/(t.length+.5)}InitPopulation(t){const e=[];for(let s=0;s<t;++s)e.push(o(this.length));return e}}const r=t=>t.param[0]*t.param[1]-t.param[2]+t.param[3];class l{constructor(){const t=new c(arguments.length>0&&void 0!==arguments[0]?arguments[0]:4);for(let e=0;e<100;++e)console.log(t.Evloution())}}class a{constructor(t){this.param=[],this.param=[];for(let e=0;e<t;++e)this.param.push(10*(Math.random()-.5))}mutation(){for(let t=0;t<this.param.length;++t)if(Math.random()<.5){const e=Math.random()-.5;this.param[t]+=e}}toString(){let t="";for(let e=0;e<this.param.length;++e)t+=this.param[e]+", ";return t}}class c{constructor(t){this.history=[],this.historyScore=[],this.numGeneration=200,this.numPopulation=100,this.best_sample=20,this.lucky_few=0,this.n_child=5,this.length=10,this.chance_of_mutation=.5,this.length=t,this.history=[]}Evloution(){let t=this.InitPopulation(this.numPopulation);for(let e=0;e<this.numGeneration;++e){const s=this.ComputeFitness(t),o=s.scoreOrdered,i=s.popOrdered;if(o[0]>.98)return console.log('SUCCESS! The word is "'+i[0]+'"',", Score: "+o[0]),console.log("compute: ",r(i[0])-500),this.history.push(e+" Iter, Done: "+i[0].toString()+", Score: "+o[0]),this.historyScore.push(o[0]),i[0];const n=this.Selection(i,this.best_sample,this.lucky_few),h=this.ComputeReproductions(n,this.n_child);t=this.ComputeMutations(h,this.chance_of_mutation),this.history.push(e+" Iter: "+i[0]+", Score: "+o[0]),this.historyScore.push(o[0])}}ComputeMutations(t,e){for(let s=0;s<t.length;++s)Math.random()<e&&t[s].mutation();return t}ComputeReproductions(t,e){const s=[];for(let o=0;o<t.length/2;++o)for(let i=0;i<e;++i)s.push(this.Reproduction(t[o],t[t.length-1-o]));return s}Reproduction(t,e){let s=new a(4);for(let o=0;o<t.param.length;++o)Math.random()<.499?s.param[o]+=t.param[o]:s.param[o]+=e.param[o];return s}Selection(t,e,s){const o=[];for(let i=0;i<e;++i)o.push(t[i]);for(let i=0;i<s;++i){const s=Math.floor(Math.random()*(t.length-e));o.push(t[s+e])}for(;o.length<e+s;)o.push(new a(4));return p(o),o}ComputeFitness(t){const e=[],s=[];for(let i=0;i<t.length;++i){const o=t[i],n=this.Fitness(o);e.push(o),s.push(n)}const o=i(s),n=[],h=[];for(let i=o.length-1;i>-1;--i)n.push(e[o[i]]),h.push(s[o[i]]);return{popOrdered:n,scoreOrdered:h}}Fitness(t){return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.02,s=r(t);return s-=500,Math.pow(1-e,Math.abs(s))}(t)}InitPopulation(t){const e=[];for(let s=0;s<t;++s)e.push(new a(4));return e}}const p=t=>{let e=t.length;for(;e>1;){e--;let s=Math.floor(Math.random()*(e+1)),o=t[s];t[s]=t[e],t[e]=o}};var u=s(70910);s(51899);class d{constructor(t){this.pathsOrigin=[],this.nodes=[],this.fitness=0,this.distance=0,this.pathsOrigin=t,this.nodes=[],this.fitness=0,this.distance=0;for(let e=0;e<this.pathsOrigin.length;++e)this.nodes.push(void 0)}generateIndividual(){for(let t=0;t<this.pathsOrigin.length;++t)this.setCityInit(t,this.pathsOrigin[t]);(0,u.TV)(this.nodes)}setCityInit(t,e){this.nodes[t]=e,this.fitness=0,this.distance=0}getFitness(){return 0===this.fitness&&(this.fitness=1/this.getDistance()),this.fitness}getDistance(){if(0===this.distance){let t=0;for(let e=0;e<this.nodes.length;++e){let s=this.nodes[e];if(s){let o;o=e===this.nodes.length-1?this.nodes[0]:this.nodes[e+1],o&&(t+=s.distanceTo(o))}}this.distance=t}return this.distance}containsCity(t){for(let e=0;e<this.nodes.length;++e)if(this.nodes[e]===t)return!0;return!1}}class g{constructor(t,e,s){this.paths=[],this.paths=[];for(let o=0;o<e;++o)this.paths.push(void 0);if(s)for(let o=0;o<e;++o){let e=new d(t);e.generateIndividual(),this.paths[o]=e}}getFittestPath(){let t=this.paths[0];for(let e=0;e<this.paths.length;++e){let s=this.paths[e];t&&s&&t.getFitness()<=s.getFitness()&&(t=s)}return t}}class f{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.05,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.nodes=void 0,this.mutationRate=void 0,this.nodeSize=void 0,this.elitism=void 0,this.nodes=t,this.mutationRate=e,this.nodeSize=s,this.elitism=o}evolvePopulation(t){const e=new g(this.nodes,t.paths.length,!1);let s=0;if(this.elitism){const o=t.getFittestPath();o&&(e.paths[0]=o,s=1)}for(let o=s;o<e.paths.length;++o){let s=this.tournamentSelection(t),i=this.tournamentSelection(t);if(s&&i){let t=this.crossover(s,i);e.paths[o]=t}}for(let o=s;o<e.paths.length;++o){let t=e.paths[o];t&&this.mutate(t)}return e}crossover(t,e){let s=new d(this.nodes),o=Math.floor(Math.random()*t.nodes.length),i=Math.floor(Math.random()*t.nodes.length);for(let n=0;n<s.nodes.length;++n){const e=t.nodes[n];e&&(o<i&&n>o&&n<i||o>i&&!1===(n<o&&n>i))&&s.setCityInit(n,e)}for(let n=0;n<e.nodes.length;++n){const t=e.nodes[n];if(t&&!1===s.containsCity(t))for(let e=0;e<s.nodes.length;++e)if(void 0===s.nodes[e]){s.setCityInit(e,t);break}}return s}mutate(t){for(let e=0;e<t.nodes.length;++e)if(Math.random()<this.mutationRate){let s=Math.floor(t.nodes.length*Math.random()),o=t.nodes[e],i=t.nodes[s];o&&i&&(t.setCityInit(s,o),t.setCityInit(e,i))}}tournamentSelection(t){let e=new g(this.nodes,this.nodeSize,!1);for(let s=0;s<this.nodeSize;++s){let o=Math.floor(Math.random()*t.paths.length);e.paths[s]=t.paths[o]}return e.getFittestPath()}}class m{static Init(){const t=new m;return console.log(t),t}constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.cities=void 0,this.placesAll=void 0,this.ga=void 0,this.pop=void 0,this.pathFittest=void 0,this.timer=0,this.cost=Number.MAX_VALUE,this.posByMouse=[],this.random=void 0,this.random=(0,u.MX)(t),this.posByMouse=[];for(let e=0;e<5;++e){let t=700*this.random()+50,e=700*this.random()+50;this.posByMouse.push([t,e])}this.init()}mouseClick(t,e){this.posByMouse.push([t,e]),this.init()}init(){let t=this.posByMouse.length;this.placesAll=[];for(let e=0;e<this.posByMouse.length;++e);this.pop=new g(this.placesAll,5,!0),this.pathFittest=this.pop.getFittestPath(),this.pathFittest&&console.log("Initial distance: "+this.pathFittest.getDistance()),this.ga=new f(this.placesAll,.1,t)}optimize(){if(this.pop=this.ga.evolvePopulation(this.pop),this.pathFittest=this.pop.getFittestPath(),this.pathFittest){const t=this.pathFittest.getDistance();t<this.cost&&(console.log("iter optimization",this.timer),console.log("Final distance: ",t),console.log("Solution:"),console.log(this.pathFittest),this.cost=t),this.timer++}}render(t,e){if(this.optimize(),t.fillStyle="#ff0000",t.strokeStyle="#ff0000",t.lineWidth=1,e)for(let s=0;s<this.placesAll.length;++s){t.beginPath();const e=this.placesAll[s];t.arc(e.vec.x,e.vec.y,10,0,2*Math.PI),t.closePath(),t.fill()}if(this.pathFittest)for(let s=0;s<this.pathFittest.nodes.length-1;s++){let e=this.pathFittest.nodes[s],o=this.pathFittest.nodes[s+1];e&&o&&(t.beginPath(),t.moveTo(e.vec.x,e.vec.y),t.lineTo(o.vec.x,o.vec.y),t.closePath(),t.stroke())}for(let s=0;s<this.placesAll.length;++s){t.beginPath();const e=this.placesAll[s];t.arc(e.vec.x,e.vec.y,10,0,2*Math.PI),t.closePath(),t.fill()}}}class v{static Init(t){new v(t)}constructor(t){this.divHost=void 0,this.asset=void 0,this.viewWrapper=void 0,this.graphicsCoreWrapper=void 0,this.sceneWrapper=void 0,this.io=void 0;const e=document.getElementById(t);e&&(this.divHost=e),new n("NJ3N6am8j"),function(){new l(arguments.length>0&&void 0!==arguments[0]?arguments[0]:4)}(4),m.Init(),console.log("GA..")}MouseEventController(t){this.sceneWrapper.activeCommandController.MouseEventController(t)}Resize(t,e){this.graphicsCoreWrapper.Resize(t,e)}Dispose(){this.graphicsCoreWrapper.Dispose(),this.sceneWrapper.Dispose()}Dummy(){}}}}]);
//# sourceMappingURL=35006.8cfcda83.chunk.js.map