{"version":3,"file":"static/js/5694.2a38084e.chunk.js","mappings":"kUAEaA,EAAQ,WAIjB,WAAYC,IAAe,oBAHpBA,aAAO,OACPC,cAAQ,OACRC,SAAG,EAENC,KAAKH,QAAUA,EAGfG,KAAKH,QAAQI,MAAMC,QAAU,OAC7BF,KAAKH,QAAQI,MAAME,WAAa,SAEhCH,KAAKD,IAAMK,SAASC,cAAc,OAClCL,KAAKD,IAAIE,MAAMK,WAAa,OAC5BN,KAAKD,IAAIE,MAAMM,YAAc,OAC7BP,KAAKD,IAAIE,MAAMO,gBAAkB,OACjCR,KAAKD,IAAIE,MAAMQ,MAAQ,SACvBT,KAAKD,IAAIE,MAAMS,OAAS,QACxBV,KAAKH,QAAQc,YAAYX,KAAKD,IAUlC,CAMC,OANA,+BACD,WAEI,IADAC,KAAKF,SAASc,UACPZ,KAAKH,QAAQgB,kBAChBb,KAAKH,QAAQiB,YAAYd,KAAKH,QAAQgB,iBAE9C,KAAC,EAjCgB,GAqCRE,EAAgB,WAezB,WAAYC,GAAqB,IAAD,4BAdhCA,cAAQ,OAERC,YAAM,OACNC,qBAAe,OACfC,aAAuB,IAAIC,EAAO,IAAK,IAAK,GAAG,KAE/CC,mBAA6B,EAAM,KAEnCC,SAAG,OACHC,SAAG,OAEHC,mBAA6B,GAAI,KACjCC,qBAA+B,EAG3BzB,KAAKgB,SAAWA,EAGhBhB,KAAKiB,OAASb,SAASC,cAAc,UACrCL,KAAKiB,OAAOhB,MAAMyB,WAAa,OAG/B1B,KAAKiB,OAAOR,MAAQ,IACpBT,KAAKiB,OAAOP,OAAS,IACrBM,EAASjB,IAAIY,YAAYX,KAAKiB,QAC9BjB,KAAKuB,IAAMvB,KAAKiB,OAAOU,WAAW,MAGlC3B,KAAKkB,gBAAkB,IAAIE,EAAO,EAAG,EAAG,GACxC,IAAIQ,EAAY,IAAIR,EAAO,EAAG,EAAG,GAC7BS,EAAS,IAAIT,EAAO,EAAG,EAAG,GAC1BU,GAAS,EAEb9B,KAAKiB,OAAOc,iBAAiB,aAAa,SAACC,GACvC,IAAQC,EAAqBD,EAArBC,QAASC,EAAYF,EAAZE,QACjBL,EAAOM,EAAIF,EACXJ,EAAOO,EAAIF,EACXJ,GAAS,CAEb,IACA9B,KAAKiB,OAAOc,iBAAiB,WAAW,SAACC,GACrC,GAAKF,EAAL,CACA,IAAQG,EAAqBD,EAArBC,QAASC,EAAYF,EAAZE,QACXG,EAAKJ,EAAUJ,EAAOM,EACtBG,EAAKJ,EAAUL,EAAOO,EAC5BR,EAAUO,GAAKE,EACfT,EAAUQ,GAAKE,EACfR,GAAS,CANU,CAOvB,IACA9B,KAAKiB,OAAOc,iBAAiB,SAAS,SAACC,GACnC,IAAQC,EAA6BD,EAA7BC,QAASC,EAAoBF,EAApBE,QAEXK,EAF+BP,EAAXQ,OAEN,EAAI,GAAK,EAC7BX,EAAOY,GAAM,GAAMF,EAEfV,EAAOY,EAAI,GACXZ,EAAOY,EAAI,GACJZ,EAAOY,EAAI,IAClBZ,EAAOY,EAAI,GAGf,MAAyBC,EAAW,EAAKzB,OAAQY,EAAOY,EAAG,CAAEN,EAAGF,EAASG,EAAGF,GAAWN,GAA5Ee,EAAE,EAALR,EAAUS,EAAE,EAALR,EACfR,EAAUO,EAAIQ,EACdf,EAAUQ,EAAIQ,EACdhB,EAAUa,EAAIZ,EAAOY,EAErB,EAAKvB,gBAAgBiB,EAAIQ,EACzB,EAAKzB,gBAAgBkB,EAAIQ,EACzB,EAAK1B,gBAAgBuB,EAAIZ,EAAOY,CAGpC,IACAzC,KAAKiB,OAAOc,iBAAiB,aAAa,SAACC,GACvC,GAAKF,EAAL,CACA,IAAQG,EAAqBD,EAArBC,QAASC,EAAYF,EAAZE,QACXC,EAAIP,EAAUO,GAAKF,EAAUJ,EAAOM,GACpCC,EAAIR,EAAUQ,GAAKF,EAAUL,EAAOO,GAC1C,EAAyBS,EAAgB,EAAK5B,OAAQW,EAAUa,EAAG,CAAEN,EAAAA,EAAGC,EAAAA,IAA7DO,EAAE,EAALR,EAAUS,EAAE,EAALR,EAEf,EAAKlB,gBAAgBiB,EAAIQ,EACzB,EAAKzB,gBAAgBkB,EAAIQ,EACzB,EAAK1B,gBAAgBuB,EAAIb,EAAUa,CARhB,CAUvB,IAGAzC,KAAK8C,OAAO9C,KAAKuB,IAErB,CAmBC,OAnBA,+BACD,WAEA,GAAC,oBACD,SAAcA,GAAgC,IAAD,OACzCwB,uBAAsB,WAAQ,EAAKD,OAAOvB,EAAM,IAEhDA,EAAIyB,UAAU,EAAG,EAAGzB,EAAIN,OAAOR,MAAOc,EAAIN,OAAOP,QACjDa,EAAI0B,OACJ1B,EAAI2B,UAAUlD,KAAKkB,gBAAgBiB,EAAGnC,KAAKkB,gBAAgBkB,GAC3Db,EAAI4B,MAAMnD,KAAKkB,gBAAgBuB,EAAGzC,KAAKkB,gBAAgBuB,GAGvDlB,EAAI6B,YACJ7B,EAAI8B,IAAI,EAAG,EAAG,IAAK,EAAGC,KAAKC,IAC3BhC,EAAIiC,YACJjC,EAAIkC,OAEJlC,EAAImC,SACR,KAAC,EA5GwB,GA8GhBtC,EAAM,WAgBf,WAAYe,EAAWC,EAAWK,IAAY,oBAHvCN,OAAC,OACDC,OAAC,OACDK,OAAC,EAEJzC,KAAKmC,EAAIA,EACTnC,KAAKoC,EAAIA,EACTpC,KAAKyC,EAAIA,CACb,CARC,OAQA,8BACD,WACI,OAAOa,KAAKK,KAAK3D,KAAKmC,EAAInC,KAAKmC,EAAInC,KAAKoC,EAAIpC,KAAKoC,EAAIpC,KAAKyC,EAAIzC,KAAKyC,EACvE,GAAC,uBACD,WACI,IAAImB,EAAcN,KAAKK,KAAK3D,KAAKmC,EAAInC,KAAKmC,EAAInC,KAAKoC,EAAIpC,KAAKoC,EAAIpC,KAAKyC,EAAIzC,KAAKyC,GAC9EzC,KAAKmC,GAAKyB,EACV5D,KAAKoC,GAAKwB,EACV5D,KAAKyC,GAAKmB,CACd,IAAC,kBA5BD,SAAWC,EAAYC,GACnB,OAAO,IAAI1C,EAAOyC,EAAG1B,EAAI2B,EAAG3B,EAAG0B,EAAGzB,EAAI0B,EAAG1B,EAAGyB,EAAGpB,EAAIqB,EAAGrB,EAC1D,GAAC,sBACD,SAAgBoB,EAAYC,GACxB,OAAO,IAAI1C,EAAOyC,EAAG1B,EAAI2B,EAAG3B,EAAG0B,EAAGzB,EAAI0B,EAAG1B,EAAGyB,EAAGpB,EAAIqB,EAAGrB,EAC1D,GAAC,sBACD,SAAuBoB,EAAYC,GAC/B,OAAOR,KAAKK,MAAME,EAAG1B,EAAI2B,EAAG3B,IAAM0B,EAAG1B,EAAI2B,EAAG3B,IAAM0B,EAAGzB,EAAI0B,EAAG1B,IAAMyB,EAAGzB,EAAI0B,EAAG1B,IAAMyB,EAAGpB,EAAIqB,EAAGrB,IAAMoB,EAAGpB,EAAIqB,EAAGrB,GAChH,GAAC,sBACD,SAAuBsB,GACnB,OAAO,IAAI3C,EAAO2C,EAAE5B,EAAG4B,EAAE3B,EAAG2B,EAAEtB,EAClC,KAAC,EAZc,GA+BNC,EAAa,SAACzB,EAAQkC,EAAM,EAAWvB,GAAe,IAAvBO,EAAC,EAADA,EAAGC,EAAC,EAADA,EACrC4B,EAAsB,IAAVb,EACZc,EAAOD,GAAa7B,EAAImB,KAAKY,IAAItC,EAAUO,IAAMP,EAAUa,EAAIN,EAC/DgC,EAAOH,GAAa5B,EAAIkB,KAAKY,IAAItC,EAAUQ,IAAMR,EAAUa,EAAIL,EAC/DC,EAAK4B,EAAQA,EAAOd,GAAUhB,EAAI8B,GAClC3B,EAAK6B,EAAQA,EAAOhB,GAAUf,EAAI+B,GACxC,OAAO,UAAKtB,EAAgB5B,EAAQkC,EAAO,CAAEhB,EAAGE,EAAID,EAAGE,IAC3D,EACaO,EAAkB,SAAC5B,EAAQkC,EAAM,GAAe,IAAZhB,EAAC,EAADA,EAAGC,EAAC,EAADA,EAC1CgC,EAAc,EAAIjB,EAClBkB,EAAaD,EAAcnD,EAAOR,MAClC6D,EAAaF,EAAcnD,EAAOP,OAWxC,OAVIyB,EAAI,EACJA,EAAI,EACGA,EAAIkC,IACXlC,EAAIkC,GAEJjC,EAAI,EACJA,EAAI,EACGA,EAAIkC,IACXlC,EAAIkC,GAED,CAAEnC,EAAAA,EAAGC,EAAAA,EAChB,C","sources":["njslab/Tools/CanvasNavigation/index.ts"],"sourcesContent":["import { RendererCanvas } from '../../../lib'\r\n\r\nexport class Solution {\r\n    public divHost: HTMLElement;\r\n    public renderer: CanvasNavigation;\r\n    public div: HTMLElement;\r\n    constructor(divHost: any) {\r\n        this.divHost = divHost;\r\n\r\n        // Center align\r\n        this.divHost.style.display = 'flex';\r\n        this.divHost.style.alignItems = 'center';\r\n\r\n        this.div = document.createElement('div');\r\n        this.div.style.marginLeft = 'auto';\r\n        this.div.style.marginRight = 'auto';\r\n        this.div.style.backgroundColor = '#555';\r\n        this.div.style.width = '1000px';\r\n        this.div.style.height = '600px';\r\n        this.divHost.appendChild(this.div);\r\n\r\n        // TODO\r\n        // You code goes here for one time operation\r\n\r\n        // this.renderer = new CanvasNavigation(this);\r\n\r\n        // console.log(this.renderer);\r\n        // !! you should execute it for rendering\r\n        // this.start();\r\n    }\r\n    public destroy() {\r\n        this.renderer.destroy();\r\n        while (this.divHost.lastElementChild) {\r\n            this.divHost.removeChild(this.divHost.lastElementChild);\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport class CanvasNavigation {\r\n    solution: Solution;\r\n\r\n    canvas: HTMLCanvasElement;\r\n    statusRendering: Vector;\r\n    statusTarget: Vector = new Vector(200, 200, 4);\r\n\r\n    needInterpolation: boolean = false;\r\n\r\n    img: HTMLImageElement;\r\n    ctx: CanvasRenderingContext2D;\r\n\r\n    speedInterpolation: number = 0.1;\r\n    easingInterpolation: boolean = true;\r\n\r\n    constructor(solution: Solution) {\r\n        this.solution = solution;\r\n        // https://gist.github.com/dzhang123/2a3a611b3d75a45a3f41\r\n        // refer: https://codepen.io/NJStudio/pen/poZoEgY?editors=0010\r\n        this.canvas = document.createElement('canvas');\r\n        this.canvas.style.background = '#555';\r\n        // this.canvas.style.width = '100%';\r\n        // this.canvas.style.height = '100%';\r\n        this.canvas.width = 1000;\r\n        this.canvas.height = 600;\r\n        solution.div.appendChild(this.canvas);\r\n        this.ctx = this.canvas.getContext('2d')\r\n\r\n\r\n        this.statusRendering = new Vector(0, 0, 1)\r\n        let statusPre = new Vector(0, 0, 1)\r\n        let status = new Vector(0, 0, 1)\r\n        let isDrag = false\r\n\r\n        this.canvas.addEventListener('mousedown', (e) => {\r\n            const { offsetX, offsetY } = e\r\n            status.x = offsetX\r\n            status.y = offsetY\r\n            isDrag = true\r\n            // if (status.z > 2) isDrag = true\r\n        });\r\n        this.canvas.addEventListener('mouseup', (e) => {\r\n            if (!isDrag) return\r\n            const { offsetX, offsetY } = e\r\n            const dx = offsetX - status.x\r\n            const dy = offsetY - status.y\r\n            statusPre.x += dx\r\n            statusPre.y += dy\r\n            isDrag = false\r\n        });\r\n        this.canvas.addEventListener('wheel', (e) => {\r\n            const { offsetX, offsetY, deltaY } = e\r\n\r\n            const oy = deltaY < 0 ? 1 : -1\r\n            status.z += (0.2 * oy)\r\n\r\n            if (status.z < 0.2) {\r\n                status.z = 0.2\r\n            } else if (status.z > 2) {\r\n                status.z = 2\r\n            }\r\n\r\n            const { x: zx, y: zy } = zoomOffset(this.canvas, status.z, { x: offsetX, y: offsetY }, statusPre)\r\n            statusPre.x = zx;\r\n            statusPre.y = zy;\r\n            statusPre.z = status.z;\r\n\r\n            this.statusRendering.x = zx;\r\n            this.statusRendering.y = zy;\r\n            this.statusRendering.z = status.z;\r\n\r\n            // draw(ctx, image, this.statusRendering);\r\n        });\r\n        this.canvas.addEventListener('mousemove', (e) => {\r\n            if (!isDrag) return\r\n            const { offsetX, offsetY } = e\r\n            const x = statusPre.x + (offsetX - status.x)\r\n            const y = statusPre.y + (offsetY - status.y)\r\n            const { x: zx, y: zy } = applyBoundaries(this.canvas, statusPre.z, { x, y })\r\n\r\n            this.statusRendering.x = zx;\r\n            this.statusRendering.y = zy;\r\n            this.statusRendering.z = statusPre.z;\r\n            // draw(ctx, image, this.statusRendering)\r\n        });\r\n\r\n\r\n        this.render(this.ctx);\r\n\r\n    }\r\n    public destroy() {\r\n\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D) {\r\n        requestAnimationFrame(() => { this.render(ctx); });\r\n\r\n        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height)\r\n        ctx.save()\r\n        ctx.translate(this.statusRendering.x, this.statusRendering.y)\r\n        ctx.scale(this.statusRendering.z, this.statusRendering.z)\r\n\r\n\r\n        ctx.beginPath();\r\n        ctx.arc(0, 0, 100, 0, Math.PI)\r\n        ctx.closePath();\r\n        ctx.fill();\r\n\r\n        ctx.restore()\r\n    }\r\n}\r\nexport class Vector {\r\n    static add(v0: Vector, v1: Vector) {\r\n        return new Vector(v0.x + v1.x, v0.y + v1.y, v0.z + v1.z);\r\n    }\r\n    static subtract(v0: Vector, v1: Vector) {\r\n        return new Vector(v0.x - v1.x, v0.y - v1.y, v0.z - v1.z);\r\n    }\r\n    public static distance(v0: Vector, v1: Vector): number {\r\n        return Math.sqrt((v0.x - v1.x) * (v0.x - v1.x) + (v0.y - v1.y) * (v0.y - v1.y) + (v0.z - v1.z) * (v0.z - v1.z));\r\n    }\r\n    public static deepCopy(v: Vector): Vector {\r\n        return new Vector(v.x, v.y, v.z);\r\n    }\r\n    public x: number\r\n    public y: number\r\n    public z: number\r\n    constructor(x: number, y: number, z: number) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n    }\r\n    public length(): number {\r\n        return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\r\n    }\r\n    public normalize() {\r\n        let len: number = Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\r\n        this.x /= len;\r\n        this.y /= len;\r\n        this.z /= len;\r\n    }\r\n};\r\nexport const zoomOffset = (canvas, scale, { x, y }, statusPre) => {\r\n    const isZooming = scale !== 1\r\n    const newX = isZooming ? (x + Math.abs(statusPre.x)) / statusPre.z : x\r\n    const newY = isZooming ? (y + Math.abs(statusPre.y)) / statusPre.z : y\r\n    const dx = newX - (newX * scale) + (x - newX)\r\n    const dy = newY - (newY * scale) + (y - newY)\r\n    return { ...applyBoundaries(canvas, scale, { x: dx, y: dy }) }\r\n};\r\nexport const applyBoundaries = (canvas, scale, { x, y }) => {\r\n    const scaleMargin = 1 - scale;\r\n    const maxOffsetX = scaleMargin * canvas.width;\r\n    const maxOffsetY = scaleMargin * canvas.height;\r\n    if (x > 0) {\r\n        x = 0\r\n    } else if (x < maxOffsetX) {\r\n        x = maxOffsetX;\r\n    }\r\n    if (y > 0) {\r\n        y = 0\r\n    } else if (y < maxOffsetY) {\r\n        y = maxOffsetY;\r\n    }\r\n    return { x, y }\r\n};"],"names":["Solution","divHost","renderer","div","this","style","display","alignItems","document","createElement","marginLeft","marginRight","backgroundColor","width","height","appendChild","destroy","lastElementChild","removeChild","CanvasNavigation","solution","canvas","statusRendering","statusTarget","Vector","needInterpolation","img","ctx","speedInterpolation","easingInterpolation","background","getContext","statusPre","status","isDrag","addEventListener","e","offsetX","offsetY","x","y","dx","dy","oy","deltaY","z","zoomOffset","zx","zy","applyBoundaries","render","requestAnimationFrame","clearRect","save","translate","scale","beginPath","arc","Math","PI","closePath","fill","restore","sqrt","len","v0","v1","v","isZooming","newX","abs","newY","scaleMargin","maxOffsetX","maxOffsetY"],"sourceRoot":""}