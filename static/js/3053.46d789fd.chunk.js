"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[3053],{13053:function(t,e,i){i.r(e),i.d(e,{TFProject:function(){return O}});var s=i(3156);class h{constructor(t){this.scene=void 0,this.scene=t}MouseEventController(t){t.CLICK_TYPE!==s.uh.LEFT?t.CLICK_TYPE!==s.uh.MIDDLE?t.CLICK_TYPE!==s.uh.DOWN_RIGHT?t.CLICK_TYPE!==s.uh.DOUBLE?t.CLICK_TYPE!==s.uh.MOVE?t.CLICK_TYPE!==s.uh.DRAG?t.CLICK_TYPE!==s.uh.DOWN?t.CLICK_TYPE!==s.uh.WHEEL?t.CLICK_TYPE!==s.uh.UP||this.MouseUpPre(t):this.MouseWheelPre(t):this.MouseDownPre(t):this.MouseDragPre(t):this.MouseMovePre(t):this.MouseDoubleClickPre(t):this.MouseRightClickPre(t):this.MouseMiddleClickPre(t):this.MouseLeftClickPre(t)}MouseDown(t){}MouseDownPre(t){this.scene.MouseDown(t.x,t.y),this.MouseDown(t)}MouseLeftClick(t){}MouseLeftClickPre(t){this.scene.MouseLeftClick(t.x,t.y),this.MouseLeftClick(t)}MouseMiddleClick(t){}MouseMiddleClickPre(t){this.scene.MouseMiddleClick(t.x,t.y),this.MouseMiddleClick(t)}MouseRightClick(t){}MouseRightClickPre(t){this.scene.MouseRightClick(t.x,t.y),this.MouseRightClick(t)}MouseUp(t){}MouseUpPre(t){this.scene.MouseUp(t.x,t.y),this.MouseUp(t)}MouseDoubleClick(t){}MouseDoubleClickPre(t){this.scene.MouseDoubleClick(t.x,t.y),this.MouseDoubleClick(t)}MouseMove(t){}MouseMovePre(t){this.scene.MouseMove(t.x,t.y),this.MouseMove(t)}MouseDrag(t){}MouseDragPre(t){this.scene.MouseDrag(t.x,t.y),this.MouseDrag(t)}MouseWheel(t){}MouseWheelPre(t){this.scene.MouseWheel(t.x,t.y,t.wheel),this.MouseWheel(t)}}var n=i(9936),a=i(48224),o=i(55798),l=i(81106),r=i(70490),d=i(23209),p=i(95706),c=i(68520),u=i(11675),m=i(72924);class v extends l.J{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:300,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:170,n=arguments.length>5&&void 0!==arguments[5]&&arguments[5];super(t),this.independentPanelWrapper=void 0,this.divInput=void 0,this.btnClose=void 0,this.btnMini=void 0,this.btnHam=void 0,this.btnResize=void 0,this.bodyDiv=void 0,this.subMenu=void 0,this.subs=[],this._content=void 0,this.canvas=void 0,this.ctx=void 0,this.isActive=!0,this.independentPanelWrapper=t,this.title="njslabSandbox V3",this.width=s,this.height=h,0===e&&0===i?(this.vec.x=.5*t.width-.5*this.width,this.vec.y=.5*t.height-.5*this.height):(this.vec.x=e,this.vec.y=i),this.filletR=7,this.InitTop(),n&&(this.bodyDiv=new u.k(this,this.vec.x,this.vec.y+this.HeadHeight,this.width,this.height-this.HeadHeight)),this.InitCanvas(this.bodyDiv.div)}get IsMinimized(){return this.isMinimized}set IsMinimized(t){this.isMinimized=t,this.btnResize.isHidden=t,this.bodyDiv&&this.bodyDiv.Hide(t)}get Width(){return this.width}set Width(t){let e=t-this.width;this.width=t,this.btnHam.vec.x+=e,this.subMenu.vec.x+=e,this.bodyDiv&&(this.bodyDiv.Width=t)}get Height(){return this.height}set Height(t){this.height=t,this.bodyDiv&&(this.bodyDiv.Height=t)}get content(){return this._content}set content(t){this._content=t,this.bodyDiv&&(this.bodyDiv.content=t)}get HasSubMenu(){return this.hasSubMenu}set HasSubMenu(t){this.hasSubMenu=t,this.subMenu.IsHidden=!t}InitTop(){this.btnClose=new r.E(this,this.vec.x,this.vec.y),this.btnMini=new d.$(this,this.vec.x+25,this.vec.y),this.btnHam=new p.g(this,this.vec.x-25+this.width,this.vec.y),this.btnResize=new c.C(this,this.vec.x+this.width-10,this.vec.y+this.height-10,10,10),this.subMenu=new m.q(this),this.subs.push(this.btnClose,this.btnMini,this.btnHam)}Translate(t){if(!this.isMoveable)return;let e=t.x-t.preX,i=t.y-t.preY;this.vec.x+=e,this.vec.y+=i;for(let s=0;s<this.boundarVecs.length;++s)this.boundarVecs[s].x+=e,this.boundarVecs[s].y+=i;for(let s=0;s<this.subs.length;++s)this.subs[s].Translate(t);this.btnResize.vec.x+=e,this.btnResize.vec.y+=i,this.subMenu.Translate(e,i),this.bodyDiv&&this.bodyDiv.Translate(e,i)}Remove(){this.RemovePost();for(let t=0;t<this.subs.length;++t)this.subs[t].Remove();this.bodyDiv&&this.bodyDiv.Remove(),this.btnResize.Remove(),this.independentPanelWrapper.indePanelRender.Remove(this)}RenderPost(t){let e;this.ComputeBoundary(),e=a.mK.HexToCanvasColor(o.X.theme.mainMenuNormal,this.transparent),this.isMinimized||o.X.RoundedRectFillWithColorMainMenu(t,this.title,this.boundarVecs,this.filletR,0,this.isOver,this.isSelected,e),o.X.TopRoundedRectFill(t,this.title,n.h9.GetBoundaryByVecWidthHeight(this.vec,this.width,this.HeadHeight),this.filletR,0,this.isOver,this.isSelected,this.theme.colSelectedBG,!1),this.RenderHeadTitle(t),this.isMinimized||this.RenderBodyContent(t),this.hasSubMenu&&this.subMenu.RenderPost(t),this.RenderBtnHorizontal(t)}RenderBtnHorizontal(t){}RenderHeadTitle(t){t.save(),t.fillStyle="#ffffff",t.textBaseline="top",t.textAlign="center",t.font="100 12px Arial",t.shadowBlur=0,t.shadowOffsetY=0,t.shadowOffsetX=0,t.fillText(this.title,this.vec.x+.5*this.width,this.vec.y+.5*this.HeadHeight-7),t.restore()}RenderBodyContent(t){}RemovePost(){this.isActive=!1}InitCanvas(t){this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.zIndex="0",t.appendChild(this.canvas),this.canvas.id="NCanvasRenderer",this.canvas.className="njslab-web-core-canvas-renderer",this.canvas.style.pointerEvents="none",this.ctx=this.canvas.getContext("2d"),this.canvas.width=t.clientWidth,this.canvas.height=t.clientHeight,this.btnResize.ResizePropagation=(t,e)=>{this.canvas.width=t,this.canvas.height=e},this.LoopIndependentCanvas(this.ctx)}LoopIndependentCanvas(t){this.isActive&&(t.clearRect(0,0,this.canvas.width,this.canvas.height),requestAnimationFrame((()=>{this.LoopIndependentCanvas(t)})),this.RenderIndependentCanvas(t))}RenderIndependentCanvas(t){}ResizeCanvas(t,e){this.canvas.width=t,this.canvas.height=e}}class g{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:650,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:350;this.scene=void 0,this.indeCanvas=void 0,this.mOffX=-12,this.mOffY=-12,this.scene=t,this.scene.definitions.push(this),this.InitIndeCanvas(e,i)}InitIndeCanvas(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:650,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:350;this.scene.implementation.app.needUI?this.indeCanvas=new v(this.scene.implementation.app.viewController.NUIWrapper.NUI.independentPanelWrapper,50,50,t,e,!0):this.indeCanvas=new v(this.scene.implementation.app.viewController.NUIWrapper.NUI.independentPanelWrapper,1,-25,t,e,!0),this.indeCanvas.title="TF Env",this.indeCanvas.btnHam.isHidden=!0,this.indeCanvas.btnMini.isHidden=!0,this.indeCanvas.RenderIndependentCanvas=t=>this.RenderIndependentCanvas(t)}get width(){return this.indeCanvas.canvas.width}get height(){return this.indeCanvas.canvas.height}Init(t){}RenderIndependentCanvas(t){}MouseMove(t,e){}MouseMovePre(t,e){this.indeCanvas.IsMouseInsidePanel(t,e)&&this.MouseMove(t-this.indeCanvas.vec.x+this.mOffX,e-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseDown(t,e){}MouseDownPre(t,e){this.indeCanvas.IsMouseInsidePanel(t,e)&&this.MouseDown(t-this.indeCanvas.vec.x+this.mOffX,e-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseUp(t,e){}MouseUpPre(t,e){this.indeCanvas.IsMouseInsidePanel(t,e)&&this.MouseUp(t-this.indeCanvas.vec.x+this.mOffX,e-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseDrag(t,e){}MouseDragPre(t,e){this.indeCanvas.IsMouseInsidePanel(t,e)&&this.MouseDrag(t-this.indeCanvas.vec.x+this.mOffX,e-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseLeftClick(t,e){}MouseLeftClickPre(t,e){this.indeCanvas.IsMouseInsidePanel(t,e)&&this.MouseLeftClick(t-this.indeCanvas.vec.x+this.mOffX,e-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseMiddleClick(t,e){}MouseMiddleClickPre(t,e){this.indeCanvas.IsMouseInsidePanel(t,e)&&this.MouseMiddleClick(t-this.indeCanvas.vec.x+this.mOffX,e-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseRightClick(t,e){}MouseRightClickPre(t,e){this.indeCanvas.IsMouseInsidePanel(t,e)&&this.MouseRightClick(t-this.indeCanvas.vec.x+this.mOffX,e-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseDoubleClick(t,e){}MouseDoubleClickPre(t,e){this.indeCanvas.IsMouseInsidePanel(t,e)&&this.MouseDoubleClick(t-this.indeCanvas.vec.x+this.mOffX,e-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseWheel(t,e,i){}MouseWheelPre(t,e,i){this.indeCanvas.IsMouseInsidePanel(t,e)&&this.MouseWheel(t-this.indeCanvas.vec.x+this.mOffX,e-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY,i)}}class f extends g{constructor(t){super(t),this.xpos=100,this.ypos=100,this.xspeed=10,this.yspeed=10,this.xdirection=1,this.ydirection=1,this.rad=50,this.vs=[],this.a=1,this.bias=0,this.indeCanvas.title="LinearRegression",this.Init()}Init(){}MouseDown(t,e){this.vs.push(new s.h9(this.MapX(t),this.MapY(e)))}MapX(t){return s.$H.Remap(t,0,this.width,0,1)}MapY(t){return s.$H.Remap(t,0,this.height,1,0)}RenderIndependentCanvas(t){t.fillStyle="#000000",t.beginPath(),t.rect(0,0,t.canvas.width,t.canvas.height),t.closePath(),t.fill(),this.LinearRegression(),this.RenderLine(t),t.fillStyle="#00ff00";for(let e=0;e<this.vs.length;++e)t.beginPath(),t.arc(s.$H.Remap(this.vs[e].x,0,1,0,this.width),s.$H.Remap(this.vs[e].y,0,1,this.height,0),5,0,2*Math.PI),t.closePath(),t.fill()}RenderLine(t){let e=0*this.a+this.bias,i=1*this.a+this.bias;t.lineWidth=3,t.strokeStyle="#00fff0",t.beginPath(),t.moveTo(s.$H.Remap(0,0,1,0,this.width),s.$H.Remap(e,0,1,this.height,0)),t.lineTo(s.$H.Remap(1,0,1,0,this.width),s.$H.Remap(i,0,1,this.height,0)),t.stroke()}LinearRegression(){let t=0,e=0;for(let a=0;a<this.vs.length;++a)t+=this.vs[a].x,e+=this.vs[a].y;let i=t/this.vs.length,s=e/this.vs.length,h=0,n=0;for(let a=0;a<this.vs.length;++a)h+=(this.vs[a].x-i)*(this.vs[a].y-s),n+=(this.vs[a].x-i)*(this.vs[a].x-i);this.a=h/n,this.bias=s-this.a*i}}class M extends g{constructor(t){super(t),this.xpos=100,this.ypos=100,this.xspeed=10,this.yspeed=10,this.xdirection=1,this.ydirection=1,this.rad=50,this.vs=[],this.weight=1,this.bias=0,this.indeCanvas.title="LinearRegression",this.Init()}Init(){}MouseDown(t,e){this.vs.push(new s.h9(this.MapX(t),this.MapY(e)))}MapX(t){return s.$H.Remap(t,0,this.width,0,1)}MapY(t){return s.$H.Remap(t,0,this.height,1,0)}RenderIndependentCanvas(t){t.fillStyle="#000000",t.beginPath(),t.rect(0,0,t.canvas.width,t.canvas.height),t.closePath(),t.fill(),this.GradientDescent(),this.vs.length>1&&this.RenderLine(t),t.fillStyle="#00ff00";for(let e=0;e<this.vs.length;++e)t.beginPath(),t.arc(s.$H.Remap(this.vs[e].x,0,1,0,this.width),s.$H.Remap(this.vs[e].y,0,1,this.height,0),5,0,2*Math.PI),t.closePath(),t.fill()}RenderLine(t){let e=0*this.weight+this.bias,i=1*this.weight+this.bias;t.lineWidth=3,t.strokeStyle="#00fff0",t.beginPath(),t.moveTo(s.$H.Remap(0,0,1,0,this.width),s.$H.Remap(e,0,1,this.height,0)),t.lineTo(s.$H.Remap(1,0,1,0,this.width),s.$H.Remap(i,0,1,this.height,0)),t.stroke()}GradientDescent(){for(let t=0;t<this.vs.length;++t){let e=this.vs[t].x,i=this.vs[t].y-(this.weight*e+this.bias);this.weight=this.weight+i*e*.1,this.bias=this.bias+.1*i}}}var w=i(816);i(13868);class y{static async getData(){const t=await fetch("https://storage.googleapis.com/tfjs-tutorials/carsData.json");return(await t.json()).map((t=>({mpg:t.Miles_per_Gallon,horsepower:t.Horsepower}))).filter((t=>null!=t.mpg&&null!=t.horsepower))}static Get_XY_OneHot_TensorFromCSV(t){return w.lub((()=>{const e=[],i=[];let s=-1;for(const h of t){const t=h.slice(0,h.length-1),n=h[h.length-1];e.push(t),i.push(n),s<n&&(s=n)}return[w.odF(e,[e.length,e[0].length]),w.lfX(w.RRF(i).toInt(),s+1)]}))}static Get_XY_TensorFromCSV(t){return w.lub((()=>{const e=[],i=[];let s=-1;for(const h of t){const t=h.slice(0,h.length-1),n=h[h.length-1];e.push(t),i.push(n),s<n&&(s=n)}return[w.odF(e,[e.length,e[0].length]),w.RRF(i)]}))}static SplitTensorFromXY(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;const s=Math.round(t.shape[0]*i),h=t.shape[0]-s,n=t.slice([0,0],[h,t.shape[1]]),a=t.slice([h,0],[s,t.shape[1]]);return[n,e.slice([0,0],[h,e.shape[1]]),a,e.slice([h,0],[s,e.shape[1]])]}static ConvertToTensors(t,e,i){const s=t.length;if(s!==e.length)throw new Error("data and split have different numbers of examples");const h=Math.round(s*i),n=s-h,a=t[0].length,o=w.odF(t,[s,a]),l=w.lfX(w.RRF(e).toInt(),4),r=o.slice([0,0],[n,a]),d=o.slice([n,0],[h,a]);return[r,l.slice([0,0],[n,4]),d,l.slice([0,0],[h,4])]}static GetRandomNormal(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.55;return w.nGf([t],e,i)}static GetRandomNormalTensors(){}static Shuffle(t){for(var e,i,s=t.length;0!==s;)i=Math.floor(Math.random()*s),e=t[s-=1],t[s]=t[i],t[i]=e;return t}static GetSyntheticDataTensor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.2,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return w.lub((()=>{const o=t,l=w.iD$(e),r=w.iD$(i),d=w.iD$(s),p=w.iD$(h),c=w.LGj([o],-1,1),u=l.mul(c.pow(w.iD$(3))).add(r.mul(c.square())).add(d.mul(c)).add(p).add(w.nGf([o],0,n));if(a){const t=u.min(),e=u.max().sub(t);return{x:c,yNomalized:u.sub(t).div(e)}}return[c,u]}))}static GetSyntheticData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-.2,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-.66,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-.1,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2.8,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.2,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return w.lub((()=>{const o=this.GetSyntheticDataTensor(t,e,i,s,h,n,a);return{xx:o[0].dataSync(),yy:o[1].dataSync()}}))}static GetIrisData(){return[[5.1,3.5,1.4,.2,0],[4.9,3,1.4,.2,0],[4.7,3.2,1.3,.2,0],[4.6,3.1,1.5,.2,0],[5,3.6,1.4,.2,0],[5.4,3.9,1.7,.4,0],[4.6,3.4,1.4,.3,0],[5,3.4,1.5,.2,0],[4.4,2.9,1.4,.2,0],[4.9,3.1,1.5,.1,0],[5.4,3.7,1.5,.2,0],[4.8,3.4,1.6,.2,0],[4.8,3,1.4,.1,0],[4.3,3,1.1,.1,0],[5.8,4,1.2,.2,0],[5.7,4.4,1.5,.4,0],[5.4,3.9,1.3,.4,0],[5.1,3.5,1.4,.3,0],[5.7,3.8,1.7,.3,0],[5.1,3.8,1.5,.3,0],[5.4,3.4,1.7,.2,0],[5.1,3.7,1.5,.4,0],[4.6,3.6,1,.2,0],[5.1,3.3,1.7,.5,0],[4.8,3.4,1.9,.2,0],[5,3,1.6,.2,0],[5,3.4,1.6,.4,0],[5.2,3.5,1.5,.2,0],[5.2,3.4,1.4,.2,0],[4.7,3.2,1.6,.2,0],[4.8,3.1,1.6,.2,0],[5.4,3.4,1.5,.4,0],[5.2,4.1,1.5,.1,0],[5.5,4.2,1.4,.2,0],[4.9,3.1,1.5,.1,0],[5,3.2,1.2,.2,0],[5.5,3.5,1.3,.2,0],[4.9,3.1,1.5,.1,0],[4.4,3,1.3,.2,0],[5.1,3.4,1.5,.2,0],[5,3.5,1.3,.3,0],[4.5,2.3,1.3,.3,0],[4.4,3.2,1.3,.2,0],[5,3.5,1.6,.6,0],[5.1,3.8,1.9,.4,0],[4.8,3,1.4,.3,0],[5.1,3.8,1.6,.2,0],[4.6,3.2,1.4,.2,0],[5.3,3.7,1.5,.2,0],[5,3.3,1.4,.2,0],[7,3.2,4.7,1.4,1],[6.4,3.2,4.5,1.5,1],[6.9,3.1,4.9,1.5,1],[5.5,2.3,4,1.3,1],[6.5,2.8,4.6,1.5,1],[5.7,2.8,4.5,1.3,1],[6.3,3.3,4.7,1.6,1],[4.9,2.4,3.3,1,1],[6.6,2.9,4.6,1.3,1],[5.2,2.7,3.9,1.4,1],[5,2,3.5,1,1],[5.9,3,4.2,1.5,1],[6,2.2,4,1,1],[6.1,2.9,4.7,1.4,1],[5.6,2.9,3.6,1.3,1],[6.7,3.1,4.4,1.4,1],[5.6,3,4.5,1.5,1],[5.8,2.7,4.1,1,1],[6.2,2.2,4.5,1.5,1],[5.6,2.5,3.9,1.1,1],[5.9,3.2,4.8,1.8,1],[6.1,2.8,4,1.3,1],[6.3,2.5,4.9,1.5,1],[6.1,2.8,4.7,1.2,1],[6.4,2.9,4.3,1.3,1],[6.6,3,4.4,1.4,1],[6.8,2.8,4.8,1.4,1],[6.7,3,5,1.7,1],[6,2.9,4.5,1.5,1],[5.7,2.6,3.5,1,1],[5.5,2.4,3.8,1.1,1],[5.5,2.4,3.7,1,1],[5.8,2.7,3.9,1.2,1],[6,2.7,5.1,1.6,1],[5.4,3,4.5,1.5,1],[6,3.4,4.5,1.6,1],[6.7,3.1,4.7,1.5,1],[6.3,2.3,4.4,1.3,1],[5.6,3,4.1,1.3,1],[5.5,2.5,4,1.3,1],[5.5,2.6,4.4,1.2,1],[6.1,3,4.6,1.4,1],[5.8,2.6,4,1.2,1],[5,2.3,3.3,1,1],[5.6,2.7,4.2,1.3,1],[5.7,3,4.2,1.2,1],[5.7,2.9,4.2,1.3,1],[6.2,2.9,4.3,1.3,1],[5.1,2.5,3,1.1,1],[5.7,2.8,4.1,1.3,1],[6.3,3.3,6,2.5,2],[5.8,2.7,5.1,1.9,2],[7.1,3,5.9,2.1,2],[6.3,2.9,5.6,1.8,2],[6.5,3,5.8,2.2,2],[7.6,3,6.6,2.1,2],[4.9,2.5,4.5,1.7,2],[7.3,2.9,6.3,1.8,2],[6.7,2.5,5.8,1.8,2],[7.2,3.6,6.1,2.5,2],[6.5,3.2,5.1,2,2],[6.4,2.7,5.3,1.9,2],[6.8,3,5.5,2.1,2],[5.7,2.5,5,2,2],[5.8,2.8,5.1,2.4,2],[6.4,3.2,5.3,2.3,2],[6.5,3,5.5,1.8,2],[7.7,3.8,6.7,2.2,2],[7.7,2.6,6.9,2.3,2],[6,2.2,5,1.5,2],[6.9,3.2,5.7,2.3,2],[5.6,2.8,4.9,2,2],[7.7,2.8,6.7,2,2],[6.3,2.7,4.9,1.8,2],[6.7,3.3,5.7,2.1,2],[7.2,3.2,6,1.8,2],[6.2,2.8,4.8,1.8,2],[6.1,3,4.9,1.8,2],[6.4,2.8,5.6,2.1,2],[7.2,3,5.8,1.6,2],[7.4,2.8,6.1,1.9,2],[7.9,3.8,6.4,2,2],[6.4,2.8,5.6,2.2,2],[6.3,2.8,5.1,1.5,2],[6.1,2.6,5.6,1.4,2],[7.7,3,6.1,2.3,2],[6.3,3.4,5.6,2.4,2],[6.4,3.1,5.5,1.8,2],[6,3,4.8,1.8,2],[6.9,3.1,5.4,2.1,2],[6.7,3.1,5.6,2.4,2],[6.9,3.1,5.1,2.3,2],[5.8,2.7,5.1,1.9,2],[6.8,3.2,5.9,2.3,2],[6.7,3.3,5.7,2.5,2],[6.7,3,5.2,2.3,2],[6.3,2.5,5,1.9,2],[6.5,3,5.2,2,2],[6.2,3.4,5.4,2.3,2],[5.9,3,5.1,1.8,2]]}constructor(){}}class R extends g{constructor(t){super(t),this.xpos=100,this.ypos=100,this.xspeed=10,this.yspeed=10,this.xdirection=1,this.ydirection=1,this.rad=50,this.vs=[],this.vsTemp=[],this.tfLinearRegression=void 0,this.t=0,this.indeCanvas.title="TF LinearRegression GradientDescent 01",this.Init()}Init(){this.tfLinearRegression=new b,this.InitData(),this.InitUI()}InitUI(){const t=document.createElement("div");t.style.position="absolute",t.style.left="400px",t.style.color="#ffffff";const e=document.createElement("p");e.textContent="click on this screen to add data",t.append(e);const i=document.getElementById("indePanel");i&&i.append(t)}InitData(){y.getData().then((t=>{let e=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,h=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;t.map((t=>{let s=t.horsepower;s>i&&(i=s),s<e&&(e=s);let a=t.mpg;a>n&&(n=a),a<h&&(h=a)}));for(let a of t){let t=a.horsepower,o=a.mpg;this.vsTemp.push(new s.h9(s.$H.Remap(t,e,i,.1,.9),s.$H.Remap(o,h,n,.1,.9)))}}))}MouseDown(t,e){this.vs.push(new s.h9(this.MapX(t),this.MapY(e)))}MapX(t){return s.$H.Remap(t,0,this.width,0,1)}MapY(t){return s.$H.Remap(t,0,this.height,1,0)}RenderIndependentCanvas(t){if(t.fillStyle="#000000",t.beginPath(),t.rect(0,0,t.canvas.width,t.canvas.height),t.closePath(),t.fill(),0===(2&this.t)){const t=this.vsTemp.pop();t&&this.vs.push(t)}if(this.vs.length>1){const e=[],i=[];for(let t=0;t<this.vs.length;++t)e.push(this.vs[t].x),i.push(this.vs[t].y);this.tfLinearRegression.train(e,i),this.RenderLine(t)}t.fillStyle="#00ff00";for(let e=0;e<this.vs.length;++e)t.beginPath(),t.arc(s.$H.Remap(this.vs[e].x,0,1,0,this.width),s.$H.Remap(this.vs[e].y,0,1,this.height,0),5,0,2*Math.PI),t.closePath(),t.fill();this.t+=.3}RenderLine(t){const e=[0,1],i=w.lub((()=>this.tfLinearRegression.predict(w.RRF(e))));let h=i.dataSync();i.dispose();let n=h[0],a=h[1];t.lineWidth=3,t.strokeStyle="#00fff0",t.beginPath(),t.moveTo(s.$H.Remap(0,0,1,0,this.width),s.$H.Remap(n,0,1,this.height,0)),t.lineTo(s.$H.Remap(1,0,1,0,this.width),s.$H.Remap(a,0,1,this.height,0)),t.stroke()}}class b{constructor(){this.weight=void 0,this.bias=void 0,this.leraningRate=.5,this.optimizer=void 0,this.weight=w.VD$(w.iD$(Math.random())),this.bias=w.VD$(w.iD$(Math.random())),this.optimizer=w.p_j.sgd(this.leraningRate)}predict(t){return t.mul(this.weight).add(this.bias)}loss(t,e){return t.sub(e).square().mean()}train(t,e){w.lub((()=>{const i=w.RRF(t),s=w.RRF(e);this.optimizer.minimize((()=>this.loss(this.predict(i),s)))}))}}class C extends g{constructor(t){super(t),this.xpos=100,this.ypos=100,this.xspeed=10,this.yspeed=10,this.xdirection=1,this.ydirection=1,this.rad=50,this.vs=[],this.vsTemp=[],this.selVec=void 0,this.tfLinearRegression=void 0,this.t=0,this.indeCanvas.title="TF LinearRegression GradientDescent 01",this.Init(),this.InitData(),this.InitUI()}InitUI(){const t=document.createElement("div");t.style.position="absolute",t.style.left="400px",t.style.color="#ffffff";const e=document.createElement("p");e.textContent="click on this screen to add data",t.append(e);const i=document.getElementById("indePanel");if(i){i.append(t);const e=document.createElement("button");e.textContent="run",e.style.position="absolute",e.style.left="650px",e.onclick=()=>{},this.scene.implementation.app.model.modelViewCoreWrapper.viewWrapper.div.append(e)}}InitData(){y.getData().then((t=>{let e=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,h=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;t.map((t=>{let s=t.horsepower;s>i&&(i=s),s<e&&(e=s);let a=t.mpg;a>n&&(n=a),a<h&&(h=a)}));for(let a of t){let t=a.horsepower,o=a.mpg;this.vsTemp.push(new s.h9(s.$H.Remap(t,e,i,-.9,.9),s.$H.Remap(o,h,n,-.9,.9)))}}))}Init(){this.tfLinearRegression=new I}MouseDown(t,e){this.vs.push(new s.h9(this.MapX(t),this.MapY(e)))}MouseDoubleClick(){}MapX(t){return s.$H.Remap(t,0,this.width,-1,1)}MapY(t){return s.$H.Remap(t,0,this.height,1,-1)}Grid(t){}RenderIndependentCanvas(t){if(this.Grid(t),t.fillStyle="#000000",t.beginPath(),t.rect(0,0,t.canvas.width,t.canvas.height),t.closePath(),t.fill(),0===(2&this.t)){const t=this.vsTemp.pop();t&&this.vs.push(t)}if(this.vs.length>1){const e=[],i=[];for(let t=0;t<this.vs.length;++t)e.push(this.vs[t].x),i.push(this.vs[t].y);this.tfLinearRegression.train(e,i),this.RenderLine(t)}t.fillStyle="#00ff00";for(let e=0;e<this.vs.length;++e)t.beginPath(),t.arc(s.$H.Remap(this.vs[e].x,-1,1,0,this.width),s.$H.Remap(this.vs[e].y,-1,1,this.height,0),5,0,2*Math.PI),t.closePath(),t.fill();this.t+=.3}RenderLine(t){const e=[];for(let s=-1;s<=1;s+=.05)e.push(s);const i=w.lub((()=>this.tfLinearRegression.predict2d(w.RRF(e))));let h=i.dataSync();i.dispose(),t.lineWidth=3,t.strokeStyle="#00fff0",t.beginPath(),t.moveTo(s.$H.Remap(e[0],-1,1,0,this.width),s.$H.Remap(h[0],-1,1,this.height,0));for(let n=1;n<e.length;++n)t.lineTo(s.$H.Remap(e[n],-1,1,0,this.width),s.$H.Remap(h[n],-1,1,this.height,0));t.stroke()}}class I{constructor(){this.weights=[],this.bias=void 0,this.dim=1,this.leraningRate=.2,this.optimizer=void 0;for(let t=0;t<5;++t){const t=w.VD$(w.iD$(2*Math.random()-1));t.print(),this.weights.push(t)}this.bias=w.VD$(w.iD$(2*Math.random()-1)),this.optimizer=w.p_j.adam(this.leraningRate)}predict1d(t){return t.mul(this.weights[0]).add(this.bias)}predict2d(t){return t.square().mul(this.weights[1]).add(t.mul(this.weights[0])).add(this.bias)}predict3d(t){return t.pow(w.iD$(3)).mul(this.weights[2]).add(t.square().mul(this.weights[1])).add(t.mul(this.weights[0])).add(this.bias)}predict4d(t){return t.pow(w.iD$(4)).mul(this.weights[3]).add(t.pow(w.iD$(3)).mul(this.weights[2])).add(t.square().mul(this.weights[1])).add(t.mul(this.weights[0])).add(this.bias)}predict5d(t){return t.pow(w.iD$(5)).mul(this.weights[4]).add(t.pow(w.iD$(4)).mul(this.weights[3])).add(t.pow(w.iD$(3)).mul(this.weights[2])).add(t.square().mul(this.weights[1])).add(t.mul(this.weights[0])).add(this.bias)}predict(t){return 5===this.dim?this.predict5d(t):4===this.dim?this.predict4d(t):3===this.dim?this.predict3d(t):2===this.dim?this.predict2d(t):this.predict1d(t)}loss(t,e){return t.sub(e).square().mean()}train(t,e){w.lub((()=>{const i=w.RRF(t),s=w.RRF(e);this.optimizer.minimize((()=>this.loss(this.predict(i),s)))}))}}class x extends g{constructor(t){super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:650,arguments.length>2&&void 0!==arguments[2]?arguments[2]:350),this.xpos=100,this.ypos=100,this.xspeed=10,this.yspeed=10,this.xdirection=1,this.ydirection=1,this.rad=50,this.vs=[],this.selVec=void 0,this.tfLinearRegression=void 0,this.indeCanvas.title="TF LinearRegression GradientDescent 01",this.Init()}Init(){this.tfLinearRegression=new D,this.indeCanvas.canvas.style.zIndex="-1",y.getData().then((t=>{}))}MouseDown(t,e){const i=new s.h9(this.MapX(t),this.MapY(e));for(let h=0;h<this.vs.length;++h)if(s.h9.Distance(i,this.vs[h])<.05)return void(this.selVec=this.vs[h]);this.vs.push(new s.h9(this.MapX(t),this.MapY(e)))}MouseDoubleClick(){}MouseMove(t,e){let i;const h=new s.h9(this.MapX(t),this.MapY(e));for(let n=0;n<this.vs.length;++n){s.h9.Distance(h,this.vs[n])<.05&&(i=this.vs[n])}this.selVec=i||void 0}MouseDrag(t,e){this.selVec&&(this.selVec.x=this.MapX(t),this.selVec.y=this.MapY(e))}MouseUp(){this.selVec=void 0}MapX(t){return s.$H.Remap(t,0,this.width,-1,1)}MapY(t){return s.$H.Remap(t,0,this.height,1,-1)}GridLine(t){t.strokeStyle="#555555";const e=this.width/20-1,i=this.height/20-1;for(let s=0;s<20;s+=1){t.lineWidth=10===s?3:1;let h=e*s,n=0,a=h,o=this.height;t.beginPath(),t.moveTo(h,n),t.lineTo(a,o),t.stroke(),h=0,n=i*s,a=this.width,o=n,t.beginPath(),t.moveTo(h,n),t.lineTo(a,o),t.stroke()}}RenderIndependentCanvas(t){if(t.fillStyle="#000000",t.beginPath(),t.rect(0,0,t.canvas.width,t.canvas.height),t.closePath(),t.fill(),this.GridLine(t),this.vs.length>1){const e=[],i=[];for(let t=0;t<this.vs.length;++t)e.push(this.vs[t].x),i.push(this.vs[t].y);this.tfLinearRegression.train(e,i),this.RenderLine(t)}t.fillStyle="#00ff00";for(let e=0;e<this.vs.length;++e)t.beginPath(),t.arc(s.$H.Remap(this.vs[e].x,-1,1,0,this.width),s.$H.Remap(this.vs[e].y,-1,1,this.height,0),5,0,2*Math.PI),t.closePath(),t.fill();this.selVec&&(t.fillStyle="#ffffff",t.font="15px Arial",t.textAlign="center",t.fillText("x:".concat(this.selVec.x.toFixed(3),", y").concat(this.selVec.y.toFixed(3)),s.$H.Remap(this.selVec.x,-1,1,0,this.width),s.$H.Remap(this.selVec.y,-1,1,this.height,0)-9))}RenderLine(t){const e=[];for(let s=-1;s<=1;s+=.05)e.push(s);const i=w.lub((()=>this.tfLinearRegression.predict(w.RRF(e))));let h=i.dataSync();i.dispose(),t.lineWidth=3,t.strokeStyle="#00fff0",t.beginPath(),t.moveTo(s.$H.Remap(e[0],-1,1,0,this.width),s.$H.Remap(h[0],-1,1,this.height,0));for(let n=1;n<e.length;++n)t.lineTo(s.$H.Remap(e[n],-1,1,0,this.width),s.$H.Remap(h[n],-1,1,this.height,0));t.stroke()}}class D{constructor(){this.weights=[],this.bias=void 0,this.dim=3,this.leraningRate=.2,this.optimizer=void 0;for(let t=0;t<5;++t){const t=w.VD$(w.iD$(2*Math.random()-1));t.print(),this.weights.push(t)}this.bias=w.VD$(w.iD$(2*Math.random()-1)),this.optimizer=w.p_j.adam(this.leraningRate)}predict1d(t){return t.mul(this.weights[0]).add(this.bias)}predict2d(t){return t.square().mul(this.weights[1]).add(t.mul(this.weights[0])).add(this.bias)}predict3d(t){return t.pow(w.iD$(3)).mul(this.weights[2]).add(t.square().mul(this.weights[1])).add(t.mul(this.weights[0])).add(this.bias)}predict4d(t){return t.pow(w.iD$(4)).mul(this.weights[3]).add(t.pow(w.iD$(3)).mul(this.weights[2])).add(t.square().mul(this.weights[1])).add(t.mul(this.weights[0])).add(this.bias)}predict5d(t){return t.pow(w.iD$(5)).mul(this.weights[4]).add(t.pow(w.iD$(4)).mul(this.weights[3])).add(t.pow(w.iD$(3)).mul(this.weights[2])).add(t.square().mul(this.weights[1])).add(t.mul(this.weights[0])).add(this.bias)}predict(t){return 5===this.dim?this.predict5d(t):4===this.dim?this.predict4d(t):3===this.dim?this.predict3d(t):2===this.dim?this.predict2d(t):this.predict1d(t)}loss(t,e){return t.sub(e).square().mean()}train(t,e){w.lub((()=>{const i=w.RRF(t),s=w.RRF(e);this.optimizer.minimize((()=>this.loss(this.predict(i),s)))}))}}class P extends g{constructor(t){super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:650,arguments.length>2&&void 0!==arguments[2]?arguments[2]:350),this.xpos=100,this.ypos=100,this.xspeed=10,this.yspeed=10,this.xdirection=1,this.ydirection=1,this.rad=50,this.vs=[],this.selVec=void 0,this.tfModel=void 0,this.indeCanvas.title="TF Horsepower and Miles Per Gallon",this.Init()}Init(){this.tfModel=new T}MouseDown(t,e){const i=new s.h9(this.MapX(t),this.MapY(e));for(let h=0;h<this.vs.length;++h)if(s.h9.Distance(i,this.vs[h])<.05)return void(this.selVec=this.vs[h]);this.vs.push(new s.h9(this.MapX(t),this.MapY(e)))}MouseMove(t,e){let i;const h=new s.h9(this.MapX(t),this.MapY(e));for(let n=0;n<this.vs.length;++n){s.h9.Distance(h,this.vs[n])<.05&&(i=this.vs[n])}this.selVec=i||void 0}MouseDrag(t,e){this.selVec&&(this.selVec.x=this.MapX(t),this.selVec.y=this.MapY(e))}MouseUp(){this.selVec=void 0}MapX(t){return s.$H.Remap(t,0,this.width,-1,1)}MapY(t){return s.$H.Remap(t,0,this.height,1,-1)}GridLine(t){t.strokeStyle="#555555";const e=this.width/20-1,i=this.height/20-1;for(let s=0;s<20;s+=1){t.lineWidth=10===s?3:1;let h=e*s,n=0,a=h,o=this.height;t.beginPath(),t.moveTo(h,n),t.lineTo(a,o),t.stroke(),h=0,n=i*s,a=this.width,o=n,t.beginPath(),t.moveTo(h,n),t.lineTo(a,o),t.stroke()}}RenderIndependentCanvas(t){if(t.fillStyle="#000000",t.beginPath(),t.rect(0,0,t.canvas.width,t.canvas.height),t.closePath(),t.fill(),this.GridLine(t),this.vs.length>1){const e=[],i=[];for(let t=0;t<this.vs.length;++t)e.push(this.vs[t].x),i.push(this.vs[t].y);this.RenderLine(t)}t.fillStyle="#00ff00";for(let e=0;e<this.vs.length;++e)t.beginPath(),t.arc(s.$H.Remap(this.vs[e].x,-1,1,0,this.width),s.$H.Remap(this.vs[e].y,-1,1,this.height,0),5,0,2*Math.PI),t.closePath(),t.fill();this.selVec&&(t.fillStyle="#ffffff",t.font="15px Arial",t.textAlign="center",t.fillText("x:".concat(this.selVec.x.toFixed(3),", y").concat(this.selVec.y.toFixed(3)),s.$H.Remap(this.selVec.x,-1,1,0,this.width),s.$H.Remap(this.selVec.y,-1,1,this.height,0)-9))}RenderLine(t){}}class T{constructor(){this.model=void 0,this.model=w.Pel();const t=w.ugM.dense({inputShape:[2],units:4,activation:"sigmoid"}),e=w.ugM.dense({units:1,activation:"sigmoid"});this.model.add(t),this.model.add(e);const i={optimizer:w.p_j.sgd(.1),loss:w.MB5.meanSquaredError};this.model.compile(i),this.train1().then((()=>{const t=w.odF([[0,0],[.5,.5],[1,1]]);this.model.predict(t).print()}))}train0(){const t=w.odF([[0,0],[.5,.5],[1,1]]),e=w.odF([[1],[.5],[0]]);this.model.fit(t,e,{epochs:10}).then((t=>console.log(t.history)));this.model.predict(t).print()}async train1(){const t=w.odF([[0,0],[.5,.5],[1,1]]),e=w.odF([[1],[.5],[0]]),i={epochs:10,shuffle:!0};for(let s=0;s<500;++s){await this.model.fit(t,e,i)}}}class H extends g{constructor(t){super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:650,arguments.length>2&&void 0!==arguments[2]?arguments[2]:350),this.xpos=100,this.ypos=100,this.xspeed=10,this.yspeed=10,this.xdirection=1,this.ydirection=1,this.rad=50,this.vs=[],this.selVec=void 0,this.tfModel=void 0,this.xPredict=void 0,this.inputs=[],this.indeCanvas.title="TF XOR",this.Init(),this.InitUI()}InitUI(){const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.color="#ffffff";const e=document.createElement("p");e.textContent="ref: Coding Challenge #106: XOR Problem with TensorFlow.js by The Cording Train",e.style.fontSize="11px",t.append(e);const i=document.getElementById("indePanel");i&&i.append(t)}Init(){this.tfModel=new L;let t=[];for(let e=0;e<=10;++e)for(let i=0;i<=10;++i)t.push([.1*i,.1*e]);this.xPredict=w.odF(t)}MouseDown(t,e){const i=new s.h9(this.MapX(t),this.MapY(e));for(let h=0;h<this.vs.length;++h)if(s.h9.Distance(i,this.vs[h])<.05)return void(this.selVec=this.vs[h]);this.vs.push(new s.h9(this.MapX(t),this.MapY(e)))}MouseMove(t,e){let i;const h=new s.h9(this.MapX(t),this.MapY(e));for(let n=0;n<this.vs.length;++n){s.h9.Distance(h,this.vs[n])<.05&&(i=this.vs[n])}this.selVec=i||void 0}MouseDrag(t,e){this.selVec&&(this.selVec.x=this.MapX(t),this.selVec.y=this.MapY(e))}MouseUp(){this.selVec=void 0}MapX(t){return s.$H.Remap(t,0,this.width,-1,1)}MapY(t){return s.$H.Remap(t,0,this.height,1,-1)}RenderIndependentCanvas(t){w.lub((()=>{const e=this.tfModel.model.predict(this.xPredict).dataSync();t.fillStyle="#000000",t.beginPath(),t.rect(0,0,t.canvas.width,t.canvas.height),t.closePath(),t.fill();let i=0;for(let s=0;s<=10;s++)for(let h=0;h<=10;h++){this.inputs.push(s);let n=42,a=s*n,o=h*n;const l=e[i];t.fillStyle="rgba(".concat(255*l,",",0,",",0,",1)"),t.beginPath(),t.rect(a,o,n,n),t.closePath(),t.fill(),i++}}))}}class L{constructor(){this.model=void 0,this.xTrain=w.odF([[0,0],[1,0],[0,1],[1,1]]),this.yTrain=w.odF([[0],[1],[1],[0]]),this.model=w.Pel();const t=w.ugM.dense({inputShape:[2],units:16,activation:"sigmoid"}),e=w.ugM.dense({units:1,activation:"sigmoid"});this.model.add(t),this.model.add(e),this.model.compile({optimizer:w.p_j.adam(.05),loss:w.MB5.meanSquaredError}),this.trainLoop()}trainLoop(){this.train().then((t=>{setTimeout((()=>this.trainLoop()),1)}))}async train(){return await this.model.fit(this.xTrain,this.yTrain,{epochs:10,shuffle:!0})}}class $ extends g{constructor(t){super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:650,arguments.length>2&&void 0!==arguments[2]?arguments[2]:350),this.xpos=100,this.ypos=100,this.xspeed=10,this.yspeed=10,this.xdirection=1,this.ydirection=1,this.rad=50,this.tfModel=void 0,this.xPredict=void 0,this.inputs=[],this.indeCanvas.title="TF Horsepower and Miles Per Gallon",this.Init()}Init(){this.tfModel=new S}RenderIndependentCanvas(t){w.lub((()=>{}))}}class S{constructor(){this.model=void 0,this.inputsTensor=void 0,this.labelsTensor=void 0;const t=y.GetIrisData();w.D5U.shuffle(t);const e=[];for(let n=0;n<t.length;++n){let i=[];for(let e=0;e<t[n].length-1;++e)i.push(t[n][e]);e.push(i)}const i=[];for(let n=0;n<t.length;++n)0===t[n][t[n].length-1]?i.push([1,0,0]):1===t[n][t[n].length-1]?i.push([0,1,0]):2===t[n][t[n].length-1]&&i.push([0,0,1]);this.inputsTensor=w.odF(e),this.labelsTensor=w.odF(i),this.inputsTensor.print(),this.labelsTensor.print(),this.model=w.Pel();const s=w.ugM.dense({inputShape:[this.inputsTensor.shape[1]],units:10,activation:"sigmoid"}),h=w.ugM.dense({units:3,activation:"softmax"});this.model.add(s),this.model.add(h),this.model.compile({optimizer:w.p_j.adam(),loss:w.MB5.softmaxCrossEntropy,metrics:["accuracy"]}),this.model.summary(),this.trainLoop()}async trainLoop(){await this.model.save("downloads://my-model");await this.model.save("localstorage://ml/my-model-1");this.train().then((t=>{setTimeout((()=>this.trainLoop()),1)}))}async train(){return await this.model.fit(this.inputsTensor,this.labelsTensor,{epochs:50,shuffle:!0,validationData:[this.inputsTensor,this.labelsTensor]})}}class F extends g{constructor(t){super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:650,arguments.length>2&&void 0!==arguments[2]?arguments[2]:350),this.xpos=100,this.ypos=100,this.xspeed=10,this.yspeed=10,this.xdirection=1,this.ydirection=1,this.rad=50,this.tfModel=void 0,this.xPredict=void 0,this.inputs=[],this.indeCanvas.title="TF Horsepower and Miles Per Gallon",this.Init()}async Init(){const t=new k;await t.Init().then((()=>{this.tfModel=new W("model1",t.inputsTensor,t.labelsTensor),this.tfModel.CreateModel01(),this.tfModel=new W("model2",t.inputsTensor,t.labelsTensor),this.tfModel.CreateModel02()}))}RenderIndependentCanvas(t){w.lub((()=>{}))}}class k{constructor(){this.raw=void 0,this.inputsTensor=void 0,this.labelsTensor=void 0}async Init(){const t=await this.OpenCSV();if(t){this.raw=this.processData(t),w.D5U.shuffle(this.raw);const e=[],i=[];for(let t=0;t<this.raw.length;++t){let s=[];for(let e=0;e<this.raw[t].length-1;++e)s.push(this.raw[t][e]);e.push(s),i.push(this.raw[t][this.raw[t].length-1])}const s=w.Fp7(i).dataSync(),h=[];for(let t=0;t<i.length;++t){const e=[];for(let h=0;h<=s[0];++h)h===i[t]?e.push(1):e.push(0);h.push(e)}this.inputsTensor=w.odF(e),this.labelsTensor=w.odF(h),this.inputsTensor.print(),this.labelsTensor.print()}}processData(t){const e=t.split(/\r\n|\n/),i=e[0].split(","),s=[];for(let h=1;h<e.length;h++){const t=e[h].split(",");if(t.length===i.length){const e=[];for(let s=0;s<i.length;s++){const i=+t[s];isNaN(i)?e.push(t[s]):e.push(i)}s.push(e)}}return s}async OpenCSV(){return fetch("njslabSandboxStatic/ML/SmartDrawing/".concat("smartDrawingTrainData.csv")).then((t=>t.text())).catch((t=>{}))}}class W{constructor(t,e,i){this.t0=void 0,this.t1=void 0,this.name=void 0,this.model=void 0,this.inputsTensor=void 0,this.labelsTensor=void 0,this.name=t,this.inputsTensor=e,this.labelsTensor=i}CreateModel01(){this.model=w.Pel();const t=w.ugM.dense({inputShape:[this.inputsTensor.shape[1]],units:20,activation:"sigmoid"}),e=w.ugM.dense({units:this.labelsTensor.shape[1],activation:"softmax"});this.model.add(t),this.model.add(e),this.Compile()}CreateModel02(){this.model=w.Pel();const t=w.ugM.dense({inputShape:[this.inputsTensor.shape[1]],units:20,activation:"sigmoid"}),e=w.ugM.dense({units:15,activation:"sigmoid"}),i=w.ugM.dense({units:this.labelsTensor.shape[1],activation:"softmax"});this.model.add(t),this.model.add(e),this.model.add(i),this.Compile()}Compile(){this.model.compile({optimizer:w.p_j.adam(),loss:w.MB5.softmaxCrossEntropy,metrics:["accuracy"]}),this.model.summary(),this.trainLoop()}async trainLoop(){this.t0=performance.now(),await this.model.save("downloads://my-model"),this.train().then((t=>{this.t1=performance.now(),setTimeout((()=>this.trainLoop()),1)}))}async train(){}}var V=i(30386);class E extends g{constructor(t){super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:650,arguments.length>2&&void 0!==arguments[2]?arguments[2]:350),this.xpos=100,this.ypos=100,this.xspeed=10,this.yspeed=10,this.xdirection=1,this.ydirection=1,this.rad=50,this.vs=[],this.selVec=void 0,this.indeCanvas.title="TF Horsepower and Miles Per Gallon",this.Init()}Init(){y.getData().then((t=>{this.train(t)}))}async train(t){const e=A(t),{inputs:i,labels:s}=e,h=N();V.show.modelSummary({name:"Model Summary"},h),await async function(t,e,i){t.compile({optimizer:w.p_j.adam(),loss:w.MB5.meanSquaredError,metrics:["mse"]});const s=32,h=50;return await t.fit(e,i,{batchSize:s,epochs:h,shuffle:!0,callbacks:V.show.fitCallbacks({name:"Training Performance"},["loss","mse"],{height:200,callbacks:["onEpochEnd"]})})}(h,i,s),function(t,e,i){const{inputMax:s,inputMin:h,labelMin:n,labelMax:a}=i,[o,l]=w.lub((()=>{const e=w.SX3(0,1,100),i=t.predict(e.reshape([100,1])),o=e.mul(s.sub(h)).add(h),l=i.mul(a.sub(n)).add(n);return[o.dataSync(),l.dataSync()]})),r=Array.from(o).map(((t,e)=>({x:t,y:l[e]}))),d=e.map((t=>({x:t.horsepower,y:t.mpg})));V.render.scatterplot({name:"Model Predictions vs Original Data"},{values:[d,r],series:["original","predicted"]},{xLabel:"Horsepower",yLabel:"MPG",height:300})}(h,t,e)}MouseDown(t,e){const i=new s.h9(this.MapX(t),this.MapY(e));for(let h=0;h<this.vs.length;++h)if(s.h9.Distance(i,this.vs[h])<.05)return void(this.selVec=this.vs[h]);this.vs.push(new s.h9(this.MapX(t),this.MapY(e)))}MouseDoubleClick(){}MouseMove(t,e){let i;const h=new s.h9(this.MapX(t),this.MapY(e));for(let n=0;n<this.vs.length;++n){s.h9.Distance(h,this.vs[n])<.05&&(i=this.vs[n])}this.selVec=i||void 0}MouseDrag(t,e){this.selVec&&(this.selVec.x=this.MapX(t),this.selVec.y=this.MapY(e))}MouseUp(){this.selVec=void 0}MapX(t){return s.$H.Remap(t,0,this.width,-1,1)}MapY(t){return s.$H.Remap(t,0,this.height,1,-1)}GridLine(t){t.strokeStyle="#555555";const e=this.width/20-1,i=this.height/20-1;for(let s=0;s<20;s+=1){t.lineWidth=10===s?3:1;let h=e*s,n=0,a=h,o=this.height;t.beginPath(),t.moveTo(h,n),t.lineTo(a,o),t.stroke(),h=0,n=i*s,a=this.width,o=n,t.beginPath(),t.moveTo(h,n),t.lineTo(a,o),t.stroke()}}RenderIndependentCanvas(t){if(t.fillStyle="#000000",t.beginPath(),t.rect(0,0,t.canvas.width,t.canvas.height),t.closePath(),t.fill(),this.GridLine(t),this.vs.length>1){const e=[],i=[];for(let t=0;t<this.vs.length;++t)e.push(this.vs[t].x),i.push(this.vs[t].y);this.RenderLine(t)}t.fillStyle="#00ff00";for(let e=0;e<this.vs.length;++e)t.beginPath(),t.arc(s.$H.Remap(this.vs[e].x,-1,1,0,this.width),s.$H.Remap(this.vs[e].y,-1,1,this.height,0),5,0,2*Math.PI),t.closePath(),t.fill();this.selVec&&(t.fillStyle="#ffffff",t.font="15px Arial",t.textAlign="center",t.fillText("x:".concat(this.selVec.x.toFixed(3),", y").concat(this.selVec.y.toFixed(3)),s.$H.Remap(this.selVec.x,-1,1,0,this.width),s.$H.Remap(this.selVec.y,-1,1,this.height,0)-9))}RenderLine(t){const e=[];for(let i=-1;i<=1;i+=.05)e.push(i)}}const N=()=>{const t=w.Pel();return t.add(w.ugM.dense({inputShape:[1],units:16,useBias:!0})),t.add(w.ugM.dense({units:1,useBias:!0})),t},A=t=>w.lub((()=>{w.D5U.shuffle(t);const e=t.map((t=>t.horsepower)),i=t.map((t=>t.mpg)),s=w.odF(e,[e.length,1]),h=w.odF(i,[i.length,1]),n=s.max(),a=s.min(),o=h.max(),l=h.min();return{inputs:s.sub(a).div(n.sub(a)),labels:h.sub(l).div(o.sub(l)),inputMax:n,inputMin:a,labelMax:o,labelMin:l}}));class U extends g{constructor(t){super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:650,arguments.length>2&&void 0!==arguments[2]?arguments[2]:350),this.xpos=100,this.ypos=100,this.xspeed=10,this.yspeed=10,this.xdirection=1,this.ydirection=1,this.rad=50,this.vs=[],this.selVec=void 0,this.col=["#ff0000","#00ff00","#0000ff","#00fff0","#ff0000","#fff000","#0fff00"],this.tfLinearRegression=[],this.indeCanvas.title="TF MNist ",this.Init(),this.InitUI()}Init(){this.tfLinearRegression.push(new X(1)),this.tfLinearRegression.push(new X(2)),this.tfLinearRegression.push(new X(3)),this.tfLinearRegression.push(new X(4)),this.indeCanvas.canvas.style.zIndex="-1",y.getData().then((t=>{}));new _}InitUI(){const t=document.createElement("div");t.style.position="absolute",t.style.left="40px",t.style.color="#ffffff";let e=document.createElement("p");e.textContent="click on this screen to add data",t.append(e),e=document.createElement("p"),e.textContent="LinearRegression",e.style.marginTop="0px",e.style.marginBottom="0px",e.style.color=this.col[0],t.append(e),e=document.createElement("p"),e.style.marginTop="0px",e.style.marginBottom="0px",e.style.color=this.col[1],e.textContent="Degree of polynomial - 2",t.append(e),e=document.createElement("p"),e.style.marginTop="0px",e.style.marginBottom="0px",e.style.color=this.col[2],e.textContent="Degree of polynomial - 3",t.append(e),e=document.createElement("p"),e.style.marginTop="0px",e.style.marginBottom="0px",e.style.color=this.col[3],e.textContent="Degree of polynomial - 4",t.append(e);const i=document.getElementById("indePanel");i&&i.append(t)}MouseDown(t,e){const i=new s.h9(this.MapX(t),this.MapY(e));for(let h=0;h<this.vs.length;++h)if(s.h9.Distance(i,this.vs[h])<.05)return void(this.selVec=this.vs[h]);this.vs.push(new s.h9(this.MapX(t),this.MapY(e)))}MouseDoubleClick(){}MouseMove(t,e){let i;const h=new s.h9(this.MapX(t),this.MapY(e));for(let n=0;n<this.vs.length;++n){s.h9.Distance(h,this.vs[n])<.05&&(i=this.vs[n])}this.selVec=i||void 0}MouseDrag(t,e){this.selVec&&(this.selVec.x=this.MapX(t),this.selVec.y=this.MapY(e))}MouseUp(){this.selVec=void 0}MapX(t){return s.$H.Remap(t,0,this.width,-1,1)}MapY(t){return s.$H.Remap(t,0,this.height,1,-1)}GridLine(t){t.strokeStyle="#555555";const e=this.width/20-1,i=this.height/20-1;for(let s=0;s<20;s+=1){t.lineWidth=10===s?3:1;let h=e*s,n=0,a=h,o=this.height;t.beginPath(),t.moveTo(h,n),t.lineTo(a,o),t.stroke(),h=0,n=i*s,a=this.width,o=n,t.beginPath(),t.moveTo(h,n),t.lineTo(a,o),t.stroke()}}RenderIndependentCanvas(t){if(t.fillStyle="#000000",t.beginPath(),t.rect(0,0,t.canvas.width,t.canvas.height),t.closePath(),t.fill(),this.GridLine(t),this.vs.length>1)for(let e=0;e<this.tfLinearRegression.length;++e){const i=[],s=[];for(let t=0;t<this.vs.length;++t)i.push(this.vs[t].x),s.push(this.vs[t].y);this.tfLinearRegression[e].train(i,s),this.RenderLine(t)}t.fillStyle="#00ff00";for(let e=0;e<this.vs.length;++e)t.beginPath(),t.arc(s.$H.Remap(this.vs[e].x,-1,1,0,this.width),s.$H.Remap(this.vs[e].y,-1,1,this.height,0),5,0,2*Math.PI),t.closePath(),t.fill();this.selVec&&(t.fillStyle="#ffffff",t.font="15px Arial",t.textAlign="center",t.fillText("x:".concat(this.selVec.x.toFixed(3),", y").concat(this.selVec.y.toFixed(3)),s.$H.Remap(this.selVec.x,-1,1,0,this.width),s.$H.Remap(this.selVec.y,-1,1,this.height,0)-9))}RenderLine(t){for(let e=0;e<this.tfLinearRegression.length;++e){const i=[];for(let t=-1;t<=1;t+=.08)i.push(t);const h=w.lub((()=>this.tfLinearRegression[e].predict(w.RRF(i))));let n=h.dataSync();h.dispose(),t.lineWidth=1,t.strokeStyle=this.col[e],t.beginPath(),t.moveTo(s.$H.Remap(i[0],-1,1,0,this.width),s.$H.Remap(n[0],-1,1,this.height,0));for(let e=1;e<i.length;++e)t.lineTo(s.$H.Remap(i[e],-1,1,0,this.width),s.$H.Remap(n[e],-1,1,this.height,0));t.stroke()}}}class X{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.weights=[],this.bias=void 0,this.dim=3,this.leraningRate=.2,this.optimizer=void 0,this.dim=t;for(let e=0;e<5;++e){const t=w.VD$(w.iD$(2*Math.random()-1));t.print(),this.weights.push(t)}this.bias=w.VD$(w.iD$(2*Math.random()-1)),this.optimizer=w.p_j.adam(this.leraningRate)}predict1d(t){return t.mul(this.weights[0]).add(this.bias)}predict2d(t){return t.square().mul(this.weights[1]).add(t.mul(this.weights[0])).add(this.bias)}predict3d(t){return t.pow(w.iD$(3)).mul(this.weights[2]).add(t.square().mul(this.weights[1])).add(t.mul(this.weights[0])).add(this.bias)}predict4d(t){return t.pow(w.iD$(4)).mul(this.weights[3]).add(t.pow(w.iD$(3)).mul(this.weights[2])).add(t.square().mul(this.weights[1])).add(t.mul(this.weights[0])).add(this.bias)}predict5d(t){return t.pow(w.iD$(5)).mul(this.weights[4]).add(t.pow(w.iD$(4)).mul(this.weights[3])).add(t.pow(w.iD$(3)).mul(this.weights[2])).add(t.square().mul(this.weights[1])).add(t.mul(this.weights[0])).add(this.bias)}predict(t){return 5===this.dim?this.predict5d(t):4===this.dim?this.predict4d(t):3===this.dim?this.predict3d(t):2===this.dim?this.predict2d(t):(this.dim,this.predict1d(t))}loss(t,e){return t.sub(e).square().mean()}train(t,e){w.lub((()=>{const i=w.RRF(t),s=w.RRF(e);this.optimizer.minimize((()=>this.loss(this.predict(i),s)))}))}}const Y=784,G=10;class _{constructor(){this.testLabels=void 0,this.trainLabels=void 0,this.testImages=void 0,this.trainImages=void 0,this.datasetImages=void 0,this.datasetLabels=void 0}async load(){const t=new Image,e=document.createElement("canvas"),i=e.getContext("2d"),s=new Promise(((s,h)=>{t.crossOrigin="",t.onload=()=>{t.width=t.naturalWidth,t.height=t.naturalHeight;const s=new ArrayBuffer(20384e4),h=5e3;e.width=t.width,e.height=h;for(let n=0;n<13;n++){const a=new Float32Array(s,n*Y*h*4,392e4);i.drawImage(t,0,n*h,t.width,h,0,0,t.width,h);const o=i.getImageData(0,0,e.width,e.height);for(let t=0;t<o.data.length/4;t++)a[t]=o.data[4*t]/255}this.datasetImages=new Float32Array(s)},t.src="https://storage.googleapis.com/learnjs-data/model-builder/mnist_images.png"})),h=fetch("https://storage.googleapis.com/learnjs-data/model-builder/mnist_labels_uint8"),n=(await Promise.all([s,h]))[1];this.datasetLabels=new Uint8Array(await n.arrayBuffer()),this.trainImages=this.datasetImages.slice(0,4312e4),this.testImages=this.datasetImages.slice(4312e4),this.trainLabels=this.datasetLabels.slice(0,55e4),this.testLabels=this.datasetLabels.slice(55e4)}getTrainData(){return{xs:w.yXz(this.trainImages,[this.trainImages.length/Y,28,28,1]),labels:w.odF(this.trainLabels,[this.trainLabels.length/G,G])}}getTestData(t){let e=w.yXz(this.testImages,[this.testImages.length/Y,28,28,1]),i=w.odF(this.testLabels,[this.testLabels.length/G,G]);return null!=t&&(e=e.slice([0,0,0,0],[t,28,28,1]),i=i.slice([0,0],[t,G])),{xs:e,labels:i}}}class z extends g{constructor(t){super(t),this.p=[0,0],this.Init()}Init(){}RenderIndependentCanvas(t){t.fillStyle="#ff0000",t.beginPath(),t.arc(this.p[0],this.p[1],5,0,6.28),t.closePath(),t.fill()}MouseDown(t,e){this.p=[t,e]}MouseMove(t,e){this.p=[t,e]}}class O{constructor(t){this.implementation=void 0,this.canvas=void 0,this.activeCommandController=void 0,this.definitions=[],this.implementation=t,this.canvas=t.app.model.graphicsCoreWrapper.canvasWrapper.canvas,this.activeCommandController=new h(this),this.Init(),this.InitDefinition(),this.InitDefault(),this.InitPullDown()}Init(){this.definitions=[]}get width(){return this.implementation.app.model.graphicsCoreWrapper.canvasWrapper.canvas.canvas.width}get height(){return this.implementation.app.model.graphicsCoreWrapper.canvasWrapper.canvas.canvas.height}InitDefinition(){for(let t of this.definitions)t.Init(this.implementation.app.model.graphicsCoreWrapper.canvasWrapper.canvas.ctx)}Render(t){}MouseMove(t,e){for(let i of this.definitions)i.MouseMovePre(t,e)}MouseLeftClick(t,e){for(let i of this.definitions)i.MouseLeftClickPre(t,e)}MouseDown(t,e){for(let i of this.definitions)i.MouseDownPre(t,e)}MouseUp(t,e){for(let i of this.definitions)i.MouseUpPre(t,e)}MouseDrag(t,e){for(let i of this.definitions)i.MouseDragPre(t,e)}MouseMiddleClick(t,e){for(let i of this.definitions)i.MouseMiddleClickPre(t,e)}MouseRightClick(t,e){for(let i of this.definitions)i.MouseRightClickPre(t,e)}MouseDoubleClick(t,e){for(let i of this.definitions)i.MouseDoubleClickPre(t,e)}MouseWheel(t,e,i){for(let s of this.definitions)s.MouseWheelPre(t,e,i)}Dispose(){this.definitions=[]}InitDefault(){}LoadDefinition(t){"blank"===t&&new z(this),"TFModel02XOR"===t&&new H(this,480,500),"TFModel03Iris"===t&&new $(this,480,500),"TFModel03SmartDrawing"===t&&new F(this,480,500),"TFModel01HorsepowerAndMilesPerGallon"===t&&new E(this,500,500),"TFModel01"===t&&new P(this,500,500),"JSLinearRegression"===t&&new f(this),"JSLinearRegressionGD"===t&&new M(this),"TFLinearRegressionGD"===t&&new R(this),"TFPolynomialRegression GD"===t&&new C(this),"TFPolyRegress Interaction"===t&&new x(this,500,500),"TFMnist"===t&&new U(this,500,500)}InitPullDown(){this.implementation.app.viewController.NUIWrapper.NUI.pullDownMenuWrapper.menus[1].AddApp("mlProject@TFModel01"),this.implementation.app.viewController.NUIWrapper.NUI.pullDownMenuWrapper.menus[1].AddApp("mlProject@TFModel02XOR"),this.implementation.app.viewController.NUIWrapper.NUI.pullDownMenuWrapper.menus[1].AddApp("mlProject@TFModel03Iris"),this.implementation.app.viewController.NUIWrapper.NUI.pullDownMenuWrapper.menus[1].AddApp("mlProject@--"),this.implementation.app.viewController.NUIWrapper.NUI.pullDownMenuWrapper.menus[1].AddApp("mlProject@TFModel03SmartDrawing"),this.implementation.app.viewController.NUIWrapper.NUI.pullDownMenuWrapper.menus[1].AddApp("mlProject@TFModel01HorsepowerAndMilesPerGallon"),this.implementation.app.viewController.NUIWrapper.NUI.pullDownMenuWrapper.menus[1].AddApp("tfProject@TFPlayground01"),this.implementation.app.viewController.NUIWrapper.NUI.pullDownMenuWrapper.menus[1].AddApp("tfProject@JSLinearRegression"),this.implementation.app.viewController.NUIWrapper.NUI.pullDownMenuWrapper.menus[1].AddApp("tfProject@JSLinearRegressionGD"),this.implementation.app.viewController.NUIWrapper.NUI.pullDownMenuWrapper.menus[1].AddApp("tfProject@TFLinearRegressionGD"),this.implementation.app.viewController.NUIWrapper.NUI.pullDownMenuWrapper.menus[1].AddApp("tfProject@--"),this.implementation.app.viewController.NUIWrapper.NUI.pullDownMenuWrapper.menus[1].AddApp("tfProject@TFPolynomialRegression GD"),this.implementation.app.viewController.NUIWrapper.NUI.pullDownMenuWrapper.menus[1].AddApp("tfProject@TFPolyRegress Interaction"),this.implementation.app.viewController.NUIWrapper.NUI.pullDownMenuWrapper.menus[1].AddApp("tfProject@TFPolyRegress Miles/Gallon"),this.implementation.app.viewController.NUIWrapper.NUI.pullDownMenuWrapper.menus[1].AddApp("tfProject@--"),this.implementation.app.viewController.NUIWrapper.NUI.pullDownMenuWrapper.menus[1].AddApp("tfProject@TF Regression")}}}}]);
//# sourceMappingURL=3053.46d789fd.chunk.js.map