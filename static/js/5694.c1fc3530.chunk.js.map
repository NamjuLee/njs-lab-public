{"version":3,"file":"static/js/5694.c1fc3530.chunk.js","mappings":"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","sources":["njslab/Tools/CanvasNavigation/index.ts"],"sourcesContent":["import { RendererCanvas } from '../../../lib'\r\n\r\nexport class Solution {\r\n    public divHost: HTMLElement;\r\n    public renderer: CanvasNavigation;\r\n    public div: HTMLElement;\r\n    constructor(divHost: any) {\r\n        this.divHost = divHost;\r\n\r\n        // Center align\r\n        this.divHost.style.display = 'flex';\r\n        this.divHost.style.alignItems = 'center';\r\n\r\n        this.div = document.createElement('div');\r\n        this.div.style.marginLeft = 'auto';\r\n        this.div.style.marginRight = 'auto';\r\n        this.div.style.backgroundColor = '#555';\r\n        this.div.style.width = '1000px';\r\n        this.div.style.height = '600px';\r\n        this.divHost.appendChild(this.div);\r\n\r\n        // TODO\r\n        // You code goes here for one time operation\r\n\r\n        this.renderer = new CanvasNavigation(this);\r\n\r\n        // console.log(this.renderer);\r\n        // !! you should execute it for rendering\r\n        // this.start();\r\n    }\r\n    public destroy() {\r\n        this.renderer.destroy();\r\n        while (this.divHost.lastElementChild) {\r\n            this.divHost.removeChild(this.divHost.lastElementChild);\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport class CanvasNavigation {\r\n    solution: Solution;\r\n\r\n    canvas: HTMLCanvasElement;\r\n    statusRendering: Vector;\r\n    statusTarget: Vector = new Vector(200, 200, 4);\r\n\r\n    needInterpolation: boolean = false;\r\n\r\n    img: HTMLImageElement;\r\n    ctx: CanvasRenderingContext2D;\r\n\r\n    speedInterpolation: number = 0.1;\r\n    easingInterpolation: boolean = true;\r\n\r\n    constructor(solution: Solution) {\r\n        this.solution = solution;\r\n        // https://gist.github.com/dzhang123/2a3a611b3d75a45a3f41\r\n        // refer: https://codepen.io/NJStudio/pen/poZoEgY?editors=0010\r\n        this.canvas = document.createElement('canvas');\r\n        this.canvas.style.background = '#555';\r\n        // this.canvas.style.width = '100%';\r\n        // this.canvas.style.height = '100%';\r\n        this.canvas.width = 1000;\r\n        this.canvas.height = 600;\r\n        solution.div.appendChild(this.canvas);\r\n        this.ctx = this.canvas.getContext('2d')\r\n\r\n\r\n        this.statusRendering = new Vector(0, 0, 1)\r\n        let statusPre = new Vector(0, 0, 1)\r\n        let status = new Vector(0, 0, 1)\r\n        let isDrag = false\r\n\r\n        this.canvas.addEventListener('mousedown', (e) => {\r\n            const { offsetX, offsetY } = e\r\n            status.x = offsetX\r\n            status.y = offsetY\r\n            isDrag = true\r\n            // if (status.z > 2) isDrag = true\r\n        });\r\n        this.canvas.addEventListener('mouseup', (e) => {\r\n            if (!isDrag) return\r\n            const { offsetX, offsetY } = e\r\n            const dx = offsetX - status.x\r\n            const dy = offsetY - status.y\r\n            statusPre.x += dx\r\n            statusPre.y += dy\r\n            isDrag = false\r\n        });\r\n        this.canvas.addEventListener('wheel', (e) => {\r\n            const { offsetX, offsetY, deltaY } = e\r\n\r\n            const oy = deltaY < 0 ? 1 : -1\r\n            status.z += (0.2 * oy)\r\n\r\n            if (status.z < 0.2) {\r\n                status.z = 0.2\r\n            } else if (status.z > 2) {\r\n                status.z = 2\r\n            }\r\n\r\n            const { x: zx, y: zy } = zoomOffset(this.canvas, status.z, { x: offsetX, y: offsetY }, statusPre)\r\n            statusPre.x = zx;\r\n            statusPre.y = zy;\r\n            statusPre.z = status.z;\r\n\r\n            this.statusRendering.x = zx;\r\n            this.statusRendering.y = zy;\r\n            this.statusRendering.z = status.z;\r\n\r\n            // draw(ctx, image, this.statusRendering);\r\n        });\r\n        this.canvas.addEventListener('mousemove', (e) => {\r\n            if (!isDrag) return\r\n            const { offsetX, offsetY } = e\r\n            const x = statusPre.x + (offsetX - status.x)\r\n            const y = statusPre.y + (offsetY - status.y)\r\n            const { x: zx, y: zy } = applyBoundaries(this.canvas, statusPre.z, { x, y })\r\n\r\n            this.statusRendering.x = zx;\r\n            this.statusRendering.y = zy;\r\n            this.statusRendering.z = statusPre.z;\r\n            // draw(ctx, image, this.statusRendering)\r\n        });\r\n\r\n\r\n        this.render(this.ctx);\r\n\r\n    }\r\n    public destroy() {\r\n\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D) {\r\n        requestAnimationFrame(() => { this.render(ctx); });\r\n\r\n        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height)\r\n        ctx.save()\r\n        ctx.translate(this.statusRendering.x, this.statusRendering.y)\r\n        ctx.scale(this.statusRendering.z, this.statusRendering.z)\r\n\r\n\r\n        ctx.beginPath();\r\n        ctx.arc(0, 0, 100, 0, Math.PI)\r\n        ctx.closePath();\r\n        ctx.fill();\r\n\r\n        ctx.restore()\r\n    }\r\n}\r\nexport class Vector {\r\n    static add(v0: Vector, v1: Vector) {\r\n        return new Vector(v0.x + v1.x, v0.y + v1.y, v0.z + v1.z);\r\n    }\r\n    static subtract(v0: Vector, v1: Vector) {\r\n        return new Vector(v0.x - v1.x, v0.y - v1.y, v0.z - v1.z);\r\n    }\r\n    public static distance(v0: Vector, v1: Vector): number {\r\n        return Math.sqrt((v0.x - v1.x) * (v0.x - v1.x) + (v0.y - v1.y) * (v0.y - v1.y) + (v0.z - v1.z) * (v0.z - v1.z));\r\n    }\r\n    public static deepCopy(v: Vector): Vector {\r\n        return new Vector(v.x, v.y, v.z);\r\n    }\r\n    public x: number\r\n    public y: number\r\n    public z: number\r\n    constructor(x: number, y: number, z: number) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n    }\r\n    public length(): number {\r\n        return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\r\n    }\r\n    public normalize() {\r\n        let len: number = Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\r\n        this.x /= len;\r\n        this.y /= len;\r\n        this.z /= len;\r\n    }\r\n};\r\nexport const zoomOffset = (canvas, scale, { x, y }, statusPre) => {\r\n    const isZooming = scale !== 1\r\n    const newX = isZooming ? (x + Math.abs(statusPre.x)) / statusPre.z : x\r\n    const newY = isZooming ? (y + Math.abs(statusPre.y)) / statusPre.z : y\r\n    const dx = newX - (newX * scale) + (x - newX)\r\n    const dy = newY - (newY * scale) + (y - newY)\r\n    return { ...applyBoundaries(canvas, scale, { x: dx, y: dy }) }\r\n};\r\nexport const applyBoundaries = (canvas, scale, { x, y }) => {\r\n    const scaleMargin = 1 - scale;\r\n    const maxOffsetX = scaleMargin * canvas.width;\r\n    const maxOffsetY = scaleMargin * canvas.height;\r\n    if (x > 0) {\r\n        x = 0\r\n    } else if (x < maxOffsetX) {\r\n        x = maxOffsetX;\r\n    }\r\n    if (y > 0) {\r\n        y = 0\r\n    } else if (y < maxOffsetY) {\r\n        y = maxOffsetY;\r\n    }\r\n    return { x, y }\r\n};"],"names":["Solution","constructor","divHost","renderer","div","this","style","display","alignItems","document","createElement","marginLeft","marginRight","backgroundColor","width","height","appendChild","CanvasNavigation","destroy","lastElementChild","removeChild","solution","canvas","statusRendering","statusTarget","Vector","needInterpolation","img","ctx","speedInterpolation","easingInterpolation","background","getContext","statusPre","status","isDrag","addEventListener","e","offsetX","offsetY","x","y","dx","dy","deltaY","oy","z","zx","zy","zoomOffset","applyBoundaries","render","requestAnimationFrame","clearRect","save","translate","scale","beginPath","arc","Math","PI","closePath","fill","restore","static","v0","v1","sqrt","v","length","normalize","len","isZooming","newX","abs","newY","scaleMargin","maxOffsetX","maxOffsetY"],"sourceRoot":""}