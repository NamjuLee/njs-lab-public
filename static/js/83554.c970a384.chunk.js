"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[83554],{83554:(e,t,o)=>{o.r(t),o.d(t,{Demo12WebGLGLSLPlayground:()=>h});class i{constructor(e){this.app=void 0,this.gl=void 0,this.canvas=void 0,this.app=e,this.canvas=document.createElement("canvas"),this.app.divHost&&(this.app.divHost.appendChild(this.canvas),this.canvas.width=this.app.divHost.clientWidth,this.canvas.height=this.app.divHost.clientHeight);const t=this.canvas.getContext("webgl2");t&&(this.gl=t),this.loop(this.gl)}loop(e){requestAnimationFrame((()=>{this.loop(e)})),this.clear(e),this.Render(e)}Render(e){}clear(e){e.clearColor(1,1,1,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}}class r{static getShader(e,t,o){const i=e.createShader(t);if(null!==i)return e.shaderSource(i,o),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)?i:(console.log("An error occurred compiling the shaders:"+e.getShaderInfoLog(i)),e.deleteShader(i),null)}static createProgram(e,t,o){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=e.createProgram();if(null===r)return null;if(e.attachShader(r,t),e.attachShader(r,o),e.linkProgram(r),!e.getProgramParameter(r,e.LINK_STATUS)){const i=e.getProgramInfoLog(r);return console.log("Failed to link program: "+i),e.deleteProgram(r),e.deleteShader(o),e.deleteShader(t),null}return i&&(e.validateProgram(r),!e.getProgramParameter(r,e.VALIDATE_STATUS))?(console.error("Failed to validate program",e.getProgramInfoLog(r)),e.deleteProgram(r),e.deleteShader(o),e.deleteShader(t),null):(e.deleteShader(o),e.deleteShader(t),r)}static createShader(e,t,o){const i=e.createShader(t);if(null===i)return null;e.shaderSource(i,o),e.compileShader(i);return e.getShaderParameter(i,e.COMPILE_STATUS)?i:(console.log(e.getShaderInfoLog(i)),e.deleteShader(i),null)}static createShaderFromPath(e,t,o){const i=e.createShader(t);if(null===i)return null;e.shaderSource(i,r.getSourceSynch(o)),e.compileShader(i);return e.getShaderParameter(i,e.COMPILE_STATUS)?i:(console.log(e.getShaderInfoLog(i)),e.deleteShader(i),null)}static getSourceSynch(e){const t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),200===t.status?t.responseText:null}static loadImage(e,t){const o=new Image;o.onload=function(){t(null,o)},o.src=e}}class s{constructor(e){this.scene=void 0,this.scene=e,this.scene.list.push(this)}Render(e){}}class n extends s{constructor(e,t){super(e),this.v="#version 300 es\n\n        in vec3 a_position;\n        uniform vec2 uMouseLoc;\n        uniform float uTime;\n\n        out vec2 mou;\n        out float t;\n\n        void main(void) {\n\n            gl_Position = vec4(a_position, 1.0);\n\n            mou = uMouseLoc;\n            t = uTime;\n        }\n    ",this.f="#version 300 es\n        precision mediump float;\n\n        in vec2 mou;\n        in float t;\n        out vec4 finalColor;\n\n        void main(void) {\n            float r = 1.0;\n            float g = sign(1.0 * t);\n            float b = 1.0;\n            finalColor = vec4(r, g, b, 1.0);\n        }\n    ",this.gl=void 0,this.vShader=void 0,this.fShader=void 0,this.program=void 0,this.aPositionLoc=void 0,this.uMouseLoc=void 0,this.uTime=void 0,this.size=100,this.time=0,this.gl=t,this.initShader(t)}initShader(e){let t=r.createShader(e,e.VERTEX_SHADER,this.v),o=r.createShader(e,e.FRAGMENT_SHADER,this.f);if(t&&o){this.vShader=t,this.fShader=o;let i=r.createProgram(e,this.vShader,this.fShader,!0);i&&(this.program=i,e.useProgram(this.program),this.aPositionLoc=e.getAttribLocation(this.program,"a_position"),this.uMouseLoc=e.getUniformLocation(this.program,"uMouseLoc"),this.uTime=e.getUniformLocation(this.program,"uTime"),e.useProgram(null),this.initGeo(e))}else console.error("vertex fragment shader error")}initGeo(e){let t=new Float32Array([-1,1,0,1,-1,0,-1,-1,0,-1,1,0,1,1,0,1,-1,0]),o=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),e.useProgram(this.program),e.uniform2f(this.uMouseLoc,10,10),e.uniform1f(this.uTime,0),e.bindBuffer(e.ARRAY_BUFFER,o),e.enableVertexAttribArray(this.aPositionLoc),e.vertexAttribPointer(this.aPositionLoc,3,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,null)}Render(e){let t=this.scene.app.m[0]/e.canvas.width*2-1,o=2*(1-this.scene.app.m[1]/e.canvas.height)-1;console.log(t,o),e.uniform2f(this.uMouseLoc,t,o),e.uniform1f(this.uTime,this.time),e.drawArrays(e.TRIANGLE_STRIP,0,6),this.time+=.01}Dummy(){}}class a{constructor(e){this.app=void 0,this.list=[],this.app=e,this.app.coreWebg2.Render=this.Render.bind(this),this.Init()}Init(){new n(this,this.app.coreWebg2.gl).Dummy(),console.log("init done")}Render(e){for(let t=0;t<this.list.length;++t)this.list[t].Render(e)}}class h{static Init(e){console.log(e),new h(e)}constructor(e){this.divHost=void 0,this.coreWebg2=void 0,this.scene=void 0,this.m=[];const t=document.getElementById(e);t&&(this.divHost=t,this.divHost.onmousemove=e=>{this.m[0]=e.x,this.m[1]=e.y}),this.coreWebg2=new i(this),this.scene=new a(this),console.log("Demo12WebGLGLSLPlayground")}}}}]);
//# sourceMappingURL=83554.c970a384.chunk.js.map