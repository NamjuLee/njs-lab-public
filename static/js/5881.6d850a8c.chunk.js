"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[5881],{45881:function(t,e,i){i.r(e),i.d(e,{Renderer:function(){return u},Solution:function(){return y}});var s=i(60136),h=i(29388),n=i(15671),r=i(43144),o=i(55913),a=i(37762),l=i(9936),d=function(){function t(){(0,n.Z)(this,t),this.boids=[],this.boundary=void 0,this._toggleTargetRendering=!1,this.boids=[],this.boundary=[new o.P(50,50,0),new o.P(300,70,0),new o.P(400,400,0),new o.P(50,300,0),new o.P(50,50,0)]}return(0,r.Z)(t,[{key:"toggleTargetRendering",value:function(t){this._toggleTargetRendering=t}},{key:"updateTargetDelay",value:function(t){for(var e=0;e<this.boids.length;++e)this.boids[e].targetDelay=t}},{key:"updateMass",value:function(t){for(var e=0;e<this.boids.length;++e)this.boids[e].mass=t}},{key:"updateVelocity",value:function(t){for(var e=0;e<this.boids.length;++e)this.boids[e].maxVelocity=t}},{key:"AddAgent",value:function(t,e,i,s){var h=new c(this,new o.P(t,e),new o.P(0,0),new o.P(i,s),this.boundary);this.boids.push(h)}},{key:"Update",value:function(){var t,e=(0,a.Z)(this.boids);try{for(e.s();!(t=e.n()).done;){t.value.Update()}}catch(i){e.e(i)}finally{e.f()}}},{key:"GetPoint",value:function(){var t,e=[],i=(0,a.Z)(this.boids);try{for(i.s();!(t=i.n()).done;){var s=t.value;s.isRenderable&&e.push(s.p)}}catch(h){i.e(h)}finally{i.f()}return e}},{key:"Render",value:function(t){this.boids.forEach((function(e){e.Render(t)})),t.beginPath(),t.moveTo(this.boundary[0].x,this.boundary[0].y);for(var e=1;e<this.boundary.length;++e)t.lineTo(this.boundary[e].x,this.boundary[e].y);t.stroke()}}]),t}(),c=function(){function t(e,i,s,h,r){(0,n.Z)(this,t),this.maxForce=2,this.maxVelocity=2,this.maxSpeed=.9,this.mass=100.2,this.isRenderable=!0,this.p=void 0,this.p0=void 0,this.p1=void 0,this.targets=void 0,this.target=void 0,this.targetID=0,this.col=!1,this.desiredVelocity=void 0,this.steering=void 0,this.velocity=new o.P(0,0,0),this.wanderAngle=0,this.CIRCLE_DISTANCE=50,this.CIRCLE_RADIUS=50,this.ANGLE_CHANGE=15,this.t=0,this.MAX_QUEUE_AHEAD=15,this.MAX_QUEUE_RADIUS=10,this.trajectory=[],this.timerTrajectory=0,this.scaleBounding=0,this.boundary=void 0,this.controller=void 0,this.targetDelay=3,this.controller=e,t.list.push(this),this.p=i,this.p0=s,this.p1=h,r&&(this.boundary=r),this.UpdateTarget()}return(0,r.Z)(t,[{key:"Update",value:function(){this.UpdateVec1()}},{key:"UpdateTarget",value:function(){var t=this.getRandomVecInSide();if(void 0!==this.boundary)for(;!(0,o.X0)(t,this.boundary);)t=this.getRandomVecInSide();this.target=t}},{key:"getRandomVecInSide",value:function(){var t=l.$H.GetRandomInt(this.p0.x,this.p1.x),e=l.$H.GetRandomInt(this.p0.y,this.p1.y);return new o.P(t,e)}},{key:"UpdateVec1",value:function(){this.desiredVelocity=new o.P(this.target.x-this.p.x,this.target.y-this.p.y,this.target.z-this.p.z),this.desiredVelocity.unitize(),this.desiredVelocity.x*=this.maxVelocity,this.desiredVelocity.y*=this.maxVelocity,this.desiredVelocity.z*=this.maxVelocity;var t=this.desiredVelocity.x-this.velocity.x<this.maxForce?this.desiredVelocity.x-this.velocity.x:this.maxForce,e=this.desiredVelocity.y-this.velocity.y<this.maxForce?this.desiredVelocity.y-this.velocity.y:this.maxForce,i=this.desiredVelocity.z-this.velocity.z<this.maxForce?this.desiredVelocity.z-this.velocity.z:this.maxForce;this.steering=new o.P(t/this.mass,e/this.mass,i/this.mass),this.velocity.x=this.velocity.x+this.steering.x<this.maxSpeed?this.velocity.x+this.steering.x:this.maxSpeed,this.velocity.y=this.velocity.y+this.steering.y<this.maxSpeed?this.velocity.y+this.steering.y:this.maxSpeed,this.velocity.z=this.velocity.z+this.steering.z<this.maxSpeed?this.velocity.z+this.steering.z:this.maxSpeed,this.Queue(),this.p.x+=this.velocity.x,this.p.y+=this.velocity.y,this.p.z+=this.velocity.z,this.t+=.01,this.t>this.targetDelay&&(this.t=0,this.UpdateTarget())}},{key:"UpdateVec0",value:function(){this.steering=this.Wander(new o.P(this.velocity.x,this.velocity.y,this.velocity.z)),this.steering.x=this.steering.x<this.maxForce?this.steering.x:this.maxForce,this.steering.y=this.steering.y<this.maxForce?this.steering.y:this.maxForce,this.steering.z=this.steering.z<this.maxForce?this.steering.z:this.maxForce,this.steering.x/=this.mass,this.steering.y/=this.mass,this.steering.z/=this.mass,this.velocity.x+this.steering.x<this.maxSpeed?this.velocity.x=this.velocity.x+this.steering.x:this.velocity.x=this.maxSpeed,this.velocity.y+this.steering.y<this.maxSpeed?this.velocity.y=this.velocity.y+this.steering.y:this.velocity.y=this.maxSpeed,this.velocity.z+this.steering.z<this.maxSpeed?this.velocity.z=this.velocity.z+this.steering.z:this.velocity.z=this.maxSpeed,this.Queue(),console.log(this.maxSpeed),this.p.x+=this.velocity.x,this.p.y+=this.velocity.y,this.p.z+=this.velocity.z}},{key:"Wander",value:function(t){var e=new o.P(t.x,t.y,t.z);e.normalize(),e.scale(this.CIRCLE_DISTANCE);var i=new o.P(0,-1);return i.scale(this.CIRCLE_RADIUS),i=this.setAngle(i,this.wanderAngle),this.wanderAngle+=Math.random()*this.ANGLE_CHANGE-.5*this.ANGLE_CHANGE,e.add(i)}},{key:"setAngle",value:function(t,e){var i=t.length();return t.x=Math.cos(e)*i,t.y=Math.sin(e)*i,t}},{key:"GetNeighborAhead",value:function(){var e=void 0,i=this.velocity.clone();i.normalize(),i.scale(this.MAX_QUEUE_AHEAD);for(var s=this.p.clone().add(i),h=0;h<t.list.length;h++){var n=t.list[h],r=o.P.distanceTo(s,n.p);if(n!==this&&r<=this.MAX_QUEUE_RADIUS){e=n;break}}return e}},{key:"Queue",value:function(){return void 0!==this.GetNeighborAhead()&&this.velocity.scale(.3),new o.P(0,0)}},{key:"Render",value:function(t){this.RenderCircle(t)}},{key:"RenderDesiredVelocity",value:function(t){}},{key:"RenderCurrentVelocity",value:function(t){}},{key:"RenderCircle",value:function(t){this.t+=.05,this.timerTrajectory+=1,this.timerTrajectory%5===0&&(this.trajectory.length>30&&this.trajectory.shift(),this.trajectory.push(new o.P(this.p.x,this.p.y)),this.timerTrajectory=0);for(var e=0;e<this.trajectory.length;++e)t.fillStyle="rgba(100, 100, 100 ,0.1)",t.beginPath(),t.arc(this.trajectory[e].x,this.trajectory[e].y,.2*e,0,6.28),t.closePath(),t.fill();t.strokeStyle="#000000",t.lineWidth=.5,this.controller._toggleTargetRendering&&(t.beginPath(),t.moveTo(this.p.x,this.p.y),t.lineTo(this.target.x,this.target.y),t.stroke(),t.fillStyle="#000000",t.beginPath(),t.arc(this.target.x,this.target.y,2.5,0,6.28),t.closePath(),t.fill()),t.fillStyle="#000000",t.beginPath(),t.arc(this.p.x,this.p.y,2.5,0,6.28),t.closePath(),t.fill(),t.beginPath(),t.arc(this.p.x,this.p.y,10+5*Math.sin(this.t),0,6.28),t.closePath(),t.stroke(),t.lineWidth=.5,t.strokeStyle="rgba(".concat(255,", ",255,", ",0,", ",1-.07*this.scaleBounding,")"),t.beginPath(),t.arc(this.p.x,this.p.y,this.scaleBounding,0,6.28),t.closePath(),t.stroke(),this.scaleBounding+=.2,1-.07*this.scaleBounding<0&&(this.scaleBounding=0)}}]),t}();c.list=[];var y=function(){function t(e){var i=this;(0,n.Z)(this,t),this.divHost=void 0,this.renderer=void 0,this.divHost=e,this.divHost.style.display="flex",this.divHost.style.alignItems="center";var s=document.createElement("div");s.style.marginLeft="auto",s.style.marginRight="auto",s.style.backgroundColor="#333",s.style.width="500px",s.style.height="500px",this.divHost.appendChild(s),this.renderer=new u(s);var h=document.createElement("div");s.append(h),h.textContent="Click or drag on canvas to populate agents";var r=document.createElement("div");s.append(r);var a=(0,o.Du)("Delay",1,10);s.appendChild(a.div),a.slider.defaultValue="3",a.slider.oninput=function(){i.renderer.BoidContoller.updateTargetDelay(+a.slider.value)};var l=(0,o.Du)("Mass",1,500);s.appendChild(l.div),l.slider.defaultValue="3",l.slider.oninput=function(){i.renderer.BoidContoller.updateMass(+l.slider.value)};var d=(0,o.Du)("Velocity",1,10);s.appendChild(d.div),d.slider.defaultValue="3",d.slider.oninput=function(){i.renderer.BoidContoller.updateVelocity(+d.slider.value)};var c=(0,o.Vv)("target");r.appendChild(c.div),c.checkBox.checked=!1,c.checkBox.onchange=function(){!0===c.checkBox.checked?i.renderer.toggleTargetRendering(!0):i.renderer.toggleTargetRendering(!1)}}return(0,r.Z)(t,[{key:"destroy",value:function(){for(this.renderer.destroy();this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}}]),t}(),u=function(t){(0,s.Z)(i,t);var e=(0,h.Z)(i);function i(t){var s;return(0,n.Z)(this,i),(s=e.call(this,t)).BoidContoller=void 0,s.dragTime=0,s.canvas.style.position="relative",s.canvas.style.width="100%",s.canvas.style.height="100%",s.BoidContoller=new d,s.start(),s}return(0,r.Z)(i,[{key:"toggleTargetRendering",value:function(t){this.BoidContoller.toggleTargetRendering(t)}},{key:"mouseDown",value:function(t,e){}},{key:"mouseUp",value:function(t,e){this.BoidContoller.AddAgent(t,e,this.canvas.width,this.canvas.height)}},{key:"mouseDrag",value:function(t,e){this.dragTime>5&&(this.BoidContoller.AddAgent(t,e,this.canvas.width,this.canvas.height),this.dragTime=0),this.dragTime++}},{key:"render",value:function(t){this.BoidContoller.Update(),this.BoidContoller.Render(t)}}]),i}(o.bb)}}]);
//# sourceMappingURL=5881.6d850a8c.chunk.js.map