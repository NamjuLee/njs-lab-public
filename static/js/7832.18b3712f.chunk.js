"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[7832],{7832:(t,e,s)=>{s.r(e),s.d(e,{DynamicSpringTruss:()=>R});class i{constructor(){}}class h{constructor(t){this.app=void 0,this.app=t}}var o=s(17760),r=s(98925),n=s(11977);let a,d;!function(t){t.PERSPECTIVE="PERSPECTIVE",t.ORTHOGRAPHIC="ORTHOGRAPHIC",t.STEREO="STEREO"}(a||(a={}));class p{constructor(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a.PERSPECTIVE;this.canvas=void 0,this.cameraP=void 0,this.cameraO=void 0,this.controls=void 0,this.initX=0,this.initY=0,this.prevX=0,this.prevY=0,this.yRotRate=void 0,this.xRotRate=void 0,this.xPanRate=void 0,this.yPanRate=void 0,this.zPanRate=void 0,this.rotateRate=150,this.panRate=50,this.zoomRate=200,this.zoomFactor=1,this.frustumSize=.001,this.type=void 0,this.cameraShift=0,this.width=void 0,this.height=void 0,this.ableToMove=!0,this.stereoCamera=void 0,this.canvas=t,this.type=i,this.width=e,this.height=s,this.type===a.PERSPECTIVE?this.GetPerspective(0,10,50):this.type===a.ORTHOGRAPHIC?this.GetOrthographic():this.type===a.STEREO&&this.GetStereo(),this.stereoCamera=new o.u37}GetStereo(){}set aspect(t){this.type===a.PERSPECTIVE?this.cameraP.aspect=t:(this.type,a.ORTHOGRAPHIC)}get aspect(){return this.width/this.height}get camera(){return this.type===a.PERSPECTIVE?this.cameraP:this.type===a.ORTHOGRAPHIC?this.cameraO:this.cameraP}GetPerspective(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;this.cameraP=new o.cPb(45,this.width/this.height,.01,1e4),this.cameraP.position.set(t,e,s),this.InitOrbitController()}GetOrthographic(){this.cameraO=new o.iKG(this.frustumSize*this.aspect/-2,this.frustumSize*this.aspect/2,this.frustumSize/2,this.frustumSize/-2,.01,5e4),this.cameraO.position.set(0,1,0),this.InitOrbitController()}InitOrbitController(){this.type===a.PERSPECTIVE?this.controls=new r.OrbitControls(this.cameraP,this.canvas.renderer.domElement):this.type===a.ORTHOGRAPHIC&&(this.controls=new r.OrbitControls(this.cameraO,this.canvas.renderer.domElement)),this.controls.minDistance=.01,this.controls.maxDistance=500,this.controls.enablePan=!0,this.controls.enableZoom=!0,this.yRotRate=this.rotateRate/this.width*Math.PI/90,this.xRotRate=this.rotateRate/this.height*Math.PI/180,this.xPanRate=this.panRate/this.width*this.zoomFactor,this.yPanRate=this.panRate/this.height*this.zoomFactor,this.zPanRate=this.zoomRate/this.height}EnableDamping(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.35;this.controls.enableDamping=t,this.controls.dampingFactor=e}MouseDown(t,e){this.initX=this.prevX=t,this.initY=this.prevY=e}MouseMove(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.ableToMove)return;const i=t-this.prevX,h=e-this.prevY;s?(this.controls.panLeft(i*this.xPanRate,this.cameraP.matrix),this.controls.panUp(h*this.yPanRate,this.cameraP.matrix)):(this.controls.rotateLeft(i*this.xRotRate),this.controls.rotateUp(h*this.yRotRate)),this.prevX=t,this.prevY=e}MouseWheel(t){this.controls.enableZoom=!0,t*=.1;const e=100*this.cameraP.position.length();this.zoomFactor=e,t>0?(this.cameraP.position.x*=.9,this.cameraP.position.y*=.9,this.cameraP.position.z*=.9):(this.cameraP.position.x*=1.1,this.cameraP.position.y*=1.1,this.cameraP.position.z*=1.1)}ShiftCamera(){this.cameraShift++,2===this.cameraShift&&(this.cameraShift=0),0===this.cameraShift?this.GetPerspective():1===this.cameraShift&&this.GetOrthographic()}MouseEventController(t){t.CLICK_TYPE===n.uh.DOWN&&this.MouseDown(t.x,t.y),t.CLICK_TYPE===n.uh.DRAG&&this.MouseMove(t.x,t.y,t.pressedShift),t.CLICK_TYPE===n.uh.WHEEL&&this.MouseWheel(t.wheel)}}class c{constructor(t,e){this.hostDiv=void 0,this.camera=void 0,this.scene=void 0,this.renderer=void 0,this.canvasWrapper=void 0,this.vrBtn=void 0,this.bg=0,this.isActive=!0,this.canvasWrapper=t,this.hostDiv=e,this.Init()}Init(){const t=this.hostDiv.clientWidth,e=this.hostDiv.clientHeight;this.renderer=new o.CP7({antialias:!0,alpha:!0}),this.renderer.setPixelRatio(t/e),this.camera=new p(this,t,e),this.scene=new o.xsS,this.renderer.domElement.id="dynamic-spring",this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.pointerEvents="none",this.renderer.setSize(t,e),this.hostDiv.appendChild(this.renderer.domElement),this.RenderLoop(this)}RenderLoop(t){this.isActive&&(requestAnimationFrame((()=>{this.RenderLoop(this)})),this.UpdateBinding(),this.camera.controls.update(),this.renderer.render(this.scene,this.camera.camera))}UpdateBinding(){console.log("implementation needed")}ResizeCanvas(t,e){this.camera.aspect=t/e,this.camera.camera.updateProjectionMatrix(),this.renderer.setSize(t,e)}ResizeEffect(t,e){}Remove(){for(;this.scene.children.length;)this.scene.remove(this.scene.children[0])}}class l{constructor(t){this.graphicsCoreWrapper=void 0,this.canvasThree=void 0,this.graphicsCoreWrapper=t,this.canvasThree=new c(this,this.graphicsCoreWrapper.app.divHost)}}class u{constructor(t){this.app=void 0,this.canvasWrapper=void 0,this.app=t,this.canvasWrapper=new l(this)}Resize(t,e){this.canvasWrapper.canvasThree.ResizeCanvas(t,e)}Dispose(){this.canvasWrapper.canvasThree.isActive=!1}}class m{constructor(t){this.scene=void 0,this.scene=t}MouseEventController(t){this.scene.app.graphicsCoreWrapper.canvasWrapper.canvasThree.camera.MouseEventController(t),t.CLICK_TYPE!==n.uh.LEFT?t.CLICK_TYPE!==n.uh.MIDDLE?t.CLICK_TYPE!==n.uh.DOWN_RIGHT?t.CLICK_TYPE!==n.uh.DOUBLE?t.CLICK_TYPE!==n.uh.MOVE?t.CLICK_TYPE!==n.uh.DRAG?t.CLICK_TYPE!==n.uh.DOWN?t.CLICK_TYPE!==n.uh.UP||this.MouseUpPre(t):this.MouseDownPre(t):this.MouseDragPre(t):this.MouseMovePre(t):this.MouseDoubleClickPre(t):this.MouseRightClickPre(t):this.MouseMiddleClickPre(t):this.MouseLeftClickPre(t)}MouseDown(t){}MouseDownPre(t){this.scene.MouseDown(t.x,t.y),this.MouseDown(t)}MouseLeftClick(t){}MouseLeftClickPre(t){this.MouseLeftClick(t)}MouseMiddleClick(t){}MouseMiddleClickPre(t){this.MouseMiddleClick(t)}MouseRightClick(t){}MouseRightClickPre(t){this.MouseRightClick(t)}MouseUp(t){}MouseUpPre(t){this.scene.MouseUp(t.x,t.y),this.MouseUp(t)}MouseDoubleClick(t){}MouseDoubleClickPre(t){this.MouseDoubleClick(t)}MouseMove(t){}MouseMovePre(t){this.scene.MouseMove(t.x,t.y),this.MouseMove(t)}MouseDrag(t){}MouseDragPre(t){this.scene.MouseDrag(t.x,t.y),this.MouseDrag(t)}}class g{constructor(t){this.scene=void 0,this.listMesh=[],this.raycaster=new o.iMs,this.m=new o.FM8(0,0),this.point=void 0,this.scene=t,this.raycaster.params.Points={threshold:.1}}Raycast(t,e,s){this.m.x=t/this.scene.app.graphicsCoreWrapper.canvasWrapper.canvasThree.renderer.domElement.clientWidth*2-1,this.m.y=-e/this.scene.app.graphicsCoreWrapper.canvasWrapper.canvasThree.renderer.domElement.clientHeight*2+1,this.raycaster.setFromCamera(this.m,this.scene.app.graphicsCoreWrapper.canvasWrapper.canvasThree.camera.camera);const i=this.raycaster.intersectObjects(s);if(i.length>0){const t=i[0];console.log(t.point)}}RaycastPoint(t,e,s){this.raycaster.params.Points={threshold:5},this.m.x=t/this.scene.app.graphicsCoreWrapper.canvasWrapper.canvasThree.renderer.domElement.clientWidth*2-1,this.m.y=-e/this.scene.app.graphicsCoreWrapper.canvasWrapper.canvasThree.renderer.domElement.clientHeight*2+1,this.raycaster.setFromCamera(this.m,this.scene.app.graphicsCoreWrapper.canvasWrapper.canvasThree.camera.camera);const i=this.raycaster.intersectObjects(s);if(i.length>0){const t=i[0];return[t.point.x,t.point.y,t.point.z]}return null}}class v{constructor(t){this.sceneWrapper=void 0,this.hemiLight=void 0,this.dirLight=void 0,this.sceneWrapper=t,this.Init()}Init(){this.hemiLight=new o.vmT(16777215,16777215,.6),this.hemiLight.color.setHSL(.6,1,.6),this.hemiLight.groundColor.setHSL(.095,1,.75),this.hemiLight.position.set(0,50,0),this.sceneWrapper.scene.add(this.hemiLight),this.dirLight=new o.Ox3(16777215,1),this.dirLight.color.setHSL(.1,1,.95),this.dirLight.position.set(-1,1.75,1),this.dirLight.position.multiplyScalar(30),this.dirLight.castShadow=!0,this.dirLight.shadow.mapSize.width=4096,this.dirLight.shadow.mapSize.height=4096;this.dirLight.shadow.camera.left=-50,this.dirLight.shadow.camera.right=50,this.dirLight.shadow.camera.top=50,this.dirLight.shadow.camera.bottom=-50,this.dirLight.shadow.bias=-1e-4,this.dirLight.shadow.camera.near=.001,this.dirLight.shadow.camera.far=350,this.sceneWrapper.scene.add(this.dirLight)}Dispose(){this.dirLight.visible=!1,this.hemiLight.visible=!1,this.sceneWrapper.scene.remove(this.dirLight),this.sceneWrapper.scene.remove(this.hemiLight)}}!function(t){t[t.particle=0]="particle",t[t.particleLine=1]="particleLine",t[t.thread=2]="thread",t[t.grid=3]="grid",t[t.fabric=4]="fabric",t[t.curtain=5]="curtain",t[t.tensileStructure=6]="tensileStructure",t[t.network=7]="network"}(d||(d={}));class C{constructor(t,e,s){this.p=n.h9.Origin(),this.f=n.h9.Origin(),this.u=n.h9.Origin(),this.m=0,this.Fixed=!1,this.isCapture=!1,this.p=new n.h9(t.x,t.y,t.z),this.u=new n.h9(e.x,e.y,e.z),this.m=s}Move(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.Fixed||(this.u.Mult(e),this.u.Add(n.h9.Scale(this.f,t/this.m)),this.p.Add(n.h9.Scale(this.u,t)),this.p.y<s&&(this.p.y=s,this.u.y<0&&(this.u.y=-this.u.y)))}}class E{constructor(t,e){this.n0=void 0,this.n1=void 0,this.targetLength=0,this.springConstant=.8,this.n0=t,this.n1=e,this.targetLength=this.n0.p.Distance(this.n1.p)}ApplySpringForce(){let t=n.h9.Sub(this.n1.p,this.n0.p),e=t.Length();t.Unitize();const s=n.h9.Scale(t,(e-this.targetLength)*this.springConstant);this.n0.f=n.h9.Add(this.n0.f,s),this.n1.f=n.h9.Sub(this.n1.f,s)}}class y{constructor(){this.nodes=[],this.edges=[]}Graph(){}InitTemplate(t,e,s,i,h,o,r,a){const p=(h-s)/(t-1),c=(o-i)/(e-1);switch(a){case d.particle:for(let e=0;e<t;++e)this.AddNode(new n.h9(.1*e,0,4),n.h9.Zero(),.2+.1*e);break;case d.thread:for(let e=0;e<t;++e)this.AddNode(new n.h9(.1*e,0,4),n.h9.Zero(),1);for(let e=0;e<t-1;++e)this.AddEdge(this.nodes[e],this.nodes[e+1]);this.nodes[this.nodes.length-1].Fixed=!0;break;case d.grid:for(let h=0;h<e;++h)for(let e=0;e<t;++e)this.AddNode(new n.h9(s+e*p,i+h*c,r),n.h9.Zero(),1);break;case d.fabric:for(let h=0;h<e;++h)for(let e=0;e<t;++e)this.AddNode(new n.h9(s+e*p,i+h*c,r),n.h9.Origin(),1);for(let s=0;s<e;++s)for(let e=0;e<t;++e){let i=s*t+e;0!==e&&this.AddEdge(this.nodes[i-1],this.nodes[i]),0!==s&&this.AddEdge(this.nodes[i-t],this.nodes[i])}break;case d.curtain:for(let h=0;h<e;++h)for(let e=0;e<t;++e)this.AddNode(new n.h9(s+e*p,i+h*c,r),n.h9.Zero(),1);for(let s=0;s<e;++s)for(let i=0;i<t;++i){let h=s*t+i;0!==i&&this.AddEdge(this.nodes[h-1],this.nodes[h]),0!==s&&this.AddEdge(this.nodes[h-t],this.nodes[h]),0!==i&&0!==s&&this.AddEdge(this.nodes[h-t-1],this.nodes[h]),0!==i&&s!==e-1&&this.AddEdge(this.nodes[h+t-1],this.nodes[h])}for(let e=0;e<t;++e)this.nodes[e].Fixed=!0;break;case d.tensileStructure:for(let h=0;h<e;++h)for(let e=0;e<t;++e)this.AddNode(new n.h9(s+e*p,i+h*c,r),n.h9.Zero(),1);for(let s=0;s<e;++s)for(let i=0;i<t;++i){let h=s*t+i;0!==i&&this.AddEdge(this.nodes[h-1],this.nodes[h]),0!==s&&this.AddEdge(this.nodes[h-t],this.nodes[h]),0!==i&&0!==s&&this.AddEdge(this.nodes[h-t-1],this.nodes[h]),0!==i&&s!==e-1&&this.AddEdge(this.nodes[h+t-1],this.nodes[h])}for(let s=0;s<e;++s)this.nodes[s*t].Fixed=!0;this.nodes[t-1].Fixed=!0,this.nodes[t-1].p.z=0,this.nodes[e*t-1].Fixed=!0,this.nodes[t*e/2+t/2].Fixed=!0,this.nodes[t*e/2+t/2].p.z=0;for(let t of this.edges)t.targetLength=.1;break;case d.network:for(let t=0;t<200;++t)this.AddNode(new n.h9(10*Math.random()-15,13+5*Math.random(),13+5*Math.random()),n.h9.Zero(),1);for(let t=0;t<this.nodes.length;++t)for(let e=t+1;e<this.nodes.length;++e)if(Math.random()<.1){this.AddEdge(this.nodes[t],this.nodes[e]).targetLength=8*Math.random()+.3}}}InitGridXY(t,e,s,i,h,o,r){const a=(h-s)/(t-1),d=(o-i)/(e-1),p=this.nodes.length;for(let c=0;c<e;++c)for(let e=0;e<t;++e)this.AddNode(new n.h9(s+e*a,i+c*d,r),n.h9.Zero(),1);for(let n=0;n<e;++n)for(let s=0;s<t;++s){let i=n*t+s;0!==s&&this.AddEdge(this.nodes[p+i-1],this.nodes[p+i]),0!==n&&this.AddEdge(this.nodes[p+i-t],this.nodes[p+i]),0!==s&&0!==n&&this.AddEdge(this.nodes[p+i-t-1],this.nodes[p+i]),0!==s&&n!==e-1&&this.AddEdge(this.nodes[p+i+t-1],this.nodes[p+i])}}InitTruss(t,e,s){const i=1/(t-1),h=this.nodes.length;for(let o=0;o<t;++o){const t=e.Clone();t.x=e.x+(s.x-e.x)*o*i,this.AddNode(t,n.h9.Zero(),1),t.y=s.y,this.AddNode(t,n.h9.Zero(),1),t.z=s.z,this.AddNode(t,n.h9.Zero(),1),t.y=e.y,this.AddNode(t,n.h9.Zero(),1)}for(let o=0;o<t;++o){let e=4*o;this.AddEdge(this.nodes[h+e],this.nodes[h+e+1]),this.AddEdge(this.nodes[h+e+1],this.nodes[h+e+2]),this.AddEdge(this.nodes[h+e+2],this.nodes[h+e+3]),this.AddEdge(this.nodes[h+e+3],this.nodes[h+e]),this.AddEdge(this.nodes[h+e],this.nodes[h+e+2]),this.AddEdge(this.nodes[h+e+1],this.nodes[h+e+3]),o!==t-1&&(this.AddEdge(this.nodes[h+e],this.nodes[h+e+4]),this.AddEdge(this.nodes[h+e+1],this.nodes[h+e+5]),this.AddEdge(this.nodes[h+e+2],this.nodes[h+e+6]),this.AddEdge(this.nodes[h+e+3],this.nodes[h+e+7]),this.AddEdge(this.nodes[h+e],this.nodes[h+e+5]),this.AddEdge(this.nodes[h+e+1],this.nodes[h+e+6]),this.AddEdge(this.nodes[h+e+2],this.nodes[h+e+7]),this.AddEdge(this.nodes[h+e+3],this.nodes[h+e+4]),this.AddEdge(this.nodes[h+e],this.nodes[h+e+6]),this.AddEdge(this.nodes[h+e+1],this.nodes[h+e+7]),this.AddEdge(this.nodes[h+e+2],this.nodes[h+e+4]),this.AddEdge(this.nodes[h+e+3],this.nodes[h+e+5]),this.AddEdge(this.nodes[h+e],this.nodes[h+e+7]),this.AddEdge(this.nodes[h+e+1],this.nodes[h+e+4]),this.AddEdge(this.nodes[h+e+2],this.nodes[h+e+5]),this.AddEdge(this.nodes[h+e+3],this.nodes[h+e+6]))}for(let o of this.edges)o.springConstant=2;this.nodes[0].Fixed=!0,this.nodes[1].Fixed=!0,this.nodes[2].Fixed=!0,this.nodes[3].Fixed=!0}Clear(){this.nodes=[],this.edges=[]}AddNode(t,e,s){const i=new C(t,e,s);return this.nodes.push(i),i}AddEdge(t,e){const s=new E(t,e);return this.edges.push(s),s}Move(t,e,s,i,h,o){for(let r=0;r<o;++r){for(const e of this.nodes){const i=n.h9.Sub(t,e.p),h=i.Length();i.Unitize(),e.f=n.h9.Add(n.h9.Scale(i,.1*Math.exp(-.1*h*h)),n.h9.Scale(n.h9.YAxis(),s))}for(const t of this.edges)t.ApplySpringForce();for(const t of this.nodes)t.Move(i,e,h)}}FindNode(t,e,s){for(let i=0;i<this.nodes.length;++i)if(this.nodes[i].p.Distance(new n.h9(t,e,s))<3)return this.nodes[i]}}class M{constructor(t,e,s,i){this.scene=void 0,this.geometry=void 0,this.material=void 0,this.pointCloud=void 0,this.verticesArray=void 0,this.num=100,this.scene=t,this.initGeometry(),this.initMaterial(),this.initPointCloud(),this.addInitialPoint(e,s,i)}initGeometry(){this.geometry=new o.u9r,this.verticesArray=new Float32Array(3*this.num),this.geometry.setAttribute("position",new o.TlE(this.verticesArray,3))}initMaterial(){this.material=new o.UY4({color:16711680,size:1.15,opacity:.5,transparent:!0})}initPointCloud(){this.pointCloud=new o.woe(this.geometry,this.material),this.scene.add(this.pointCloud)}addInitialPoint(t,e,s){this.verticesArray[0]=t,this.verticesArray[1]=e,this.verticesArray[2]=s,this.updateGeometry()}click(){this.num+=100,console.log(this.num);const t=new Float32Array(3*this.num);for(let e=0;e<this.num;e++){const s=3*e;t[s]=2*Math.random()-1,t[s+1]=2*Math.random()-1,t[s+2]=2*Math.random()-1}this.verticesArray=t,this.updateGeometry()}updateGeometry(){this.geometry.setAttribute("position",new o.TlE(this.verticesArray,3)),this.geometry.attributes.position.needsUpdate=!0,this.geometry.computeBoundingSphere()}dispose(){this.scene.remove(this.pointCloud),this.geometry.dispose(),this.material.dispose()}}class P{constructor(t){this.scene=void 0,this.geometry=void 0,this.material=void 0,this.lineSegments=void 0,this.vertices=[],this.scene=t,this.initGeometry(),this.initMaterial(),this.initLineSegments()}initGeometry(){this.geometry=new o.u9r}initMaterial(){this.material=new o.nls({color:16711680,opacity:1,transparent:!0})}initLineSegments(){this.lineSegments=new o.ejS(this.geometry,this.material),this.scene.add(this.lineSegments)}add(t,e,s){this.vertices.push(t,e,s),this.updateGeometry()}addLine(t,e,s,i,h,o){this.vertices.push(t,e,s,i,h,o),this.updateGeometry()}updateGeometry(){const t=new Float32Array(this.vertices);this.geometry.setAttribute("position",new o.TlE(t,3)),this.geometry.attributes.position.needsUpdate=!0,this.geometry.computeBoundingSphere()}dispose(){this.scene.remove(this.lineSegments),this.geometry.dispose(),this.material.dispose()}clear(){this.vertices=[],this.updateGeometry()}}class w{constructor(t){this.scene=void 0,this.Graph=void 0,this.point=[],this.Lines=void 0,this.damping=.96,this.gravity=-.032,this.timeStep=.316,this.groundZ=-9.26,this._capture=void 0,this.m=new n.h9(0,0,0),this.scene=t,this.Init()}Init(){console.log(d),this.Graph=new y,this.Graph.InitTruss(5,new n.h9(-20,20,-5),new n.h9(20,15,5));for(let t=0;t<this.Graph.nodes.length;++t){const e=this.Graph.nodes[t];this.point.push(new M(this.scene,e.p.x,e.p.y,e.p.z))}this.Lines=new P(this.scene);for(let t=0;t<this.Graph.edges.length;++t){const e=this.Graph.edges[t];this.Lines.Add(e.n0.p.x,e.n0.p.y,e.n0.p.z),this.Lines.Add(e.n1.p.x,e.n1.p.y,e.n1.p.z)}}get capture(){return this._capture}set capture(t){t?t.isCapture=!0:this._capture&&(this._capture.isCapture=!1),this._capture=t}GetPointForRaycast(){let t=[];for(let e=0;e<this.point.length;++e)t.push(this.point[e].pointCloud);return t}Update(){this.Graph.Move(new n.h9(100,10,10),this.damping,this.gravity,this.timeStep,this.groundZ,1);for(let t=0;t<this.Graph.nodes.length;++t){const e=this.Graph.nodes[t];this.point[t].geometry.vertices[0].x=e.p.x,this.point[t].geometry.vertices[0].y=e.p.y,this.point[t].geometry.vertices[0].z=e.p.z,this.Graph.nodes[t].isCapture?(this.point[t].material.color.r=1,this.point[t].material.color.g=1,this.point[t].material.color.b=1):(this.point[t].material.color.r=1,this.point[t].material.color.g=0,this.point[t].material.color.b=0),this.point[t].geometry.colorsNeedUpdate=!0,this.point[t].geometry.verticesNeedUpdate=!0,this.point[t].material.needsUpdate=!0}for(let t=0;t<this.Graph.edges.length;++t){const e=this.Graph.edges[t];this.Lines.geometry.vertices[2*t].x=e.n0.p.x,this.Lines.geometry.vertices[2*t].y=e.n0.p.y,this.Lines.geometry.vertices[2*t].z=e.n0.p.z,this.Lines.geometry.vertices[2*t+1].x=e.n1.p.x,this.Lines.geometry.vertices[2*t+1].y=e.n1.p.y,this.Lines.geometry.vertices[2*t+1].z=e.n1.p.z}this.Lines.geometry.verticesNeedUpdate=!0}MouseMove(t,e,s){this.capture&&console.log(this.capture)}MouseDrag(t,e){this.capture&&(console.log(t,e),console.log(this.capture),this.capture.p.x=t,this.capture.p.y=e)}MouseDown(t,e,s){let i=this.Graph.FindNode(t,e,s);this.capture=i||void 0}MouseUp(){this.capture=void 0}Dispose(){for(let t of this.point)this.scene.remove(t.pointCloud),t.Dispose();this.Lines.Dispose()}}class f{constructor(t){this.app=void 0,this.activeCommandController=void 0,this.geometryCommon=void 0,this.lightingController=void 0,this.scene=void 0,this.definition=void 0,this.app=t,this.activeCommandController=new m(this),this.scene=this.app.graphicsCoreWrapper.canvasWrapper.canvasThree.scene,this.app.graphicsCoreWrapper.canvasWrapper.canvasThree.UpdateBinding=()=>{this.Update()},this.lightingController=new v(this),this.geometryCommon=new g(this),this.Init()}Init(){this.definition=new w(this.scene)}Update(){this.definition.Update()}MouseMove(t,e){const s=this.geometryCommon.RaycastPoint(t,e,this.definition.GetPointForRaycast());s&&this.definition.MouseMove(s[0],s[1],s[2])}MouseDown(t,e){const s=this.geometryCommon.RaycastPoint(t,e,this.definition.GetPointForRaycast());s&&(this.app.graphicsCoreWrapper.canvasWrapper.canvasThree.camera.ableToMove=!1,this.definition.MouseDown(s[0],s[1],s[2]))}MouseUp(t,e){this.definition.MouseUp(),this.app.graphicsCoreWrapper.canvasWrapper.canvasThree.camera.ableToMove=!0}MouseDrag(t,e){const s=this.geometryCommon.RaycastPoint(t,e,this.definition.GetPointForRaycast());s&&this.definition.MouseDrag(s[0],s[1])}Dispose(){this.definition.Dispose()}}class L{constructor(t){this.app=void 0,this.x=-1,this.y=-1,this.z=-1,this.preX=-1,this.preY=-1,this.preZ=-1,this.yGLPicking=void 0,this.CLICK_TYPE=n.uh.MOVE,this.isDown=!1,this.isDoubleClick=!1,this.isMove=!1,this.pressedShift=!1,this.pressedAlt=!1,this.pressedCtrl=!1,this.lat=-1,this.long=-1,this.wheel=0,this.preWheel=0,this.isActive=!0,this.native=void 0,null!==t&&void 0!==t&&(this.app=t)}DeepCopy(){let t=new L(this.app);return t.x=this.x,t.y=this.y,t.z=this.z,t.preX=this.preX,t.preY=this.preY,t.preZ=this.preZ,t.pressedAlt=this.pressedAlt,t.pressedShift=this.pressedShift,t.pressedCtrl=this.pressedCtrl,t.isDoubleClick=this.isDoubleClick,t.isDown=this.isDown,t.isMove=this.isMove,t.lat=this.lat,t.long=this.long,t.wheel=this.wheel,t.preWheel=this.preWheel,t.yGLPicking=this.yGLPicking,t.CLICK_TYPE=this.CLICK_TYPE,t.native=this.native,t}}class A{constructor(t){this.mouseInteractionUI=void 0,this.mouseEventDataPre=new L,this.app=void 0,this.isEnable=!0,this.clickCount=0,this.click=!1,this.prevent=!1,this.delay=250,this.timer=void 0,this.down=!1,this.e=void 0,this._stopPropagation=!1,this.app=t}InitNativeMouseEvent(t){t.onclick=t=>{this.prevent=!1,this.timer=setTimeout((()=>{this.prevent||(this.MouseClick(t),t.stopPropagation()),this.prevent=!1}),this.delay)},t.ondblclick=t=>{clearTimeout(this.timer),this.prevent=!0,this.MouseDoubleClick(t)},t.onmousedown=t=>{this.MouseDown(t),t.stopPropagation()},t.onmouseup=t=>{this.MouseUp(t),t.stopPropagation()},t.onmousemove=t=>{this.MouseMove(t),t.stopPropagation()},t.addEventListener("wheel",(t=>{this.MouseWheel(t,t.deltaY),t.stopPropagation()}))}MouseDown(t){this.click=!0,this.down=!0;let e=this.CommonEventBuilder(t);e.CLICK_TYPE=n.uh.DOWN,e.isDown=!0,this.MouseEvenEmitting(e)}MouseClick(t){if(!this.click)return;let e=this.CommonEventBuilder(t);0===t.button?e.CLICK_TYPE=n.uh.LEFT:1===t.button?e.CLICK_TYPE=n.uh.MIDDLE:2===t.button&&(e.CLICK_TYPE=n.uh.RIGHT),this.MouseEvenEmitting(e)}MouseDoubleClick(t){let e=this.CommonEventBuilder(t);e.CLICK_TYPE=n.uh.DOUBLE,this.MouseEvenEmitting(e)}MouseDrag(t){this.click=!1,this.prevent=!0;let e=this.CommonEventBuilder(t);e.CLICK_TYPE=n.uh.DRAG,e.isDown=!0,1===t.buttons?e.CLICK_TYPE=n.uh.DRAG:4===t.buttons?e.CLICK_TYPE=n.uh.DRAG_MIDDLE:2===t.buttons&&(e.CLICK_TYPE=n.uh.DRAG_RIGHT),this.MouseEvenEmitting(e)}MouseMove(t){if(this.down)return void this.MouseDrag(t);let e=this.CommonEventBuilder(t);e.CLICK_TYPE=n.uh.MOVE,e.isDown=!0,this.prevent=!0,this.MouseEvenEmitting(e)}MouseUp(t){this.down=!1,this.click=!0;let e=this.CommonEventBuilder(t);e.CLICK_TYPE=n.uh.UP,e.isDown=!1,this.MouseEvenEmitting(e)}MouseWheel(t,e){let s=this.CommonEventBuilder(t);s.wheel=e,s.CLICK_TYPE=n.uh.WHEEL,this.MouseEvenEmitting(s)}CommonEventBuilder(t){let e=new L(this.app);return e.preX=this.mouseEventDataPre.x,e.preY=this.mouseEventDataPre.y,e.pressedShift=t.shiftKey,e.pressedAlt=t.altKey,e.pressedCtrl=t.ctrlKey,e.x=t.offsetX,e.y=t.offsetY,e.preWheel=this.mouseEventDataPre.wheel,e.wheel=0,e.native=t,this.mouseEventDataPre=e,this.e=e,e}get stopPropagation(){return this._stopPropagation}set stopPropagation(t){t?this._stopPropagation=t:setTimeout((()=>{this._stopPropagation=t}),500)}MouseEvenEmitting(t){this.app.MouseEventController(t)}}class D{constructor(t){this.app=void 0,this.mouseInteraction=void 0,this.app=t,this.mouseInteraction=new A(this.app),this.mouseInteraction.InitNativeMouseEvent(this.app.divHost)}}class R{static Init(t){new R(t)}constructor(t){this.divHost=void 0,this.asset=void 0,this.viewWrapper=void 0,this.graphicsCoreWrapper=void 0,this.sceneWrapper=void 0,this.io=void 0;const e=document.getElementById(t);e&&(this.divHost=e),this.asset=new i,this.viewWrapper=new h(this),this.graphicsCoreWrapper=new u(this),this.sceneWrapper=new f(this),this.io=new D(this)}MouseEventController(t){this.sceneWrapper.activeCommandController.MouseEventController(t)}Resize(t,e){this.graphicsCoreWrapper.Resize(t,e)}Dispose(){this.graphicsCoreWrapper.Dispose(),this.sceneWrapper.Dispose()}Dummy(){}}}}]);
//# sourceMappingURL=7832.18b3712f.chunk.js.map