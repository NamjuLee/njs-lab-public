{"version":3,"file":"static/js/7105.f0fda088.chunk.js","mappings":"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","sources":["njslab/Tools/WaterQualityInspector/WaterQualityInspector.ts","njslab/Tools/WaterQualityInspector/index.ts"],"sourcesContent":["import { getCSVFromURL } from 'njscore';\r\n\r\nexport class WaterQualityInspector {\r\n    data = {};\r\n\r\n    day = 24;\r\n    scale = 1.0\r\n    offsetData = 1;\r\n    constructor() {\r\n\r\n        document.onkeydown = (k) => {\r\n            this.offsetData++;\r\n            console.log(this.offsetData)\r\n        }\r\n\r\n        getCSVFromURL(process.env.PUBLIC_URL + '/static/data/Watabot/obs_104_1928_d047_15c7.csv').then((d) => {\r\n            const lines = d.split(/\\r\\n|\\r|\\n/g);\r\n            const index = lines[0].split(',');\r\n\r\n            const dataDic = {}\r\n            let needComputeData = true;\r\n            for (let i = 0; i < index.length; ++i) {\r\n                console.log(index[i])\r\n                if (needComputeData && index[i] === 'time (UTC)') {\r\n                    dataDic[index[i]] = [];\r\n                    needComputeData = false;\r\n                } else {\r\n                    dataDic[index[i]] = new Float32Array(lines.length - 1)\r\n                }\r\n            }\r\n\r\n            for (let i = 1; i < lines.length; ++i) {\r\n                const row = lines[i].split(',');\r\n                for (let j = 0; j < index.length; ++j) {\r\n                    const theIndex = index.indexOf(index[j]);\r\n                    if (theIndex !== -1) {\r\n                        dataDic[index[j]][i - 1] = row[theIndex]\r\n                    }\r\n                }\r\n\r\n            }\r\n            this.data = dataDic;\r\n            console.log(dataDic)\r\n        });\r\n    }\r\n    public Offset(v) {\r\n        if (v < 0) {\r\n            // this.offsetData -= this.offsetData * 0.5;\r\n        } else {\r\n            // this.offsetData += this.offsetData * 0.5;\r\n        }\r\n    }\r\n    public wheel(e: WheelEvent) {\r\n        if (e.deltaY < 0) {\r\n            this.scale += this.scale * .25;\r\n        } else {\r\n            this.scale -= this.scale * .25;\r\n        }\r\n        this.scale = this.scale < 0.012 ? 0.012 : this.scale;\r\n        console.log(this.scale)\r\n    }\r\n\r\n    public render(ctx: CanvasRenderingContext2D) {\r\n        let d = this.data['mass_concentration_of_blue_green_algae_in_sea_water (ug L-1)']; // sea_water_temperature (K) sea_water_turbidity (1)\r\n\r\n        dd(ctx, d, this.scale, this.day);\r\n\r\n        vizData(ctx, d, '#f00', this.scale, this.day, this.offsetData);\r\n\r\n        // d = this.data['sea_water_turbidity (1)'];\r\n        // vizData(ctx, d, '#0f0', this.scale, this.day, this.offsetData)\r\n\r\n        // d = this.data['chlorophyll_fluorescence (RFU)'];\r\n        // vizData(ctx, d, '#00f', this.scale, this.day, this.offsetData)\r\n\r\n        // d = this.data['oxidation_reduction_potential (mV)'];\r\n        // vizData(ctx, d, '#0ff', this.scale, this.day, this.offsetData)\r\n\r\n    }\r\n}\r\n\r\nconst dd = (ctx: CanvasRenderingContext2D, d, scale, day) => {\r\n    const hourRes = 12\r\n\r\n    for (let i = 0; i < d.length; i++) {\r\n\r\n        ctx.lineWidth = 0.5;\r\n        ctx.strokeStyle = `rgba(200, 200, 200, 1)`;\r\n        if (scale > 0.1) {\r\n            if (i % (hourRes * day) === 0) {\r\n                const x = i * scale;\r\n                ctx.beginPath();\r\n                ctx.moveTo(x, 0);\r\n                ctx.lineTo(x, ctx.canvas.height);\r\n                ctx.stroke();\r\n            }\r\n        }\r\n\r\n        ctx.lineWidth = 1;\r\n        ctx.strokeStyle = `rgba(0, 0, 255, 1)`;\r\n        if (scale > 0.02) {\r\n            if (i % (hourRes * day * 7) === 0) {\r\n                const x = i * scale;\r\n                ctx.beginPath();\r\n                ctx.moveTo(x, 0);\r\n                ctx.lineTo(x, ctx.canvas.height);\r\n                ctx.stroke();\r\n                // console.log(i)\r\n            }\r\n        }\r\n        ctx.lineWidth = 1;\r\n        ctx.strokeStyle = `rgba(0, 255, 0, 1)`;\r\n        if (i % (hourRes * day * 30) === 0) {\r\n            const x = i * scale;\r\n            ctx.beginPath();\r\n            ctx.moveTo(x, 0);\r\n            ctx.lineTo(x, ctx.canvas.height);\r\n            ctx.stroke();\r\n            // console.log(i)\r\n        }\r\n    }\r\n};\r\n\r\nconst vizData = (ctx: CanvasRenderingContext2D, d, color, scale, day, offsetData) => {\r\n\r\n    ctx.lineWidth = 3;\r\n    ctx.strokeStyle = color;\r\n\r\n    ctx.beginPath();\r\n    let x = 0\r\n    ctx.moveTo(x, d[0])\r\n    for (let i = 1; i < d.length; i += offsetData) {\r\n        x += 1\r\n\r\n        const xP = x * scale * offsetData\r\n        let yP = 0;\r\n        let val = 0\r\n        let key = 'max' // max mean\r\n        switch (key) {\r\n            case 'mean':\r\n                for (let j = 0; j < offsetData; ++j) {\r\n                    val += d[i + j]\r\n                }\r\n\r\n                yP = val / offsetData;\r\n                ctx.lineTo(xP, yP)\r\n                break;\r\n            default:\r\n                for (let j = 0; j < offsetData; ++j) {\r\n                    if (val < d[i + j]) {\r\n                        val = d[i + j]\r\n                    }\r\n                }\r\n                yP = val // / offsetData;\r\n                ctx.lineTo(xP, yP)\r\n                break;\r\n        }\r\n\r\n        // console.log(i)\r\n    }\r\n    // console.log(x)\r\n    ctx.stroke();\r\n};","import { RendererCanvas, remap } from '../../../lib'\r\n\r\nimport { WaterQualityInspector } from './WaterQualityInspector';\r\n\r\nexport class Solution {\r\n    public divHost: HTMLElement;\r\n    public renderer: Renderer;\r\n    constructor(divHost: any) {\r\n        this.divHost = divHost;\r\n\r\n        // Center align\r\n        this.divHost.style.display = 'flex';\r\n        this.divHost.style.alignItems = 'center';\r\n\r\n        const div = document.createElement('div');\r\n        div.style.marginLeft = 'auto';\r\n        div.style.marginRight = 'auto';\r\n        div.style.backgroundColor = '#555';\r\n        div.style.width = '900px';\r\n        div.style.height = '500px';\r\n        this.divHost.appendChild(div);\r\n\r\n        this.renderer = new Renderer(div);\r\n\r\n    }\r\n    public destroy() {\r\n        this.renderer.destroy();\r\n        while (this.divHost.lastElementChild) {\r\n            this.divHost.removeChild(this.divHost.lastElementChild);\r\n        }\r\n    }\r\n}\r\n\r\nexport class Renderer extends RendererCanvas {\r\n    waterQualityInspector: WaterQualityInspector;\r\n    constructor(div: any) {\r\n        super(div);\r\n        this.canvas.style.position = 'relative';\r\n        this.canvas.style.width = '100%';\r\n        this.canvas.style.height = '100%';\r\n        this.canvas.style.background = '#fff';\r\n\r\n        // TODO\r\n        // You code goes here for one time operation\r\n        // \r\n\r\n        this.canvas.onwheel = (e) => {\r\n            // console.log(e.deltaY);\r\n            this.waterQualityInspector.wheel(e);\r\n        }\r\n\r\n\r\n        this.waterQualityInspector = new WaterQualityInspector();\r\n\r\n        this.start();\r\n    }\r\n    public mouseDown(x: number, y: number): void {\r\n\r\n    }\r\n    public mouseUp(x: number, y: number): void {\r\n\r\n    }\r\n    public mouseDrag(x: number, y: number): void {\r\n\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D): void {\r\n        // ctx.beginPath();\r\n        // ctx.arc(0, 0, 10, 0, Math.PI * 2);\r\n        // ctx.closePath();\r\n        // ctx.fill();\r\n\r\n        this.waterQualityInspector.render(this.ctx);\r\n    }\r\n}"],"names":["WaterQualityInspector","data","day","scale","offsetData","document","onkeydown","k","console","log","getCSVFromURL","process","then","d","lines","split","index","dataDic","needComputeData","i","length","Float32Array","row","j","theIndex","indexOf","v","e","deltaY","this","ctx","dd","vizData","lineWidth","strokeStyle","x","beginPath","moveTo","lineTo","canvas","height","stroke","color","xP","yP","val","Solution","divHost","renderer","style","display","alignItems","div","createElement","marginLeft","marginRight","backgroundColor","width","appendChild","Renderer","destroy","lastElementChild","removeChild","waterQualityInspector","position","background","onwheel","wheel","start","y","render","RendererCanvas"],"sourceRoot":""}