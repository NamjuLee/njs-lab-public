"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[2971],{62971:function(e,t,i){i.r(t),i.d(t,{Renderer:function(){return c},Solution:function(){return l},checkIntersection:function(){return f},pointOnSegment2D:function(){return y}});var n=i(93433),r=i(60136),s=i(29388),a=i(15671),h=i(43144),o=i(26943),l=function(){function e(t){var i=this;(0,a.Z)(this,e),this.divHost=void 0,this.renderer=void 0,this.divHost=t,this.divHost.style.display="flex",this.divHost.style.alignItems="center";var n=document.createElement("div");n.style.marginLeft="auto",n.style.marginRight="auto",n.style.backgroundColor="#000",n.style.width="1000px",n.style.height="600px",this.divHost.appendChild(n),this.renderer=new c(n);var r=document.createElement("div");r.style.paddingTop="5px",r.style.paddingBottom="5px",n.appendChild(r),r.textContent="Click twice in different locations to build a wall";var s=x("bounces",2,200);n.appendChild(s.div),s.slider.oninput=function(){i.renderer.updateIter(+s.slider.value)};var h=g("Ray Direction");n.appendChild(h.div),h.checkBox.checked=!1,h.checkBox.onchange=function(){!0===h.checkBox.checked?i.renderer.isRayDirection=!0:i.renderer.isRayDirection=!1};var o=g("Line");n.appendChild(o.div),o.checkBox.checked=!0,o.checkBox.onchange=function(){!0===o.checkBox.checked?i.renderer.isLineRenderer=!0:i.renderer.isLineRenderer=!1,i.renderer.updateIter(i.renderer.iter)}}return(0,h.Z)(e,[{key:"destroy",value:function(){for(this.renderer.destroy();this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}}]),e}(),c=function(e){(0,r.Z)(i,e);var t=(0,s.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).walls=[],n.sun=void 0,n.t=0,n.iter=10,n.isRayDirection=!1,n.isLineRenderer=!0,n.p0=void 0,n.canvas.style.position="relative",n.canvas.style.width="100%",n.canvas.style.height="100%",n.sun=new v(new o.P(300,100,0)),n.walls.push(new p(50,200,400,500)),n.walls.push(new p(100,500,500,600)),n.walls.push(new p(500,100,400,400)),n.walls.push(new p(50,100,600,50)),n.walls.push(new p(500,600,600,50)),n.walls.push(new p(50,100,50,300)),n.walls.push(new p(50,300,100,500)),n.start(),n}return(0,h.Z)(i,[{key:"mouseClick",value:function(e,t){if(this.p0)return this.walls.push(new p(this.p0.x,this.p0.y,e,t)),this.p0=void 0,void this.updateIter(this.iter);void 0!==this.p0||(this.p0=new o.P(e,t))}},{key:"mouseMove",value:function(e,t){this.isRayDirection&&(this.sun.updateDirection(e,t),this.isStatic=!1,this.loop(this.ctx))}},{key:"updateIter",value:function(e){this.iter=e,this.isStatic=!1,this.loop(this.ctx)}},{key:"render",value:function(e){this.t+=.01,this.update(e),e.globalCompositeOperation="source-over",e.strokeStyle="#ffffff",this.walls.forEach((function(t){t.draw(e)})),this.sun.draw(e,this.t),this.isStatic=!0}},{key:"update",value:function(e){var t=this.sun.getSunLine(),i=u(t,this.walls,this.iter);e.lineWidth=.5;for(var r=0;r<i.length;++r){var s=i[r];e.beginPath(),e.arc(s.x,s.y,5,0,2*Math.PI),e.closePath(),e.stroke()}if(e.globalCompositeOperation="multiply",this.isLineRenderer){if(e.lineWidth=10,i.length>0){e.strokeStyle="rgba(255, 0, 0, ".concat(1,")"),e.beginPath(),e.moveTo(this.sun.v.x,this.sun.v.y),e.lineTo(i[0].x,i[0].y),e.stroke();for(var a=0;a<i.length-1;a++){var h=1-a/i.length;e.strokeStyle="rgba(255, 0, 0, ".concat(h,")"),e.beginPath(),e.moveTo(i[a].x,i[a].y),e.lineTo(i[a+1].x,i[a+1].y),e.stroke()}}}else if(i.length>0){var o=[];o.push.apply(o,(0,n.Z)(d(this.sun.v,i[0],20)));for(var l=0;l<i.length-1;l++)o.push.apply(o,(0,n.Z)(d(i[l],i[1+l],20)));for(var c=0;c<o.length;++c){var v=o[c],p=1-c/o.length;e.fillStyle="rgba(255, 0, 0, ".concat(p,")"),e.beginPath(),e.arc(v.x,v.y,5,0,2*Math.PI),e.closePath(),e.fill()}}}}]),i}(o.bb),u=function(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,n=[],r=0;r<i;++r){for(var s=1e4,a=void 0,h=void 0,l=0;l<t.length;++l){var c=t[l],u=f(e.p0.x,e.p0.y,e.p1.x,e.p1.y,c.p0.x,c.p0.y,c.p1.x,c.p1.y);if(void 0!==u){var d=(0,o.zp)(e.p0.x,e.p0.y,0,u.x,u.y,0);d>10&&d<s&&(a=u,h=c,s=d)}}if(void 0!==a){var v=new o.P(e.p1.x-e.p0.x,e.p1.y-e.p0.y,0),p=(0,o.SC)(v,h.nVec);e={p0:a,p1:{x:a.x+p.x,y:a.y+p.y}},n.push(a)}}return n},d=function(e,t,i){var n=t.x-e.x,r=t.y-e.y,s=t.z-e.z,a=new o.P(n,r,s),h=a.length()/i;a.normalize();for(var l=[],c=0;c<h;++c){var u=new o.P(e.x+a.x*i*c,e.y+a.y*i*c,e.z+a.z*i*c);l.push(u)}return l},v=function(){function e(t){(0,a.Z)(this,e),this.v=void 0,this.target=new o.P(0,0,0),this.rayVec=new o.P(0,0,0),this.v=t,this.updateDirection(300,300)}return(0,h.Z)(e,[{key:"draw",value:function(e,t){e.lineWidth=.1,e.beginPath(),e.moveTo(this.v.x,this.v.y),e.lineTo(this.target.x,this.target.y),e.stroke(),e.lineWidth=.5,e.beginPath(),e.moveTo(this.v.x,this.v.y),e.lineTo(this.v.x+50*this.rayVec.x,this.v.y+50*this.rayVec.y),e.stroke(),e.fillStyle="#FDB813",e.beginPath(),e.arc(this.v.x,this.v.y,Math.sin(20*t)+12,0,2*Math.PI),e.fill()}},{key:"updateDirection",value:function(e,t){this.target.x=e,this.target.y=t,this.rayVec.x=this.v.x+this.target.x,this.rayVec.y=this.v.y+this.target.y,this.rayVec.x=this.target.x-this.v.x,this.rayVec.y=this.target.y-this.v.y}},{key:"getSunLine",value:function(){return{p0:this.v,p1:new o.P(this.v.x+1e3*this.rayVec.x,this.v.y+1e3*this.rayVec.y)}}}]),e}(),p=function(){function e(t,i,n,r){(0,a.Z)(this,e),this.p0=void 0,this.p1=void 0,this.nVec=void 0,this.p0=new o.P(t,i),this.p1=new o.P(n,r),this.computeNormal()}return(0,h.Z)(e,[{key:"draw",value:function(e){e.lineWidth=5,e.strokeStyle="#ffffff",e.beginPath(),e.moveTo(this.p0.x,this.p0.y),e.lineTo(this.p1.x,this.p1.y),e.stroke()}},{key:"computeNormal",value:function(){var e=new o.P(this.p1.x-this.p0.x,this.p1.y-this.p0.y,0);this.nVec=(0,o.ir)(e,new o.P(0,0,1)),this.nVec=(0,o.Fv)(this.nVec)}}]),e}(),y=function(e,t,i,n,r,s){if(i!==r){if(i<=e&&e<=r)return!0;if(i>=e&&e>=r)return!0}else{if(n<=t&&t<=s)return!0;if(n>=t&&t>=s)return!0}return!1},f=function(e,t,i,n,r,s,a,h){var o=(h-s)*(i-e)-(a-r)*(n-t),l=(a-r)*(t-s)-(h-s)*(e-r),c=(i-e)*(t-s)-(n-t)*(e-r);if(0!==o){var u=l/o,d=c/o;return u>=0&&u<=1&&d>=0&&d<=1?{x:e+u*(i-e),y:t+u*(n-t),z:0}:void 0}},x=function(e,t,i){var n=document.createElement("div");n.style.display="flex";var r=document.createElement("input");r.type="range",r.min="".concat(t),r.max="".concat(i);var s=document.createElement("div");return s.textContent=e,s.style.color="#aaa",n.appendChild(r),n.appendChild(s),{div:n,slider:r}},g=function(e){var t=document.createElement("div");t.style.display="flex";var i=document.createElement("input");i.type="checkbox",i.defaultChecked=!1;var n=document.createElement("div");return n.textContent=e,n.style.color="#aaa",t.appendChild(i),t.appendChild(n),{div:t,checkBox:i}}}}]);
//# sourceMappingURL=2971.e666aeb0.chunk.js.map