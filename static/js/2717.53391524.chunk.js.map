{"version":3,"file":"static/js/2717.53391524.chunk.js","mappings":"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","sources":["njslab/Project/Project_04_Water/P-2-water/lib/MapboxGLWrapper.ts","njslab/Project/Project_04_Water/P-2-water/Renderer/Canvas.ts","njslab/Project/Project_04_Water/P-2-water/Renderer/index.ts","njslab/Project/Project_04_Water/P-2-water/UI/index.ts","njslab/Project/Project_04_Water/P-2-water/Core/ActiveCommand.ts","njslab/Project/Project_04_Water/P-2-water/Core/Common.ts","njslab/Project/Project_04_Water/P-2-water/Core/Scene.ts","njslab/Project/Project_04_Water/P-2-water/Core/index.ts","njslab/Project/Project_04_Water/P-2-water/Project/Site/Agent/Agent.ts","njslab/Project/Project_04_Water/P-2-water/Project/Site/Agent/BoidContollerWander0.ts","njslab/Project/Project_04_Water/P-2-water/Project/Site/Boundary/index.ts","njslab/Project/Project_04_Water/P-2-water/Project/Site/index.ts","njslab/Project/Project_04_Water/P-2-water/Project/index.ts","njslab/Project/Project_04_Water/P-2-water/Addon/Tracer.ts","njslab/Project/Project_04_Water/P-2-water/Addon/index.ts","njslab/Project/Project_04_Water/P-2-water/index.ts"],"sourcesContent":["import mapboxgl from \"mapbox-gl\";\r\n\r\nexport class MapboxGLWrapper {\r\n    public map: mapboxgl.Map\r\n    constructor(id: string) {\r\n\r\n        this.initMap(id);\r\n    }\r\n    private initMap(id: string) {\r\n        // https://account.mapbox.com\r\n        mapboxgl.accessToken = 'pk.eyJ1IjoiZGVzaWduanUiLCJhIjoiY2xhNGU0YWo4MDlhYzNwdHBwenVvang4eiJ9.P3sX4l_3KjdPeRRbVS1VVg';\r\n        this.map = new mapboxgl.Map({\r\n            container: id,\r\n            zoom: 15,\r\n            // minZoom: 10,\r\n            center: [-71.093161, 42.358871],\r\n            style: 'mapbox://styles/mapbox/dark-v10' // 'mapbox://styles/mapbox/streets-v11' mapbox://styles/mapbox/dark-v10\r\n        });\r\n        this.map.dragRotate.disable();\r\n\r\n        // https://docs.mapbox.com/mapbox-gl-js/api/events/#mapmouseevent#type\r\n        this.map.on('mousemove', (e) => { this.mouseMove(e); });\r\n        this.map.on('click', (e) => { this.mouseClick(e); });\r\n        this.map.on('mousedown', (e) => { this.mouseDown(e); });\r\n        this.map.on('dblclick', (e) => { this.mouseDClick(e); });\r\n        this.map.on('mouseup', (e) => { this.mouseUp(e); });\r\n\r\n        let div = document.getElementsByClassName('mapboxgl-canvas')[0] as HTMLDivElement;\r\n        div.style.position = 'absolute';\r\n        \r\n        div = document.getElementsByClassName('mapboxgl-control-container')[0] as HTMLDivElement;\r\n        div.style.display = 'none';\r\n    }\r\n    get zoom() {\r\n        return this.map.getZoom();\r\n    }\r\n    set zoom(v : number) {\r\n        this.map.setZoom(v);\r\n    }\r\n    public center = (lng: number = -99.292649, lat: number = 39.043903) => {\r\n        // const v = new mapboxgl.LngLat(lon, lat);\r\n        // console.log(v);\r\n        this.map.setCenter({ lat, lng })\r\n    }\r\n    public toMap = (x: number, y: number) => {\r\n        const p = this.map.unproject({x, y} as any)\r\n        return [p.lng, p.lat];\r\n    }\r\n    public toScreen = (lon: number, lat: number) => {\r\n        const p = this.map.project([lon, lat])\r\n        return [p.x, p.y];\r\n    }\r\n    public mouseDown = (e) => {\r\n        // console.log(this.toScreen(-71.093161, 42.358871))\r\n        // console.log(JSON.stringify(e.point), e.lngLat.wrap())\r\n    }\r\n    public mouseUp = (e) => {\r\n        // console.log(JSON.stringify(e.point), e.lngLat.wrap())\r\n    }\r\n    public mouseMove = (e) => {\r\n        // console.log(JSON.stringify(e.point), e.lngLat.wrap())\r\n    }\r\n    public mouseClick = (e) => {\r\n        // console.log(e)\r\n        \r\n        // console.log(this.toMap(100, 100));\r\n        // console.log(e.point)\r\n        // this.center()\r\n        // this.map.zoomTo(0)\r\n        // console.log(JSON.stringify(e.point), e.lngLat.wrap())\r\n    }\r\n    public mouseDClick = (e) => {\r\n        // console.log(JSON.stringify(e.point), e.lngLat.wrap())\r\n    }\r\n}\r\n\r\n\r\n","import { RendererCanvasDynamicLight } from '../lib'\r\n\r\nexport class RendererCanvasDynamic extends RendererCanvasDynamicLight {\r\n    public time: number = 0.0;\r\n    public pts: number[][] = [];\r\n    constructor(div: any) {\r\n        super(div);\r\n        this.canvas.id = 'mapboxCustom'\r\n        this.canvas.style.position = 'absolute';\r\n        this.canvas.style.width = '100%';\r\n        this.canvas.style.height = '100%';\r\n        this.canvas.style.pointerEvents = 'none';\r\n\r\n        this.start();\r\n    }\r\n    public mouseDown = (x: number, y: number): void => {\r\n\r\n    }\r\n    public mouseUp = (x: number, y: number): void => {\r\n\r\n    }\r\n    public mouseDrag = (x: number, y: number): void => {\r\n\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D): void {\r\n        \r\n    }\r\n}\r\n","import { WaterHyacinth } from '..';\r\nimport { MapboxGLWrapper } from '../lib/MapboxGLWrapper';\r\nimport { getFalseColor } from 'njscore';\r\nimport { RendererCanvasDynamic } from './Canvas';\r\n\r\nexport class Renderer {\r\n    public app: WaterHyacinth;\r\n    public map: MapboxGLWrapper;\r\n    public canvasCustom: RendererCanvasDynamic;\r\n\r\n    public colorArray1: number[][] = [];\r\n    public colorArray2: number[][] = [];\r\n\r\n    private originalZoom = 3;\r\n    private originalCenter = [-98.292649, 39.043903];\r\n\r\n    constructor(app: WaterHyacinth) {\r\n        this.app = app;\r\n        app.divHost.style.position = 'relative';\r\n        this.map = new MapboxGLWrapper(app.divHost.id);\r\n        this.map.mouseClick = (e) => this.mouseClick(e);\r\n        // this.map.mouseDClick = this.mouseDClick;\r\n        this.map.mouseDown = (e) => this.mouseDown(e);\r\n        this.map.mouseUp = (e) => this.mouseUp(e);\r\n        this.map.mouseMove = (e) => this.mouseMove(e);\r\n\r\n        this.canvasCustom = new RendererCanvasDynamic(app.divHost)\r\n        this.canvasCustom.render = this.render;\r\n\r\n        this.colorArray1 = [];\r\n        for (let i = 0; i < 255; ++i) {\r\n            const result = getFalseColor(i / 255);\r\n            this.colorArray1.push(result);\r\n        }\r\n\r\n        this.colorArray2 = [];\r\n    }\r\n    public init() {\r\n        this.zoomOut();\r\n    }\r\n    public render = (ctx: CanvasRenderingContext2D) => {\r\n        ctx.globalCompositeOperation = 'screen'; //'lighten';\r\n\r\n        const xOff = ctx.canvas.width - 300;\r\n        const yOff = ctx.canvas.height - 50;\r\n\r\n        const w = 1;\r\n        const h = 10;\r\n        for (let i = 0; i < this.colorArray1.length; ++i) {\r\n            ctx.beginPath();\r\n            ctx.rect(i * w + xOff, yOff, w, h)\r\n            ctx.closePath();\r\n            ctx.fillStyle = `rgba(${this.colorArray1[i][0]}, ${this.colorArray1[i][1]}, ${this.colorArray1[i][2]}, 1)`;\r\n            ctx.fill();\r\n        }\r\n\r\n        this.app.core.scene.render(ctx);\r\n    }\r\n    public zoomOut() {\r\n        this.map.zoom = this.originalZoom;\r\n        this.map.center(this.originalCenter[0], this.originalCenter[1])\r\n    }\r\n    private processEventData = (e: any): number[] => {\r\n        const lon = e['lngLat']['lng'];\r\n        const lat = e['lngLat']['lat'];\r\n        const x = e['point']['x'];\r\n        const y = e['point']['y'];\r\n        return [x, y , lon, lat];\r\n    }\r\n    public keyDown(k: KeyboardEvent): void {\r\n        // console.log('key pressed', k);\r\n    }\r\n    public mouseDown(e): void {\r\n        const m = this.processEventData(e)\r\n        this.app.core.activeCommand.mouseDown(m[0], m[1]);\r\n\r\n        this.canvasCustom.forceRender();\r\n    }\r\n    public mouseUp(e): void {\r\n        const m = this.processEventData(e)\r\n        this.app.core.activeCommand.mouseUp(m[0], m[1]);\r\n        // this.app.core.activeCommand.mouseUp(x, y);\r\n    }\r\n    public mouseClick(e): void {\r\n        const m = this.processEventData(e)\r\n        this.app.core.activeCommand.mouseClick(m[0], m[1]);\r\n        // this.app.core.activeCommand.mouseClick(x, y);\r\n    }\r\n    public mouseMove(e) {\r\n        const m = this.processEventData(e)\r\n        this.app.core.activeCommand.mouseMove(m[0], m[1], m[2], m[3]);\r\n        // this.app.core.activeCommand.mouseMove(x, y);\r\n    }\r\n}\r\n","import { WaterHyacinth } from '..';\r\nexport class UI {\r\n    solution: WaterHyacinth;\r\n\r\n    constructor(solution: WaterHyacinth) {\r\n        this.solution = solution;\r\n\r\n        const style = {\r\n            menuMain: {\r\n                color: '#fff',\r\n                background: 'rgba(173, 216, 230, 0.2)',\r\n                backdropFilter: 'blur(10px)',\r\n            }\r\n        }\r\n\r\n        let container = document.createElement('div');\r\n        container.style.position = 'absolute';\r\n        container.style.width = '200px';\r\n        container.style.height = '100%';\r\n        container.style.padding = '10px';\r\n\r\n        container.style.color = style.menuMain.color;\r\n        container.style.background = style.menuMain.background;\r\n        container.style.backdropFilter = style.menuMain.backdropFilter\r\n\r\n        this.solution.divHost.append(container);\r\n\r\n\r\n        const divTitle = getDivBtn(container, 'Map');\r\n        const zoomTo = getDivBtn(container, 'Zoom out');\r\n        zoomTo.onclick = () => {\r\n            this.solution.core.activeCommand.zoomOut()\r\n        }\r\n\r\n        const separate = getDivBtn(container, '----------');\r\n        const Addon = getDivBtn(container, 'Addon');\r\n        const Tracer = getDivBtn(container, 'BoundaryTracer');\r\n        Tracer.onclick = () => {\r\n            this.solution.addon.appendTracer();\r\n        };\r\n        \r\n    }\r\n}\r\n\r\n\r\nconst getDivBtn = (host: HTMLDivElement, title: string) => {\r\n    const div = document.createElement('div')\r\n    host.appendChild(div);\r\n    div.style.marginTop = '5px';\r\n    div.textContent = title;\r\n    return div;\r\n}","import { Core } from '.';\r\nimport { Site } from '../Project/Site';\r\n\r\nexport class ActiveCommand {\r\n    core: Core;\r\n    m = [0, 0, 0, 0];\r\n    constructor(core: Core) {\r\n        this.core = core;\r\n    }\r\n    mouseDown(x: number, y: number) {\r\n\r\n    }\r\n    mouseUp(x: number, y: number) {\r\n        \r\n    }\r\n    mouseDrag(x: number, y: number) {\r\n        \r\n    }\r\n    mouseMove(x: number, y: number, lon: number, lat: number) {\r\n        this.m[0] = x;\r\n        this.m[1] = y;\r\n        this.m[2] = lon;\r\n        this.m[3] = lat;\r\n        this.core.common.checkHover(x, y);\r\n    }\r\n    mouseClick(x: number, y: number) {\r\n        if (this.core.app.addon.click(x, y)) {\r\n            return;\r\n        }\r\n\r\n        if(this.core.scene.capture) {\r\n            this.core.scene.capture.click(x,y);\r\n            return;\r\n        }\r\n\r\n   \r\n        const sites: Site[] = this.core.common.getCloseSite(x, y);\r\n        if (sites.length === 1) {\r\n            this.core.scene.capture = sites[0];\r\n        } else if (sites.length >1) {\r\n            // when you click overlapping points we want to zoom in \r\n            this.core.common.zoom += this.core.common.zoom;\r\n            this.core.common.center(sites[0].properties.lon, sites[0].properties.lat);\r\n        }\r\n        // const mapProjected = this.toMap(x, y);\r\n        // // this.pts.push(mapProjected);\r\n        // if (this.ptsGeoTracing !== undefined) {\r\n        //     this.ptsGeoTracing.push(mapProjected[0], mapProjected[1])\r\n        // }\r\n\r\n        // if (this.app.siteFocused === undefined) {\r\n        //     const selSite = this.app.core.getCloseSite(x, y);\r\n\r\n        //     if (selSite) {\r\n        //         selSite.focus();\r\n        //         this.app.siteFocused = selSite;\r\n        //     }\r\n\r\n        // } else {\r\n        //     this.app.siteFocused.click(x, y);\r\n        // }\r\n\r\n        \r\n    }\r\n    public zoomOut(){\r\n        this.core.app.renderer.zoomOut();\r\n    }\r\n}","import { distanceTo } from '../lib';\r\nimport { Core } from '.';\r\nexport class Common {\r\n    core: Core;\r\n    constructor(core: Core) {\r\n        this.core = core;\r\n    }\r\n    public getCloseSite(x: number, y: number) {\r\n        const sites = [];\r\n        for (let i = 0; i < this.core.app.project.sites.length; ++i) {\r\n            const site = this.core.app.project.sites[i];\r\n            const dis = distanceTo(site.vec.x, site.vec.y, 0, x, y, 0);\r\n            if (dis < site.r) {\r\n                // console.log(dis, site.r);\r\n                sites.push(site);\r\n            }\r\n        }\r\n        return sites;\r\n    }\r\n    public toScreen = (lon: number, lat: number) => {\r\n        return this.core.app.renderer.map.toScreen(lon, lat);\r\n    }\r\n    public toMap = (x: number, y: number) => {\r\n        return this.core.app.renderer.map.toMap(x, y);\r\n    }\r\n    get zoom() {\r\n        return this.core.app.renderer.map.zoom\r\n    }\r\n    set zoom(v) {\r\n        this.core.app.renderer.map.zoom = v;\r\n    }\r\n    public center(lon: number, lat: number) {\r\n        return this.core.app.renderer.map.center(lon, lat);\r\n    }\r\n\r\n    public checkHover(x: number, y: number) {\r\n        this.core.app.project.sites.forEach((site) => {\r\n            site.isHover(x, y)\r\n        });\r\n    }\r\n}","\r\nimport { Core } from '.';\r\nimport { Site } from '../Project/Site';\r\n\r\nexport class Scene {\r\n    public core: Core;\r\n    public scene: Scene;\r\n    private _capture: Site | undefined;\r\n    constructor(core: Core) {\r\n        this.core = core;\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D) {\r\n        // if (this._capture !== undefined) {\r\n        //     this._capture.render(ctx);\r\n        // } else {\r\n        this.core.app.project.sites.forEach((site) => {\r\n            site.renderDot(ctx);\r\n        });\r\n        // }\r\n\r\n        if (this._capture !== undefined) {\r\n            this._capture.render(ctx);\r\n        }\r\n\r\n        this.core.app.addon.render(ctx);\r\n\r\n        ctx.beginPath();\r\n        ctx.font = \"14px Arial\";\r\n        ctx.fillStyle = '#fff';\r\n        const log = `latitude: ${this.core.activeCommand.m[3].toFixed(4)}, longitude: ${this.core.activeCommand.m[2].toFixed(4)}`;\r\n        ctx.fillText(log, ctx.canvas.width * 0.5 - 100, 50);\r\n    }\r\n    public set capture(v: Site | undefined) {\r\n        // console.trace();\r\n        if (this._capture !== undefined) {\r\n            this._capture.isActivated = false;\r\n        }\r\n\r\n        this._capture = v;\r\n        if (this._capture !== undefined) {\r\n            this._capture.isActivated = true;\r\n            this._capture.focus();\r\n        } \r\n        // console.log(this._capture)\r\n\r\n    }\r\n    public get capture(): Site | undefined {\r\n        return this._capture;\r\n    }\r\n}","\r\nimport { WaterHyacinth } from '..';\r\nimport { ActiveCommand } from './ActiveCommand'\r\nimport { Common } from './Common'\r\nimport { Scene } from './Scene'\r\n// import { ActiveCommand } from '../Core/ActiveCommand'\r\n\r\n\r\nexport class Core {\r\n    public app: WaterHyacinth;\r\n    public activeCommand: ActiveCommand;\r\n    public common: Common;\r\n    public scene: Scene;\r\n\r\n    constructor(app: WaterHyacinth) {\r\n        this.app = app;\r\n        this.activeCommand = new ActiveCommand(this);\r\n        this.common = new Common(this);\r\n        this.scene = new Scene(this);\r\n    }\r\n\r\n}","// import { MathUtility, NVector3 } from '../../../../../../lib/NJSCore';\r\n\r\nimport { Vector3, isInsideOfVecs } from '../../../lib';\r\n// import { Vector3, MathUtility } from '../../../../../lib';\r\nimport { BoidContollerWander0 } from './BoidContollerWander0';\r\nexport class Boid {\r\n\r\n    static list: Boid[] = [];\r\n    BoidContollerWander0: BoidContollerWander0;\r\n    maxForce = 0.0001; // 1; // 5;\r\n    maxVelocity = 0.0001; // 1; // 8;\r\n    maxSpeed = 0.0001; // 1; // 13.0;\r\n    mass = 10;\r\n\r\n    isRenderable = true;\r\n\r\n    p: Vector3;\r\n\r\n    targets: Vector3[];\r\n    target: Vector3;\r\n    targetID = 0;\r\n\r\n    col: boolean = false;\r\n    desiredVelocity: Vector3;\r\n    steering: Vector3;\r\n    velocity: Vector3 = new Vector3(0, 0, 0);\r\n\r\n    // .......................\r\n    wanderAngle: number = 0;\r\n    CIRCLE_DISTANCE = 50;\r\n    CIRCLE_RADIUS = 50;\r\n    ANGLE_CHANGE = 15;\r\n\r\n    t: number = 0.0;\r\n\r\n    MAX_QUEUE_AHEAD = 15;\r\n    MAX_QUEUE_RADIUS = 10;\r\n    trajectory: Vector3[] = [];\r\n    timerTrajectory = 0.0;\r\n\r\n    scaleBounding = 0.0;\r\n    boundary: Vector3[];\r\n\r\n    constructor(BoidContollerWander0: BoidContollerWander0, p: Vector3, boundary: Vector3[]) {\r\n        this.BoidContollerWander0 = BoidContollerWander0;\r\n        Boid.list.push(this);\r\n        this.p = p;\r\n\r\n        if (boundary) {\r\n            this.boundary = boundary;\r\n        }\r\n        this.UpdateTarget();\r\n    }\r\n    public Update() {\r\n        // this.UpdateVec0();\r\n        this.UpdateVec1();\r\n        // this.UpdateVecSlowDown1();\r\n        // this.UpdateVecSlowDown2();\r\n\r\n    }\r\n    public UpdateTarget() {\r\n        \r\n\r\n            this.target = this.BoidContollerWander0.site.boundary.getRandomSpot();\r\n    }\r\n    public UpdateVec1() {\r\n        this.desiredVelocity = new Vector3(this.target.x - this.p.x, this.target.y - this.p.y, this.target.z - this.p.z);\r\n        this.desiredVelocity.unitize();\r\n        this.desiredVelocity.x *= this.maxVelocity;\r\n        this.desiredVelocity.y *= this.maxVelocity;\r\n        this.desiredVelocity.z *= this.maxVelocity;\r\n\r\n        let x = (this.desiredVelocity.x - this.velocity.x) < this.maxForce ? this.desiredVelocity.x - this.velocity.x : this.maxForce;\r\n        let y = (this.desiredVelocity.y - this.velocity.y) < this.maxForce ? this.desiredVelocity.y - this.velocity.y : this.maxForce;\r\n        let z = (this.desiredVelocity.z - this.velocity.z) < this.maxForce ? this.desiredVelocity.z - this.velocity.z : this.maxForce;\r\n\r\n        this.steering = new Vector3(x / this.mass, y / this.mass, z / this.mass);\r\n\r\n        this.velocity.x = (this.velocity.x + this.steering.x) < this.maxSpeed ? this.velocity.x + this.steering.x : this.maxSpeed;\r\n        this.velocity.y = (this.velocity.y + this.steering.y) < this.maxSpeed ? this.velocity.y + this.steering.y : this.maxSpeed;\r\n        this.velocity.z = (this.velocity.z + this.steering.z) < this.maxSpeed ? this.velocity.z + this.steering.z : this.maxSpeed;\r\n\r\n        this.Queue();\r\n\r\n        this.p.x += this.velocity.x;\r\n        this.p.y += this.velocity.y;\r\n        this.p.z += this.velocity.z;\r\n        this.t += 0.01;\r\n        if (this.t > 3) {\r\n            this.t = 0.0;\r\n            this.UpdateTarget();\r\n        }\r\n    }\r\n    public UpdateVec0() {\r\n        // this.desiredVelocity = new Vector3(this.target.x - this.p.x, this.target.y - this.p.y, this.target.z - this.p.z);\r\n        // this.desiredVelocity.Unitize();\r\n        // this.desiredVelocity.x *= this.maxVelocity;\r\n        // this.desiredVelocity.y *= this.maxVelocity;\r\n        // this.desiredVelocity.z *= this.maxVelocity;\r\n\r\n        // let x = (this.desiredVelocity.x - this.velocity.x) < this.maxForce ? this.desiredVelocity.x - this.velocity.x : this.maxForce;\r\n        // let y = (this.desiredVelocity.y - this.velocity.y) < this.maxForce ? this.desiredVelocity.y - this.velocity.y : this.maxForce;\r\n        // let z = (this.desiredVelocity.z - this.velocity.z) < this.maxForce ? this.desiredVelocity.z - this.velocity.z : this.maxForce;\r\n\r\n        // this.steering = ;\r\n\r\n        this.steering = this.Wander(new Vector3(this.velocity.x, this.velocity.y, this.velocity.z));\r\n\r\n        this.steering.x = this.steering.x < this.maxForce ? this.steering.x : this.maxForce;\r\n        this.steering.y = this.steering.y < this.maxForce ? this.steering.y : this.maxForce;\r\n        this.steering.z = this.steering.z < this.maxForce ? this.steering.z : this.maxForce;\r\n\r\n        this.steering.x /= this.mass;\r\n        this.steering.y /= this.mass;\r\n        this.steering.z /= this.mass;\r\n\r\n        if (this.velocity.x + this.steering.x < this.maxSpeed) {\r\n            this.velocity.x = this.velocity.x + this.steering.x;\r\n        } else {\r\n            this.velocity.x = this.maxSpeed;\r\n        }\r\n        if (this.velocity.y + this.steering.y < this.maxSpeed) {\r\n            this.velocity.y = this.velocity.y + this.steering.y;\r\n        } else {\r\n            this.velocity.y = this.maxSpeed;\r\n        }\r\n        if (this.velocity.z + this.steering.z < this.maxSpeed) {\r\n            this.velocity.z = this.velocity.z + this.steering.z;\r\n        } else {\r\n            this.velocity.z = this.maxSpeed;\r\n        }\r\n        // this.velocity.x = this.velocity.x + this.steering.x < this.maxSpeed ? this.velocity.x + this.steering.x : this.maxSpeed;\r\n        // this.velocity.y = this.velocity.y + this.steering.y < this.maxSpeed ? this.velocity.y + this.steering.y : this.maxSpeed;\r\n        // this.velocity.z = this.velocity.z + this.steering.z < this.maxSpeed ? this.velocity.z + this.steering.z : this.maxSpeed;\r\n\r\n        // steering = wander()\r\n        // steering = truncate (steering, max_force)\r\n        // steering = steering / mass\r\n        // velocity = truncate (velocity + steering , max_speed)\r\n        // position = position + velocity\r\n        this.Queue();\r\n\r\n        console.log(this.maxSpeed);\r\n\r\n        this.p.x += this.velocity.x;\r\n        this.p.y += this.velocity.y;\r\n        this.p.z += this.velocity.z;\r\n\r\n    }\r\n    public Wander(velocity: Vector3) {\r\n        // Calculate the circle center\r\n        let circleCenter = new Vector3(velocity.x, velocity.y, velocity.z);\r\n        circleCenter.normalize();\r\n        circleCenter.scale(this.CIRCLE_DISTANCE);\r\n        //\r\n        // Calculate the displacement force\r\n        let displacement = new Vector3(0, -1);\r\n        displacement.scale(this.CIRCLE_RADIUS);\r\n        //\r\n        // Randomly change the vector direction\r\n        // by making it change its current angle\r\n        displacement = this.setAngle(displacement, this.wanderAngle);\r\n        //\r\n        // Change wanderAngle just a bit, so it\r\n        // won't have the same value in the\r\n        // next game frame.\r\n        this.wanderAngle += Math.random() * this.ANGLE_CHANGE - this.ANGLE_CHANGE * .5;\r\n        //\r\n        // Finally calculate and return the wander force\r\n        var wanderForce: Vector3;\r\n        wanderForce = circleCenter.add(displacement);\r\n        return wanderForce;\r\n    }\r\n    public setAngle(v: Vector3, value: number) {\r\n        let len: number = v.length();\r\n        v.x = Math.cos(value) * len;\r\n        v.y = Math.sin(value) * len;\r\n        return v;\r\n    }\r\n    public GetNeighborAhead() {\r\n        // var i:int;\r\n        var ret: Boid | undefined = undefined;\r\n        var qa: Vector3 = this.velocity.clone();\r\n\r\n        qa.normalize();\r\n        qa.scale(this.MAX_QUEUE_AHEAD);\r\n\r\n        let ahead = this.p.clone().add(qa);\r\n\r\n        for (let i = 0; i < Boid.list.length; i++) {\r\n            let neighbor: Boid = Boid.list[i];\r\n            let d = Vector3.distanceTo(ahead, neighbor.p);\r\n            if (neighbor !== this && d <= this.MAX_QUEUE_RADIUS) {\r\n                ret = neighbor;\r\n                break;\r\n            }\r\n        }\r\n\r\n        return ret;\r\n    }\r\n    public Queue() {\r\n        var neighbor = this.GetNeighborAhead();\r\n\r\n        if (neighbor !== undefined) {\r\n            this.velocity.scale(0.3);\r\n        }\r\n\r\n        return new Vector3(0, 0);\r\n    }\r\n\r\n    // .......................................................................................................................\r\n    public Render(ctx: CanvasRenderingContext2D) {\r\n        // this.RenderDesiredVelocity(ctx);\r\n        // this.RenderCurrentVelocity(ctx);\r\n        this.RenderCircle(ctx);\r\n    }\r\n    public RenderDesiredVelocity(ctx: CanvasRenderingContext2D) {\r\n        // let scale = 20;\r\n        // ctx.lineWidth = 0.5;\r\n        // ctx.strokeStyle = '#00ff00';\r\n        // ctx.beginPath();\r\n        // ctx.moveTo(this.p.x, this.p.y);\r\n        // ctx.lineTo(this.p.x + this.desiredVelocity.x * scale, this.p.y + this.desiredVelocity.y * scale);\r\n        // ctx.closePath();\r\n        // ctx.stroke();\r\n    }\r\n    public RenderCurrentVelocity(ctx: CanvasRenderingContext2D) {\r\n        // let scale = 20;\r\n        // ctx.lineWidth = 0.5;\r\n        // ctx.strokeStyle = '#ff0000';\r\n        // ctx.beginPath();\r\n        // ctx.moveTo(this.p.x, this.p.y);\r\n        // ctx.lineTo(this.p.x + this.velocity.x * scale, this.p.y + this.velocity.y * scale);\r\n        // ctx.closePath();\r\n        // ctx.stroke();\r\n    }\r\n    public RenderCircle(ctx: CanvasRenderingContext2D) {\r\n        // console.log(this.p)\r\n\r\n        const vec = this.BoidContollerWander0.site.project.app.core.common.toScreen(this.p.x, this.p.y);\r\n        // console.log(vec)\r\n\r\n        this.t += 0.05\r\n        this.timerTrajectory += 1;\r\n        if (this.timerTrajectory % 5 === 0) {\r\n            if (this.trajectory.length > 30) {\r\n                this.trajectory.shift();\r\n            }\r\n            this.trajectory.push(new Vector3(this.p.x, this.p.y));\r\n\r\n            this.timerTrajectory = 0;\r\n        }\r\n        for (let i = 0; i < this.trajectory.length; ++i) {\r\n            ctx.fillStyle = 'rgba(100, 100, 100 ,0.1)';\r\n            ctx.beginPath();\r\n            ctx.arc(this.trajectory[i].x, this.trajectory[i].y, (i) * 0.2, 0, 3.14 * 2);\r\n            ctx.closePath();\r\n            ctx.fill();\r\n        }\r\n\r\n        ctx.strokeStyle = '#000000';\r\n        ctx.lineWidth = 0.5;\r\n        // ctx.beginPath();\r\n        // ctx.moveTo(this.targets[0].x , this.targets[0].y);\r\n        // for (let i = 1 ; i < this.targets.length; ++i) {\r\n        //   ctx.lineTo(this.targets[i].x , this.targets[i].y);\r\n        // }\r\n        // ctx.closePath();\r\n        // ctx.stroke();\r\n\r\n        // const target = this.BoidContollerWander0.site.project.app.core.common.toScreen(this.target.x, this.target.y);\r\n\r\n        // ctx.beginPath();\r\n        // ctx.moveTo(vec[0], vec[1]);\r\n        // ctx.lineTo(target[0], target[1]);\r\n        // ctx.stroke();\r\n  \r\n        // ctx.fillStyle = '#000000';\r\n        // ctx.beginPath();\r\n        // ctx.arc(this.target.x, this.target.y, 2.5, 0, 3.14 * 2);\r\n        // ctx.closePath();\r\n        // ctx.fill();\r\n\r\n\r\n\r\n        ctx.fillStyle = '#000000';\r\n        ctx.beginPath();\r\n        ctx.arc(this.target.x, this.target.y, 2.5, 0, 3.14 * 2);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n\r\n\r\n        ctx.fillStyle = '#fff';\r\n        ctx.beginPath();\r\n        ctx.arc(vec[0], vec[1], 2.5, 0, 3.14 * 2);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        ctx.beginPath();\r\n        ctx.arc(vec[0], vec[1], 10 + Math.sin(this.t) * 5, 0, 3.14 * 2);\r\n        ctx.closePath();\r\n        // ctx.fill();\r\n        ctx.stroke();\r\n\r\n        // animation\r\n        ctx.lineWidth = 0.5;\r\n        ctx.strokeStyle = `rgba(${255}, ${255}, ${0}, ${1 - this.scaleBounding * 0.07})`;\r\n        ctx.fillStyle = `rgba(${255}, ${255}, ${0}, ${1 - this.scaleBounding * 0.07})`;\r\n        ctx.beginPath();\r\n        ctx.arc(vec[0], vec[1], this.scaleBounding, 0, 3.14 * 2);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        ctx.stroke();\r\n        this.scaleBounding += 0.2;\r\n        if (1 - this.scaleBounding * 0.07 < 0) {\r\n            this.scaleBounding = 0;\r\n        }\r\n\r\n\r\n    }\r\n}\r\n","// import { MathUtility, NVector3 } from '../../../../../../lib/NJSCore';\r\n\r\nimport { Vector3, isInsideOfVecs } from '../../../lib';\r\n// import { Vector3, MathUtility } from '../../../../../lib';\r\nimport { Boid } from './Agent';\r\nimport { Site } from '..';\r\n\r\nexport class BoidContollerWander0 {\r\n  site: Site;\r\n  boids: Boid[] = [];\r\n\r\n  vsBoundary: Vector3[];\r\n\r\n  constructor(site: Site) {\r\n    this.site = site;\r\n    this.boids = [];\r\n    this.vsBoundary = site.boundary.vsBoundary;\r\n\r\n  }\r\n  public AddAgent(x: number, y: number) {\r\n    const geoPos = this.site.project.app.core.common.toMap(x, y);\r\n    console.log(geoPos)\r\n    let boid = new Boid(this, new Vector3(geoPos[0], geoPos[1]), this.vsBoundary);\r\n    this.boids.push(boid);\r\n  }\r\n  public Update() {\r\n    for (let b of this.boids) {\r\n      b.Update();\r\n    }\r\n\r\n  }\r\n  public GetPoint() {\r\n    let pts: Vector3[] = [];\r\n    for (let b of this.boids) {\r\n      if (b.isRenderable) {\r\n        pts.push(b.p);\r\n      }\r\n    }\r\n    return pts;\r\n  }\r\n\r\n  // .......................................................................................................................\r\n\r\n  public Render(ctx: CanvasRenderingContext2D) {\r\n    // console.log(this.boids)\r\n    // this.boids.forEach((b) => { b.Render(ctx); });\r\n\r\n\r\n\r\n    // ctx.beginPath()\r\n    // ctx.moveTo(this.vsBoundary[0].x, this.vsBoundary[0].y)\r\n    // for (let i = 1; i < this.vsBoundary.length; ++i) {\r\n    //   ctx.lineTo(this.vsBoundary[i].x, this.vsBoundary[i].y)\r\n    // }\r\n    // ctx.stroke();\r\n  }\r\n}\r\n\r\n","\r\nimport { remap, Vector3, isInsideOfVecs, distanceTo } from '../../../lib';\r\n// import { MathUtility, NVector3 } from '../../../../../lib/NJSCore';\r\n\r\nimport { Site } from '..'\r\n\r\nexport class Boundary {\r\n    site: Site;\r\n    lon: number;\r\n    lat: number;\r\n\r\n    vsBoundary: Vector3[] = [];\r\n\r\n    pMin: Vector3 = new Vector3(180, 90, 0);\r\n    pMax: Vector3 = new Vector3(-180, -90, 0);\r\n    pCenter: Vector3 = new Vector3(0, 0, 0);\r\n\r\n    ctxTemp: CanvasRenderingContext2D;\r\n\r\n    constructor(site: Site, boundary: number[]) {\r\n        this.site = site;\r\n\r\n        for (let i = 0; i < boundary.length; i += 2) {\r\n\r\n            this.pCenter.x += boundary[i];\r\n            this.pCenter.y += boundary[i + 1];\r\n\r\n            if (boundary[i] < this.pMin.x) { this.pMin.x = boundary[i]; }\r\n            if (boundary[i + 1] < this.pMin.y) { this.pMin.y = boundary[i + 1]; }\r\n\r\n            if (boundary[i] > this.pMax.x) { this.pMax.x = boundary[i]; }\r\n            if (boundary[i + 1] > this.pMax.y) { this.pMax.y = boundary[i + 1]; }\r\n\r\n            this.vsBoundary.push(new Vector3(boundary[i], boundary[i + 1], 0))\r\n        }\r\n\r\n        this.pCenter.x /= boundary.length * 0.2\r\n        this.pCenter.y /= boundary.length * 0.2\r\n\r\n        const img = new Image(); // Create new img element\r\n        img.src = process.env.PUBLIC_URL + '/static/data/Watabot/freshPond.jpg';\r\n        img.crossOrigin = \"Anonymous\";\r\n        img.onload = () => {\r\n            const xNum = 50;\r\n            const yNum = 50;\r\n\r\n            const width = img.width;\r\n            const height = img.height;\r\n            const zScale = 5.5;\r\n\r\n            const xInterval = width / (xNum - 1.0);\r\n            const yInterval = height / (yNum - 1.0);\r\n\r\n            const canvas = document.createElement('canvas');\r\n            canvas.width = width;\r\n            canvas.height = height;\r\n            // this.hostDiv.append(canvas);\r\n            const ctx = canvas.getContext('2d', {willReadFrequently: true} );\r\n    \r\n            ctx.drawImage(img, 0, 0);\r\n            this.ctxTemp = ctx;\r\n\r\n            // console.log('done loading image');\r\n            // const vertices = [];\r\n            // for (let y = 0; y < yNum; ++y) {\r\n            //     for (let x = 0; x < xNum; ++x) {\r\n            //         let col = ctx.getImageData(x * xInterval, y * yInterval, 1, 1).data;\r\n            //         let zVal = RGBtoGray(col[0] / 255, col[1] / 255, col[2] / 255);\r\n            //         let z = -zVal * zScale;\r\n            //         vertices.push(x - (xNum * 0.5), y - (yNum * 0.5), z);\r\n            //     }\r\n            // }\r\n        }\r\n\r\n    }\r\n    getRandomSpot() {\r\n        let x = remap(Math.random(), 0, 1, this.pMin.x, this.pMax.x);\r\n        let y = remap(Math.random(), 0, 1, this.pMin.y, this.pMax.y);\r\n        let vec = new Vector3(x, y);\r\n        let i = 0\r\n        while (!isInsideOfVecs(vec, this.vsBoundary)) {\r\n            vec.x = remap(Math.random(), 0, 1, this.pMin.x, this.pMax.x);\r\n            vec.y = remap(Math.random(), 0, 1, this.pMin.y, this.pMax.y);\r\n            if (i++ > 1000) {\r\n                break\r\n            }\r\n        }\r\n        // console.trace();\r\n        return vec;\r\n    }\r\n    render(ctx: CanvasRenderingContext2D) {\r\n        if (this.vsBoundary.length < 1) {\r\n\r\n            let col = '#ff0000'\r\n            if (this.site.properties.probability < 0.3) {\r\n                col = '#00ff00'\r\n            }\r\n\r\n            ctx.fillStyle = col;\r\n            ctx.beginPath();\r\n            ctx.arc(this.site.vec.x, this.site.vec.y, 10, 0, Math.PI * 2);\r\n            ctx.closePath();\r\n            ctx.fill();\r\n\r\n        } else {\r\n            let pos = this.site.project.app.core.common.toScreen(this.vsBoundary[0].x, this.vsBoundary[0].y)\r\n            ctx.moveTo(pos[0], pos[1])\r\n            for (let i = 1; i < this.vsBoundary.length; i += 1) {\r\n                pos = this.site.project.app.core.common.toScreen(this.vsBoundary[i].x, this.vsBoundary[i].y)\r\n                ctx.lineTo(pos[0], pos[1])\r\n            }\r\n            ctx.lineWidth = 2;\r\n            ctx.strokeStyle = '#000000';\r\n            ctx.stroke();\r\n        }\r\n\r\n        const res = 20\r\n        const intervalX = (this.pMax.x - this.pMin.x) / (res - 1);\r\n        const intervalY = (this.pMax.y - this.pMin.y) / (res - 1);\r\n\r\n        const interXImage = this.ctxTemp.canvas.width / (res - 1);\r\n        const interYImage = this.ctxTemp.canvas.height / (res - 1);\r\n\r\n        let minDis = Number.MAX_SAFE_INTEGER;\r\n        let id = [0,0];\r\n        for (let i = 0; i < res; ++i) {\r\n            const x = this.pMin.x + intervalX * i\r\n            for (let j = 0; j < res; ++j) {\r\n                const y = this.pMin.y + intervalY * j\r\n\r\n                if (isInsideOfVecs(new Vector3(x, y), this.vsBoundary)) {\r\n                    const sp = this.site.project.app.core.common.toScreen(x, y)\r\n                    // console.log(sp);\r\n    \r\n                    let col = this.ctxTemp.getImageData(i * interXImage, j * interYImage, 1, 1).data;\r\n                    // console.log(col);\r\n                    ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, 1)`;\r\n                    ctx.beginPath();\r\n                    ctx.arc(sp[0], sp[1], 10, 0, Math.PI * 2.);\r\n                    ctx.fill();\r\n\r\n                    let dis = distanceTo(this.site.project.app.core.activeCommand.m[2], this.site.project.app.core.activeCommand.m[3], 0, x, y, 0);\r\n                    if (dis < minDis) {\r\n                        minDis = dis;\r\n                        id = [i, j]\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        // console.log(id);\r\n        let xHover = this.pMin.x + intervalX * id[0];\r\n        let yHover = this.pMin.y + intervalY * id[1];\r\n        const sp = this.site.project.app.core.common.toScreen(xHover, yHover)\r\n        ctx.strokeStyle = `rgba(255, 255,255, 1)`;\r\n        ctx.beginPath();\r\n        ctx.arc(sp[0], sp[1], 10, 0, Math.PI * 2.);\r\n        ctx.stroke();\r\n\r\n    }\r\n}","import { Project } from '..';\r\nimport { distanceTo, Vector3, isInsideOfVecs, remap, renderPoint } from '../../lib';\r\nimport { BoidContollerWander0 } from './Agent/BoidContollerWander0';\r\n// import { MathUtility, NVector3 } from '../../../../../lib/NJSCore';\r\n\r\nimport { Boundary } from './Boundary';\r\n\r\nclass Properties {\r\n    probability: number = 0.0;\r\n    lon: number;\r\n    lat: number;\r\n    zoom: number;\r\n    name: string;\r\n}\r\n\r\nexport class Site {\r\n    project: Project;\r\n\r\n    properties: Properties;\r\n\r\n    vec: Vector3 = new Vector3(0, 0, 0);\r\n    r: number = 15;\r\n\r\n    boundary: Boundary;\r\n    // boundary: Vector3[] = [];\r\n\r\n    pMin: Vector3 = new Vector3(180, 90, 0);\r\n    pMax: Vector3 = new Vector3(-180, -90, 0);\r\n\r\n    BoidContollerWander0: BoidContollerWander0;\r\n    needAgent = false;\r\n\r\n    isActivated = false;\r\n\r\n    hover: boolean = false;\r\n\r\n    constructor(solution: Project, properties) {\r\n        this.project = solution;\r\n\r\n        this.properties = new Properties();\r\n        this.properties.lon = properties.loc[0];\r\n        this.properties.lat = properties.loc[1];\r\n        this.properties.zoom = properties.zoom;\r\n        this.properties.name = properties.name;\r\n        this.properties.probability = properties.probability;\r\n\r\n        this.r = 15;\r\n\r\n        this.boundary = new Boundary(this, properties.boundary);\r\n\r\n\r\n    }\r\n    initAgent() {\r\n        this.BoidContollerWander0 = new BoidContollerWander0(this)\r\n        this.needAgent = true;\r\n    }\r\n    focus() {\r\n        this.project.app.core.common.center(this.properties.lon, this.properties.lat);\r\n        this.project.app.core.common.zoom = this.properties.zoom;\r\n    }\r\n    blur() {\r\n\r\n    }\r\n    click(x: number, y: number) {\r\n        // console.log(x, y);\r\n\r\n        if (this.BoidContollerWander0 === undefined) {\r\n            this.initAgent();\r\n            this.BoidContollerWander0.AddAgent(this.vec.x, this.vec.y)\r\n        }\r\n\r\n        // const dis = distanceTo(x, y, 0, this.sx, this.sy, 0);\r\n        // if (dis < this.r) {\r\n        //     this.isActivate = true;\r\n        //     this.focus();\r\n        // this.initAgent();\r\n        // } else {\r\n        //     this.isActivate = false;\r\n        // }\r\n\r\n\r\n        // if(!this.isActivate) { return; }\r\n\r\n\r\n        // console.log(dis, this.r)\r\n\r\n        if (this.BoidContollerWander0 && this.needAgent) {\r\n            // let pos = this.project.app.core.common.toMap(x, y)\r\n            // console.log(pos)\r\n            this.BoidContollerWander0.AddAgent(x, y)\r\n        }\r\n\r\n        // console.log(this.getRandomSpot())\r\n    }\r\n    public isHover(x: number, y: number) {\r\n        if (distanceTo(x, y, 0, this.vec.x, this.vec.y, 0) < this.r) {\r\n            this.hover = true;\r\n        } else {\r\n            this.hover = false;\r\n        }\r\n    }\r\n    public renderDot(ctx: CanvasRenderingContext2D) {\r\n        let pos = this.project.app.core.common.toScreen(this.properties.lon, this.properties.lat);\r\n        this.vec.x = pos[0];\r\n        this.vec.y = pos[1];\r\n\r\n        if (this.project.app.core.common.zoom < this.properties.zoom - 2) {\r\n            let col = '#ff0000'\r\n            if (this.properties.probability < 0.3) {\r\n                col = '#00ff00'\r\n            }\r\n\r\n            let t = 1;\r\n            ctx.fillStyle = col;\r\n            ctx.beginPath();\r\n            ctx.arc(this.vec.x, this.vec.y, (Math.sin(t * 0.8) + 4) * 2, 0, Math.PI * 2);\r\n            ctx.closePath();\r\n            ctx.fill();\r\n\r\n            if (this.hover) {\r\n                ctx.lineWidth = 3\r\n                ctx.strokeStyle = '#ffffff';\r\n                ctx.stroke();\r\n            }\r\n\r\n            if (this.hover) {\r\n                ctx.beginPath();\r\n                ctx.font = \"12px Arial\";\r\n                ctx.fillText(this.properties.name, this.vec.x + 15, this.vec.y);\r\n            }\r\n\r\n        }\r\n\r\n\r\n        if (this.project.app.core.common.zoom < this.properties.zoom - 2) {\r\n            if (this.project.app.core.scene.capture === this) {\r\n                this.project.app.core.scene.capture = undefined;\r\n            }\r\n        }\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D) {\r\n        // console.log(this.isActivated)\r\n        if (!this.isActivated) { return; }\r\n        // if (this.project.app.core.common.zoom < this.properties.zoom - 2) {\r\n        //     let col = '#ff0000'\r\n        //     if (this.properties.probability < 0.3) {\r\n        //         col = '#00ff00'\r\n        //     }\r\n\r\n        //     let t = 1;\r\n        //     ctx.fillStyle = col;\r\n        //     ctx.beginPath();\r\n        //     ctx.arc(this.vec.x, this.vec.y, (Math.sin(t * 0.8) + 4) * 2, 0, Math.PI * 2);\r\n        //     ctx.closePath();\r\n        //     ctx.fill();\r\n\r\n        //     if (this.hover) {\r\n        //         ctx.lineWidth = 3\r\n        //         ctx.strokeStyle = '#ffffff';\r\n        //         ctx.stroke();\r\n        //     }\r\n\r\n        //     if (this.project.app.core.scene.capture === this){\r\n        //         this.project.app.core.scene.capture = undefined;\r\n        //     }\r\n\r\n        // }\r\n\r\n        // console.log(this.project.app.core.common.getZoomLevel())\r\n\r\n        // if(!this.isActivate) { return; }\r\n\r\n        // if (this.needAgent === false) {\r\n        //     this.initAgent();\r\n        // }\r\n\r\n        if (this.project.app.core.common.zoom >= this.properties.zoom - 2) {\r\n           this.boundary.render(ctx);\r\n\r\n        }\r\n        // console.log(this.BoidContollerWander0)\r\n        if (this.BoidContollerWander0) {\r\n            this.BoidContollerWander0.Update();\r\n            this.BoidContollerWander0.Render(ctx);\r\n        }\r\n    }\r\n}","import { WaterHyacinth  } from '..';\r\nimport { Site } from './Site';\r\n\r\nexport class Project {\r\n    rawSiteData: any\r\n    app: WaterHyacinth;\r\n    sites: Site[] = [];\r\n    constructor(app: WaterHyacinth, siteData: any) {\r\n        this.app = app;\r\n        this.initSite(siteData)\r\n    }\r\n    public initSite(siteData: any) {\r\n        this.rawSiteData = siteData;\r\n        for (let i = 0; i < siteData.length; ++i) {\r\n            const siteObj = new Site(this, siteData[i]);\r\n            this.sites.push(siteObj);\r\n        }\r\n    }\r\n}","import { Scene } from '../Core/Scene';\r\nexport class Tracer {\r\n    scene: Scene;\r\n    divHost: HTMLElement;\r\n    div: HTMLElement\r\n    ptsGeoTracing: number[] = undefined;\r\n    toMap: (x: number, y: number) => number[];\r\n    toScreen: (x: number, y: number) => number[];\r\n    destroyApp: () => void;\r\n    constructor(divHost: HTMLElement, toMap: (x: number, y: number) => number[], toScreen: (x: number, y: number) => number[], destroy: () => void ) {\r\n        this.divHost = divHost;\r\n        this.toScreen = toScreen;\r\n        this.toMap = toMap;\r\n        this.destroyApp = destroy;\r\n        this.ptsGeoTracing = [];\r\n        this.initHTML();\r\n    }\r\n    public initHTML() {\r\n        const div = document.createElement('div');\r\n        this.div = div;\r\n        div.style.left = '200px';\r\n        div.style.width = '100px';\r\n        div.style.height = '200px';\r\n        div.style.padding = '10px';\r\n        div.style.position = 'absolute';\r\n        div.style.background = '#000';\r\n        this.divHost.appendChild(div);\r\n\r\n\r\n        let divBtn = document.createElement('div');\r\n        divBtn.style.marginBottom = '5px';\r\n        divBtn.style.width = '20px';\r\n        divBtn.style.height = '20px';\r\n        divBtn.textContent = 'Tracer';\r\n        divBtn.style.color = '#fff';\r\n        div.appendChild(divBtn);\r\n\r\n        divBtn = document.createElement('div');\r\n        divBtn.style.marginBottom = '5px';\r\n        divBtn.style.height = '20px';\r\n        divBtn.textContent = 'X';\r\n        divBtn.style.color = '#fff';\r\n        div.appendChild(divBtn);\r\n        divBtn.onclick = () => {\r\n            this.ptsGeoTracing = [];\r\n            this.destroy();\r\n        }\r\n\r\n        divBtn = document.createElement('div');\r\n        divBtn.style.marginBottom = '5px';\r\n        divBtn.style.height = '20px';\r\n        divBtn.textContent = 'Reset';\r\n        divBtn.style.color = '#fff';\r\n        divBtn.onclick = () => {\r\n            this.ptsGeoTracing = [];\r\n        }\r\n        div.appendChild(divBtn);\r\n\r\n\r\n        divBtn = document.createElement('div');\r\n        divBtn.style.marginBottom = '5px';\r\n        divBtn.style.height = '20px';\r\n        divBtn.textContent = 'Print';\r\n        divBtn.style.color = '#fff';\r\n        divBtn.onclick = () => {\r\n            console.log(this.ptsGeoTracing);\r\n        }\r\n        div.appendChild(divBtn);\r\n    }\r\n    public click(x: number, y: number) {\r\n        const mp = this.toMap(x, y);\r\n        console.log(`Lon:${mp[0]}, Lat:${mp[1]}`);\r\n        this.ptsGeoTracing.push(mp[0], mp[1]);\r\n    }\r\n    public startCapture() {\r\n        this.ptsGeoTracing = [];\r\n    }\r\n    public endCapture() {\r\n        this.ptsGeoTracing = undefined;\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D) {\r\n        if (this.ptsGeoTracing !== undefined) {\r\n\r\n            if (this.ptsGeoTracing.length > 3) {\r\n                // console.log(this.ptsGeo.length)\r\n                ctx.beginPath();\r\n                let pos = this.toScreen(this.ptsGeoTracing[0], this.ptsGeoTracing[1])\r\n                // console.log(pos)\r\n                ctx.moveTo(pos[0], pos[1])\r\n                for (let i = 2; i < this.ptsGeoTracing.length; i += 2) {\r\n                    pos = this.toScreen(this.ptsGeoTracing[i], this.ptsGeoTracing[i + 1])\r\n                    ctx.lineTo(pos[0], pos[1])\r\n                }\r\n                ctx.lineWidth = 2;\r\n                ctx.strokeStyle = '#000000';\r\n                ctx.stroke();\r\n                // console.log(pos)\r\n\r\n\r\n            }\r\n\r\n            for (let i = 0; i < this.ptsGeoTracing.length; i += 2) {\r\n                let pos = this.toScreen(this.ptsGeoTracing[i], this.ptsGeoTracing[i + 1])\r\n                ctx.beginPath();\r\n                ctx.arc(pos[0], pos[1], 10, 0, Math.PI * 2.);\r\n                ctx.closePath();\r\n                ctx.fillStyle = '#fff';\r\n                ctx.fill();\r\n            }\r\n        }\r\n    }\r\n    public destroy = () => {\r\n        this.div.parentElement.removeChild(this.div);\r\n        this.destroyApp();\r\n    }\r\n}","\r\nimport { WaterHyacinth } from '../';\r\n\r\nimport { Tracer } from './Tracer';\r\n\r\nexport class Addon {\r\n    public app: WaterHyacinth;\r\n    public tracer: Tracer;\r\n    constructor(app: WaterHyacinth) {\r\n        this.app = app;\r\n\r\n        // console.log(this.app.param['dev'])\r\n        if (this.app.param['dev']) {\r\n            this.initDev();\r\n        }\r\n    }\r\n\r\n    public initDev() {\r\n        this.appendTracer();\r\n    }\r\n    public appendTracer() {\r\n        this.tracer = new Tracer(\r\n            this.app.divHost, this.app.core.common.toMap, this.app.core.common.toScreen,\r\n            () => { this.tracer = undefined; }\r\n            );\r\n    }\r\n    public click(x: number, y: number) {\r\n        if (this.tracer) {\r\n            this.tracer.click(x, y);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D) {\r\n        if (this.tracer) {\r\n            this.tracer.render(ctx);\r\n        }\r\n    }\r\n}","import { Renderer } from './Renderer';\r\nimport { UI } from './UI';\r\nimport { Core } from './Core';\r\nimport { Project } from './Project';\r\nimport { Addon } from './Addon';\r\nimport { PARAM } from '../../../../App';\r\n\r\n\r\nconst siteData = [\r\n    {\r\n        name: 'Lake, Hills Pond',\r\n        loc: [-71.16562914640474, 42.410989862313016],\r\n        zoom: 18,\r\n        boundary: [ ],\r\n        probability: 0.2\r\n    },\r\n    {\r\n        name: 'Fresh Pond, MA',\r\n        loc: [-71.149732, 42.384607],\r\n        zoom: 15,\r\n        boundary: [-71.1471427741205, 42.38369829310599, -71.1454147151241, 42.3832249146333, -71.144831067490, 42.3832249146333, -71.1443618590280, 42.38337707280340, -71.1441215328383, 42.383732105164675, -71.14404142410845, 42.383918074064034, -71.14333189076628, 42.38393498100385, -71.14304578890791, 42.38390962107612, -71.14250791563302, 42.38439990023337, -71.14218748071345, 42.38483100457135, -71.14194715583345, 42.385515693014376, -71.1419242679991, 42.38611584616517, -71.14195859975062, 42.38675825758481, -71.14258802305322, 42.38719779779073, -71.14291990319965, 42.38732458778373, -71.14453352040498, 42.386800521078975, -71.14480817834618, 42.386682182643234, -71.1458152574639, 42.386614560234314, -71.14628446723574, 42.38642014715624, -71.14731443549749, 42.386310260185624, -71.1480583005912, 42.386825879355264, -71.14865339345197, 42.38736685138028, -71.14920271064405, 42.38786555599473, -71.14972913869208, 42.38809377527334, -71.15045011595143, 42.38839806619294, -71.150770550871, 42.38855866418817, -71.15119398235481, 42.38851640139403, -71.15201795748807, 42.38808532284766, -71.152601605122, 42.387831745678575, -71.1531280344797, 42.38768805126903, -71.15357435379786, 42.38762888291559, -71.15443266068266, 42.38764578837241, -71.15494764481353, 42.387510546041405, -71.15566862272772, 42.38729077717622, -71.15596616784842, 42.38674135140531, -71.15580595169831, 42.38591297834076, -71.15579450647148, 42.38537199330331, -71.15533674389097, 42.38487326936299, -71.15510786096365, 42.38474647441903, -71.15506208529494, 42.38436608756697, -71.15518797034836, 42.38398569889383, -71.1550048643994, 42.383698293105994, -71.15437543978712, 42.38314883589375, -71.15383756651222, 42.382548654862966, -71.15368879427928, 42.382109081622424, -71.15355146596352, 42.381661052013705, -71.152897722045, 42.38158391447455, -71.15219963196516, 42.3816473151721, -71.1516159836764, 42.38149092663678, -71.1510380566914, 42.38128804386745, -71.15056884888406, 42.38108515995885, -71.1502713024538, 42.380882275394804, -71.15031135681876, 42.38053990659923, -71.1502713024538, 42.380205989424546, -71.15002525430553, 42.37991856585079, -71.14973915179233, 42.37980021492652, -71.1489151773139, 42.379817122007765, -71.1484173590588, 42.380003102503316, -71.1477135476752, 42.38003691703571, -71.14716995244171, 42.380015782773704, -71.14683807425982, 42.380176401728896, -71.14592826974774, 42.380844234617186, -71.14588249276937, 42.381038665446106, -71.14597976737502, 42.3811739212357, -71.14702690151253, 42.381672675046346, -71.14758194000835, 42.381985450580224, -71.14785087664579, 42.38231935829161, -71.14782798881144, 42.382619450861974, -71.14754188629824, 42.383080153525164, -71.14754188629824, 42.383342202953166, -71.14743888907917, 42.38349858687732, -71.14730156010857, 42.38364651714675, -71.1471427741205, 42.38369829310599],\r\n        probability: 0.8\r\n    },\r\n    {\r\n        name: 'Lake, Atkinson County',\r\n        loc: [-82.716073, 31.205917], // 31.205917,-82.716073\r\n        zoom: 18,\r\n        boundary: [1, 18],\r\n        probability: 0.2\r\n    }\r\n];\r\n\r\nexport class WaterHyacinth {\r\n    public divHost: HTMLElement\r\n    public core: Core;\r\n    public renderer: Renderer;\r\n    public ui: UI;\r\n    public project: Project;\r\n    public param: any;\r\n    public addon: Addon;\r\n    constructor(view: any) {\r\n\r\n        if (Boolean(PARAM['demo']) === true) {\r\n            this.init(view);\r\n        }\r\n    }\r\n    private init(view: any) {\r\n        this.divHost = view;\r\n        this.divHost.id = 'mapboxgl-container'\r\n        this.param = PARAM;\r\n\r\n        this.renderer = new Renderer(this);\r\n        this.core = new Core(this);\r\n        this.project = new Project(this, siteData);\r\n        this.addon = new Addon(this);\r\n        this.ui = new UI(this);\r\n        this.renderer.init();\r\n    }\r\n    public destroy() {\r\n        // this.renderer.destroy();\r\n        if (this.divHost){\r\n            while (this.divHost.lastElementChild) {\r\n                this.divHost.removeChild(this.divHost.lastElementChild);\r\n            }\r\n        }\r\n\r\n    }\r\n}\r\n"],"names":["MapboxGLWrapper","id","map","center","lng","lat","setCenter","toMap","x","y","p","unproject","toScreen","lon","project","mouseDown","e","mouseUp","mouseMove","mouseClick","mouseDClick","this","initMap","mapboxgl","container","zoom","style","dragRotate","disable","on","div","document","getElementsByClassName","position","display","getZoom","v","setZoom","RendererCanvasDynamic","time","pts","mouseDrag","canvas","width","height","pointerEvents","start","ctx","RendererCanvasDynamicLight","Renderer","app","canvasCustom","colorArray1","colorArray2","originalZoom","originalCenter","render","globalCompositeOperation","xOff","yOff","i","length","beginPath","rect","closePath","fillStyle","fill","core","scene","processEventData","divHost","result","getFalseColor","push","zoomOut","k","m","activeCommand","forceRender","UI","solution","color","background","backdropFilter","createElement","padding","append","getDivBtn","onclick","addon","appendTracer","host","title","appendChild","marginTop","textContent","ActiveCommand","common","checkHover","click","capture","sites","getCloseSite","properties","renderer","Common","site","distanceTo","vec","r","forEach","isHover","Scene","_capture","renderDot","undefined","font","log","toFixed","fillText","isActivated","focus","Core","Boid","BoidContollerWander0","boundary","maxForce","maxVelocity","maxSpeed","mass","isRenderable","targets","target","targetID","col","desiredVelocity","steering","velocity","Vector3","wanderAngle","CIRCLE_DISTANCE","CIRCLE_RADIUS","ANGLE_CHANGE","t","MAX_QUEUE_AHEAD","MAX_QUEUE_RADIUS","trajectory","timerTrajectory","scaleBounding","list","UpdateTarget","UpdateVec1","getRandomSpot","z","unitize","Queue","Wander","console","circleCenter","normalize","scale","displacement","setAngle","Math","random","add","value","len","cos","sin","ret","qa","clone","ahead","neighbor","d","GetNeighborAhead","RenderCircle","shift","arc","strokeStyle","lineWidth","stroke","boids","vsBoundary","geoPos","boid","Update","b","Boundary","pMin","pMax","pCenter","ctxTemp","img","Image","src","process","crossOrigin","onload","getContext","willReadFrequently","drawImage","remap","isInsideOfVecs","probability","PI","pos","moveTo","lineTo","res","intervalX","intervalY","interXImage","interYImage","minDis","Number","MAX_SAFE_INTEGER","j","sp","getImageData","data","dis","xHover","yHover","Properties","name","Site","needAgent","hover","loc","initAgent","AddAgent","Render","Project","siteData","rawSiteData","initSite","siteObj","Tracer","destroy","ptsGeoTracing","destroyApp","parentElement","removeChild","initHTML","left","divBtn","marginBottom","mp","Addon","tracer","param","initDev","WaterHyacinth","view","ui","Boolean","PARAM","init","lastElementChild"],"sourceRoot":""}