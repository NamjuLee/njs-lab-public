{"version":3,"file":"static/js/5451.7af340ff.chunk.js","mappings":"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","sources":["njslab/Lab/image-zoom-pan/Util.ts","njslab/Lab/image-zoom-pan/Canvas.ts","njslab/Lab/image-zoom-pan/Controller.ts","njslab/Lab/image-zoom-pan/index.ts"],"sourcesContent":["\r\nexport const draw = (ctx, img, zooming?) => {\r\n    ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height)\r\n    ctx.save()\r\n\r\n    if (zooming !== undefined) {\r\n        ctx.translate(zooming.x, zooming.y)\r\n        ctx.scale(zooming.z, zooming.z)\r\n    }\r\n\r\n    if (img !== undefined) {\r\n        ctx.drawImage(img, 0, 0, img.width, img.height)\r\n    }\r\n\r\n    // ctx.lineWidth = 1.0\r\n    // ctx.strokeStyle = 'red'\r\n    // ctx.strokeRect(58, 78, 14, 14)\r\n\r\n    // ctx.beginPath()\r\n    // ctx.fillStyle = 'yellow'\r\n    // ctx.arc(ctx.canvas.width / 2, ctx.canvas.height / 2, 50, 0, Math.PI * 2, true)\r\n    // ctx.fill()\r\n\r\n    ctx.restore()\r\n};\r\nexport class Vector {\r\n    static add(v0: Vector, v1: Vector) {\r\n        return new Vector(v0.x + v1.x, v0.y + v1.y, v0.z + v1.z);\r\n    }\r\n    static subtract(v0: Vector, v1: Vector) {\r\n        return new Vector(v0.x - v1.x, v0.y - v1.y, v0.z - v1.z);\r\n    }\r\n    public static distance(v0: Vector, v1: Vector): number {\r\n        return Math.sqrt((v0.x - v1.x) * (v0.x - v1.x) + (v0.y - v1.y) * (v0.y - v1.y) + (v0.z - v1.z) * (v0.z - v1.z));\r\n    }\r\n    public static deepCopy(v: Vector): Vector {\r\n        return new Vector(v.x, v.y, v.z);\r\n    }\r\n    public x: number\r\n    public y: number\r\n    public z: number\r\n    constructor(x: number, y: number, z: number) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n    }\r\n    public length(): number {\r\n        return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\r\n    }\r\n    public normalize() {\r\n        let len: number = Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\r\n        this.x /= len;\r\n        this.y /= len;\r\n        this.z /= len;\r\n    }\r\n};\r\nexport const zoomOffset = (canvas, scale, { x, y }, statusPre) => {\r\n    const isZooming = scale !== 1\r\n    const newX = isZooming ? (x + Math.abs(statusPre.x)) / statusPre.z : x\r\n    const newY = isZooming ? (y + Math.abs(statusPre.y)) / statusPre.z : y\r\n    const dx = newX - (newX * scale) + (x - newX)\r\n    const dy = newY - (newY * scale) + (y - newY)\r\n    return { ...applyBoundaries(canvas, scale, { x: dx, y: dy }) }\r\n};\r\nexport const applyBoundaries = (canvas, scale, { x, y }) => {\r\n    // const scaleMargin = 1 - scale;\r\n    // const maxOffsetX = scaleMargin * canvas.width;\r\n    // const maxOffsetY = scaleMargin * canvas.height;\r\n    // if (x > 0) {\r\n    //     x = 0\r\n    // } else if (x < maxOffsetX) {\r\n    //     x = maxOffsetX;\r\n    // }\r\n    // if (y > 0) {\r\n    //     y = 0\r\n    // } else if (y < maxOffsetY) {\r\n    //     y = maxOffsetY;\r\n    // }\r\n    return { x, y }\r\n};\r\n\r\n// \r\n\r\nexport const loadImage = (url: string = 'https://raw.githubusercontent.com/NamjuLee/data/master/img/person/HaminHaram.jpg') => {\r\n// export const loadImage = (url: string = 'https://raw.githubusercontent.com/NamjuLee/data/master/img/worldmap/worldMap_03.jpg') => {\r\n    return new Promise((resolve, reject) => {\r\n        let img = new Image()\r\n        img.onload = () => {\r\n            resolve(img)\r\n            img.onload = null\r\n            img = null\r\n        }\r\n        img.onerror = (err) => {\r\n            reject(err)\r\n        }\r\n        img.src = url\r\n    });\r\n};","import { PARAM } from 'App';\r\nimport { Solution } from './index';\r\n\r\nimport { Vector, zoomOffset, applyBoundaries, draw, loadImage } from './Util';\r\n\r\nexport class CanvasImage {\r\n    solution: Solution;\r\n\r\n    canvas: HTMLCanvasElement;\r\n    statusRendering: Vector;\r\n    statusTarget: Vector = new Vector(200, 200, 4);\r\n\r\n    needInterpolation: boolean = false;\r\n\r\n    img: HTMLImageElement;\r\n    ctx: CanvasRenderingContext2D;\r\n\r\n    speedInterpolation: number = 0.1;\r\n    easingInterpolation: boolean = true;\r\n\r\n    constructor(solution: Solution) {\r\n        this.solution = solution;\r\n\r\n        // refer: https://codepen.io/NJStudio/pen/poZoEgY?editors=0010\r\n        this.canvas = document.createElement('canvas');\r\n        this.canvas.style.background = '#111';\r\n        // this.canvas.style.width = '100%';\r\n        // this.canvas.style.height = '100%';\r\n        this.canvas.width = 1200;\r\n        this.canvas.height = 800;\r\n        solution.div.appendChild(this.canvas);\r\n        this.ctx = this.canvas.getContext('2d')\r\n\r\n        let image\r\n\r\n        this.statusRendering = new Vector(0, 0, 1)\r\n        let statusPre = new Vector(0, 0, 1)\r\n        let status = new Vector(0, 0, 1)\r\n        let isDrag = false\r\n\r\n        this.canvas.addEventListener('mousedown', (e) => {\r\n            const { offsetX, offsetY } = e\r\n            status.x = offsetX\r\n            status.y = offsetY\r\n            isDrag = true;\r\n            // if (status.z > 1) isDrag = true\r\n        });\r\n        this.canvas.addEventListener('mouseup', (e) => {\r\n            if (!isDrag) return\r\n            const { offsetX, offsetY } = e\r\n            const dx = offsetX - status.x\r\n            const dy = offsetY - status.y\r\n            statusPre.x += dx\r\n            statusPre.y += dy\r\n            isDrag = false\r\n        });\r\n        this.canvas.addEventListener('wheel', (e) => {\r\n            const { offsetX, offsetY, deltaY } = e\r\n\r\n            const oy = deltaY < 0 ? 1 : -1\r\n            status.z += (0.2 * oy)\r\n\r\n            if (status.z < 0.2) {\r\n                status.z = 0.2\r\n            } else if (status.z > 5) {\r\n                status.z = 5\r\n            }\r\n\r\n            const { x: zx, y: zy } = zoomOffset(this.canvas, status.z, { x: offsetX, y: offsetY }, statusPre)\r\n            statusPre.x = zx;\r\n            statusPre.y = zy;\r\n            statusPre.z = status.z;\r\n\r\n            this.statusRendering.x = zx;\r\n            this.statusRendering.y = zy;\r\n            this.statusRendering.z = status.z;\r\n\r\n            // draw(ctx, image, this.statusRendering);\r\n        });\r\n        this.canvas.addEventListener('mousemove', (e) => {\r\n            if (!isDrag) return\r\n            const { offsetX, offsetY } = e\r\n            const x = statusPre.x + (offsetX - status.x)\r\n            const y = statusPre.y + (offsetY - status.y)\r\n            const { x: zx, y: zy } = applyBoundaries(this.canvas, statusPre.z, { x, y })\r\n\r\n            this.statusRendering.x = zx;\r\n            this.statusRendering.y = zy;\r\n            this.statusRendering.z = statusPre.z;\r\n            // draw(ctx, image, this.statusRendering)\r\n        });\r\n\r\n        console.log(PARAM.url)\r\n        if (PARAM.url) {\r\n            console.log(PARAM.url)\r\n            loadImage(PARAM.url).then(img => { \r\n                this.img = img as HTMLImageElement;\r\n            });\r\n        } else {\r\n            loadImage().then(img => { \r\n                this.img = img as HTMLImageElement;\r\n                // this.canvas.width = this.img.width;\r\n                // this.canvas.height = this.img.height;\r\n            });\r\n        }\r\n\r\n\r\n        this.render();\r\n\r\n    }\r\n    public render() {\r\n        requestAnimationFrame(() => { this.render(); });\r\n\r\n        if (this.needInterpolation) {\r\n            if (this.easingInterpolation) {\r\n                this.statusRendering = easingMotion(this.statusRendering, this.statusTarget, this.speedInterpolation);\r\n                if (Vector.distance(this.statusRendering, this.statusTarget) < 1) {\r\n                    this.statusRendering.x = this.statusTarget.x\r\n                    this.statusRendering.y = this.statusTarget.y\r\n                    this.statusRendering.z = this.statusTarget.z\r\n                    this.needInterpolation =  false;\r\n                }\r\n            } else {\r\n                this.statusRendering = easingLinear(this.statusRendering, this.statusTarget, this.speedInterpolation);\r\n                // if (Vector.distance(this.statusRendering, this.statusTarget) < 20) {\r\n                if (Vector.distance(this.statusRendering, this.statusTarget) < this.speedInterpolation * 150) {\r\n                    this.statusRendering.x = this.statusTarget.x\r\n                    this.statusRendering.y = this.statusTarget.y\r\n                    this.statusRendering.z = this.statusTarget.z\r\n                    this.needInterpolation =  false;\r\n                }\r\n            }\r\n\r\n\r\n        }\r\n\r\n        draw(this.ctx, this.img, this.statusRendering);\r\n        // draw(this.ctx, this.img)\r\n    }\r\n}\r\n\r\n// https://easings.net/\r\nexport const easingLinear = (v1: Vector, v2: Vector, speed: number = 1) => {\r\n    const v = Vector.subtract(v2, v1);\r\n    v.normalize();\r\n    // const len = v.length()\r\n    // console.log(len)\r\n    return new Vector(\r\n        v1.x + v.x * speed * 150,\r\n        v1.y + v.y * speed * 150,\r\n        v1.z + v.z * speed * 150,\r\n    );\r\n};\r\nexport const easingMotion = (v1: Vector, v2: Vector, speed: number = 1) => {\r\n    const v = Vector.subtract(v2, v1);\r\n    return new Vector(\r\n        v1.x + v.x * speed,\r\n        v1.y + v.y * speed,\r\n        v1.z + v.z * speed,\r\n    );\r\n};","import { Vector } from './Util';\r\nimport { Solution } from './index';\r\n\r\n\r\nexport class Controller {\r\n    solution: Solution;\r\n    div: HTMLDivElement;\r\n    currentIndex = -1;\r\n    timeline: Vector[] = [];\r\n\r\n    divFrameNum: HTMLDivElement;\r\n\r\n    constructor(solution: Solution) {\r\n        this.solution = solution;\r\n\r\n        this.div = document.createElement('div');\r\n        this.solution.div.appendChild(this.div);\r\n\r\n        const setA = document.createElement('div');\r\n        setA.style.display = 'flex';\r\n        this.div.appendChild(setA);\r\n\r\n        const divKeyNew = document.createElement('div');\r\n        setA.appendChild(divKeyNew);\r\n        divKeyNew.textContent = 'Create Key';\r\n        divKeyNew.style.width = '100px';\r\n        divKeyNew.style.color = 'aqua';\r\n        divKeyNew.onclick = () => {\r\n            this.timeline.push(Vector.deepCopy(solution.canvasImage.statusRendering));\r\n            this.currentIndex = this.timeline.length - 1;\r\n\r\n            this.updateFrameNumber();\r\n        }\r\n        const divKeyUpdate = document.createElement('div');\r\n        setA.appendChild(divKeyUpdate);\r\n        divKeyUpdate.textContent = 'Update Key';\r\n        divKeyUpdate.style.width = '100px';\r\n        divKeyUpdate.style.color = 'aqua';\r\n        divKeyUpdate.onclick = () => {\r\n\r\n            this.timeline[this.currentIndex] = Vector.deepCopy(solution.canvasImage.statusRendering);\r\n            // console.log('update frame');\r\n        }\r\n        const divPre = document.createElement('div');\r\n        setA.appendChild(divPre);\r\n        divPre.textContent = '<<<';\r\n        divPre.style.paddingRight = '20px'\r\n        divPre.style.color = 'aqua';\r\n        divPre.onclick = () => {\r\n            // console.log(this.solution.canvasImage.statusRendering);\r\n            this.currentIndex--;\r\n            if (this.currentIndex < 0) {\r\n                this.currentIndex = 0;\r\n            }\r\n            this.updateTarget();\r\n            this.updateFrameNumber();\r\n\r\n        }\r\n        const divPost = document.createElement('div');\r\n        setA.appendChild(divPost);\r\n        divPost.textContent = '>>>';\r\n        divPost.style.color = 'aqua';\r\n        divPost.onclick = () => {\r\n            // console.log(this.solution.canvasImage.statusRendering);\r\n            this.currentIndex++;\r\n            if (this.currentIndex > this.timeline.length - 1) {\r\n                this.currentIndex = this.timeline.length - 1\r\n            }\r\n            this.updateTarget();\r\n            this.updateFrameNumber();\r\n        }\r\n\r\n        const divAni = document.createElement('div');\r\n        this.div.appendChild(divAni);\r\n        divAni.textContent = 'Play';\r\n        // divRotate.style.position = 'absolute';\r\n        divAni.style.color = 'aqua';\r\n        divAni.onclick = () => {\r\n            this.solution.canvasImage.needInterpolation = !this.solution.canvasImage.needInterpolation;\r\n        }\r\n\r\n        let checkBoxUIB = getCheckBox('Easing Interpolation');\r\n        this.div.append(checkBoxUIB.div);\r\n        checkBoxUIB.checkBox.checked = true;\r\n        checkBoxUIB.checkBox.onchange = () => {\r\n            if (checkBoxUIB.checkBox.checked === true) {\r\n                this.solution.canvasImage.easingInterpolation = true;\r\n            } else {\r\n                this.solution.canvasImage.easingInterpolation = false;\r\n            }\r\n        }\r\n\r\n        let slider = getSlider('Speed', '0', '100')\r\n        slider.text.textContent = 'Speed: '\r\n        this.div.append(slider.div);\r\n        slider.slider.oninput = () => {\r\n            const val = +((+slider.slider.value) * 0.001  + 0.03).toFixed(3);\r\n            slider.text.textContent = 'Speed: ' + val;\r\n            this.solution.canvasImage.speedInterpolation = val;\r\n        }\r\n\r\n\r\n        this.divFrameNum = document.createElement('div');\r\n        this.divFrameNum.style.display = 'flex';\r\n        this.div.appendChild(this.divFrameNum);\r\n        this.updateFrameNumber();\r\n\r\n        const paragraph = document.createElement('p');\r\n        paragraph.textContent = 'https://raw.githubusercontent.com/NamjuLee/data/master/img/worldmap/worldMap_03.jpg';\r\n        this.div.append(paragraph);\r\n    }\r\n    public updateFrameNumber() {\r\n        while (this.divFrameNum.lastElementChild) {\r\n            this.divFrameNum.removeChild(this.divFrameNum.lastElementChild);\r\n        }\r\n        for(let i = 0; i < this.timeline.length; ++i) {\r\n            if (this.currentIndex === i) {\r\n                this.divFrameNum.appendChild(getP(i, 'aqua'));\r\n            } else {\r\n                this.divFrameNum.appendChild(getP(i, '#999'));\r\n            }\r\n        }\r\n\r\n    }\r\n    public updateTarget() {\r\n        this.solution.canvasImage.statusTarget = new Vector(\r\n            this.timeline[this.currentIndex].x,\r\n            this.timeline[this.currentIndex].y,\r\n            this.timeline[this.currentIndex].z,\r\n        );\r\n        this.solution.canvasImage.needInterpolation = true;\r\n    }\r\n}\r\n\r\nconst getP = (num: number , col: string) => {\r\n    const p = document.createElement('p')\r\n    p.textContent = ` ${num} `;\r\n    p.style.paddingRight = '10px';\r\n    p.style.color = col\r\n    return p;\r\n}\r\nconst getSlider = (title: string, min: string = '2009', max: string = '2015') => {\r\n    // <input type=\"range\" min=\"1\" max=\"100\" value=\"50\" class=\"slider\" id=\"myRange\">\r\n    const div = document.createElement('div');\r\n    div.style.display = 'flex';\r\n\r\n    const slider = document.createElement('input');\r\n    slider.type = 'range';\r\n    slider.min = min;\r\n    slider.max = max;\r\n\r\n    const text = document.createElement('div');\r\n    text.textContent = title;\r\n    text.style.color = '#aaa';\r\n    div.appendChild(slider);\r\n    div.appendChild(text);\r\n\r\n    return {\r\n        div, slider, text\r\n    }\r\n};\r\nconst getCheckBox = (title: string) => {\r\n    const div = document.createElement('div');\r\n    div.style.display = 'flex';\r\n\r\n    const checkBox = document.createElement('input');\r\n    checkBox.type = 'checkbox';\r\n    checkBox.defaultChecked = false;\r\n    const text = document.createElement('div');\r\n    text.textContent = title;\r\n    text.style.color = '#aaa';\r\n    div.appendChild(checkBox);\r\n    div.appendChild(text);\r\n\r\n    return {\r\n        div, checkBox\r\n    }\r\n};","import { RendererCanvas, getImgFromURL } from '../../../lib'\r\nimport { Vector, draw, zoomOffset, applyBoundaries, loadImage } from './Util';\r\nimport { CanvasImage } from './Canvas';\r\nimport { Controller } from './Controller';\r\nexport class Solution {\r\n    public divHost: HTMLElement;\r\n    // public renderer: Renderer;\r\n    public div: HTMLElement\r\n    public canvasImage: CanvasImage;\r\n    public controller: Controller;\r\n    constructor(divHost: any) {\r\n        this.divHost = divHost;\r\n\r\n        // Center align\r\n        this.divHost.style.display = 'flex';\r\n        this.divHost.style.alignItems = 'center';\r\n\r\n        this.div = document.createElement('div');\r\n        this.divHost.appendChild(this.div);\r\n        this.div.style.marginLeft = 'auto';\r\n        this.div.style.marginRight = 'auto';\r\n        this.div.style.backgroundColor = '#555';\r\n        this.div.style.width = '1000px';\r\n        this.div.style.height = '800px';\r\n\r\n\r\n\r\n        // TODO\r\n        // You code goes here for one time operation\r\n\r\n        this.canvasImage = new CanvasImage(this);\r\n        this.controller = new Controller(this);\r\n\r\n \r\n\r\n\r\n        // this.start();\r\n    }\r\n    public destroy() {\r\n        while (this.divHost.lastElementChild) {\r\n            this.divHost.removeChild(this.divHost.lastElementChild);\r\n        }\r\n    }\r\n}\r\n"],"names":["Vector","x","y","z","this","Math","sqrt","len","v0","v1","v","applyBoundaries","canvas","scale","loadImage","url","Promise","resolve","reject","img","Image","onload","onerror","err","src","CanvasImage","solution","statusRendering","statusTarget","needInterpolation","ctx","speedInterpolation","easingInterpolation","document","createElement","style","background","width","height","div","appendChild","getContext","statusPre","status","isDrag","addEventListener","e","offsetX","offsetY","dx","dy","oy","deltaY","isZooming","newX","abs","newY","zoomOffset","zx","zy","console","log","PARAM","then","render","zooming","requestAnimationFrame","easingMotion","distance","easingLinear","clearRect","save","undefined","translate","drawImage","restore","v2","speed","subtract","normalize","Controller","currentIndex","timeline","divFrameNum","setA","display","divKeyNew","textContent","color","onclick","push","deepCopy","canvasImage","length","updateFrameNumber","divKeyUpdate","divPre","paddingRight","updateTarget","divPost","divAni","checkBoxUIB","getCheckBox","append","checkBox","checked","onchange","slider","getSlider","text","oninput","val","value","toFixed","paragraph","lastElementChild","removeChild","i","getP","num","col","p","title","min","max","type","defaultChecked","Solution","divHost","controller","alignItems","marginLeft","marginRight","backgroundColor"],"sourceRoot":""}