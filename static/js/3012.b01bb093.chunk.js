"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[3012],{13012:function(e,t,r){r.r(t),r.d(t,{Solution:function(){return c}});var s=r(29439),o=r(15671),n=r(43144),i=r(60136),a=r(29388),h=r(17760),u=r(38966),l=r(87968),c=function(e){(0,i.Z)(r,e);var t=(0,a.Z)(r);function r(){var e,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";(0,o.Z)(this,r),(e=t.call(this,s)).streetOSM=[],e.routesTreated=[],e.routesControl=[],e.zones30=[],e.meshStreet=void 0,e.meshSpike=void 0,e.raycaster=new h.iMs,e.pointer=new h.FM8,e.sphere=void 0;var n=new h.cek(16777215,.8);e.camera.add(n),e.scene.add(n),e.raycaster=new h.iMs,e.raycaster.params.Line.threshold=3,e.raycaster.far=1e3;var i=new h.xo$(.2,32,32),a=new h.vBJ({color:16777215}),u=new h.Kj0(i,a);e.sphere=u,e.scene.add(u),e.camera.position.set(0,20,20);var c="/static/research/slow-zone/";return(0,l.getJSONFromURL)("/njs-lab-public"+c+"street_osm.geojson").then((function(t){for(var r=0;r<t.features.length;++r)e.streetOSM.push(t.features[r].geometry.coordinates);e.meshStreet=m(e.scene,e.streetOSM,[0,1,1]),(0,l.getJSONFromURL)("/njs-lab-public"+c+"treated-st.geojson").then((function(t){for(var r=0;r<t.features.length;++r)e.routesTreated.push(t.features[r].geometry.coordinates);e.meshSpike=p(e.scene,e.routesTreated,[1,0,0])})),(0,l.getJSONFromURL)("/njs-lab-public"+c+"control-st.geojson").then((function(t){for(var r=0;r<t.features.length;++r)e.routesControl.push(t.features[r].geometry.coordinates);m(e.scene,e.routesControl,[0,1,0])})),e.start()})),e}return(0,n.Z)(r,[{key:"update",value:function(e){this.raycaster.setFromCamera(this.pointer,this.camera);var t=this.raycaster.intersectObjects([this.meshStreet,this.meshSpike],!0);t.length>0?(this.sphere.visible=!0,this.sphere.position.copy(t[0].point)):this.sphere.visible=!1;for(var r=1;r<this.meshSpike.geometry.attributes.position.count;r+=2){var s=this.meshSpike.geometry.attributes.position,o=s.getX(r),n=s.getY(r),i=s.getZ(r);n=(n=9*Math.sin(5*o*i+5*this.t))<0?0:n;var a=new h.Pa4(o,n,i);this.meshSpike.geometry.attributes.position.setXYZ(r,a.x,a.y,a.z);(0,l.getColorByCelsius)(40*n);this.meshSpike.geometry.attributes.color.setXYZ(r-1,0,n,0),this.meshSpike.geometry.attributes.color.setXYZ(r,n,0,0)}this.meshSpike.geometry.attributes.position.needsUpdate=!0,this.meshSpike.geometry.attributes.color.needsUpdate=!0,this.meshSpike.geometry.computeVertexNormals()}},{key:"mouseMove",value:function(e){this.pointer.x=(e.offsetX+2)/this.hostDiv.clientWidth*2-1,this.pointer.y=-(e.offsetY-70)/this.hostDiv.clientHeight*2+1}}]),r}(u.TF),p=function(e,t,r){for(var o=new h.u9r,n=new h.nls({vertexColors:!0}),i=[],a=[],l=0,c=0,p=0,m=0;m<t.length;++m)for(var g=t[m],v=0;v<g.length;++v)for(var f=0;f<g[v].length;++f){var d=(0,u._Y)(g[v][f][0],g[v][f][1]),S=(0,s.Z)(d,2),b=S[0],y=S[1];l+=b,c+=y,p+=1;var w=.01*(b+-15478803.88731685),k=.01*(y+-4766681.448690384);i.push(w,0,k),i.push(w,10,k),a.push(r[0],r[1],r[2]),a.push(r[0],r[1],r[2])}console.log(l/p,c/p),o.setAttribute("position",new h.a$l(i,3)),o.setAttribute("color",new h.a$l(a,3)),o.computeBoundingSphere();var j=new h.ejS(o,n);return e.add(j),j},m=function(e,t,r){for(var o=new h.u9r,n=new h.nls({vertexColors:!0}),i=[],a=[],l=[],c=0,p=0,m=0,g=0;g<t.length;++g)for(var v=t[g],f=0;f<v.length;++f)for(var d=0;d<v[f].length;++d){var S=(0,u._Y)(v[f][d][0],v[f][d][1]),b=(0,s.Z)(S,2),y=b[0],w=b[1];c+=y,p+=w,m+=1;var k=.01*(y+-15478803.88731685),j=.01*(w+-4766681.448690384);i.push(k,0,j),a.push(r[0],r[1],r[2]),d<v[f].length-1&&l.push(Math.floor(i.length/3)-1,Math.floor(i.length/3))}console.log(c/m,p/m),o.setIndex(l),o.setAttribute("position",new h.a$l(i,3)),o.setAttribute("color",new h.a$l(a,3)),o.computeBoundingSphere();var C=new h.ejS(o,n);return e.add(C),C}}}]);
//# sourceMappingURL=3012.b01bb093.chunk.js.map