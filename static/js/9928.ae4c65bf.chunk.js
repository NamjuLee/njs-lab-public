"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[9928],{49928:function(e,i,t){t.r(i),t.d(i,{AppTFEnv:function(){return Y}});var o=t(15671),n=t(43144),r=t(3156),s=function(){function e(i){(0,o.Z)(this,e),this.model=void 0,this.x=-1,this.y=-1,this.z=-1,this.preX=-1,this.preY=-1,this.preZ=-1,this.yGLPicking=void 0,this.command=void 0,this.CLICK_TYPE=r.uh.MOVE,this.isDown=!1,this.isDoubleClick=!1,this.isMove=!1,this.pressedShift=!1,this.pressedAlt=!1,this.pressedCtrl=!1,this.lat=-1,this.long=-1,this.wheel=0,this.preWheel=0,this.isActive=!0,this.native=void 0,null!==i&&void 0!==i&&(this.model=i)}return(0,n.Z)(e,[{key:"DeepCopy",value:function(){var i=new e(this.model);return i.x=this.x,i.y=this.y,i.z=this.z,i.preX=this.preX,i.preY=this.preY,i.preZ=this.preZ,i.pressedAlt=this.pressedAlt,i.pressedShift=this.pressedShift,i.pressedCtrl=this.pressedCtrl,i.isDoubleClick=this.isDoubleClick,i.isDown=this.isDown,i.isMove=this.isMove,i.lat=this.lat,i.long=this.long,i.wheel=this.wheel,i.preWheel=this.preWheel,i.yGLPicking=this.yGLPicking,i.CLICK_TYPE=this.CLICK_TYPE,i.command=this.command,i.native=this.native,i}}]),e}(),h=function(){function e(i){(0,o.Z)(this,e),this.mouseInteractionUI=void 0,this.mouseEventDataPre=new s,this.model=void 0,this.isEnable=!0,this.clickCount=0,this.click=!1,this.prevent=!1,this.delay=250,this.timer=void 0,this.down=!1,this.e=void 0,this._stopPropagation=!1,this.model=i}return(0,n.Z)(e,[{key:"InitNativeMouseEvent",value:function(e){var i=this;e.onclick=function(e){i.prevent=!1,i.timer=setTimeout((function(){i.prevent||i.MouseClick(e),i.prevent=!1}),i.delay)},e.ondblclick=function(e){clearTimeout(i.timer),i.prevent=!0,i.MouseDoubleClick(e)},e.onmousedown=function(e){i.MouseDown(e)},e.onmouseup=function(e){i.MouseUp(e)},e.onmousemove=function(e){i.MouseMove(e)},e.addEventListener("wheel",(function(e){return i.MouseWheel(e,e.deltaY)}))}},{key:"MouseDown",value:function(e){this.click=!0,this.down=!0;var i=this.CommonEventBuilder(e);i.CLICK_TYPE=r.uh.DOWN,i.isDown=!0,this.MouseEvenEmitting(i)}},{key:"MouseClick",value:function(e){if(this.click){var i=this.CommonEventBuilder(e);0===e.button?i.CLICK_TYPE=r.uh.LEFT:1===e.button?i.CLICK_TYPE=r.uh.MIDDLE:2===e.button&&(i.CLICK_TYPE=r.uh.RIGHT),this.MouseEvenEmitting(i)}}},{key:"MouseDoubleClick",value:function(e){var i=this.CommonEventBuilder(e);i.CLICK_TYPE=r.uh.DOUBLE,this.MouseEvenEmitting(i)}},{key:"MouseDrag",value:function(e){this.click=!1,this.prevent=!0;var i=this.CommonEventBuilder(e);i.CLICK_TYPE=r.uh.DRAG,i.isDown=!0,1===e.buttons?i.CLICK_TYPE=r.uh.DRAG:4===e.buttons?i.CLICK_TYPE=r.uh.DRAG_MIDDLE:2===e.buttons&&(i.CLICK_TYPE=r.uh.DRAG_RIGHT),this.MouseEvenEmitting(i)}},{key:"MouseMove",value:function(e){if(this.down)this.MouseDrag(e);else{var i=this.CommonEventBuilder(e);i.CLICK_TYPE=r.uh.MOVE,i.isDown=!0,this.prevent=!0,this.MouseEvenEmitting(i)}}},{key:"MouseUp",value:function(e){this.down=!1,this.click=!0;var i=this.CommonEventBuilder(e);i.CLICK_TYPE=r.uh.UP,i.isDown=!1,this.MouseEvenEmitting(i)}},{key:"MouseWheel",value:function(e,i){var t=this.CommonEventBuilder(e);t.wheel=i,t.CLICK_TYPE=r.uh.WHEEL,this.MouseEvenEmitting(t)}},{key:"CommonEventBuilder",value:function(e){var i=new s(this.model);return i.preX=this.mouseEventDataPre.x,i.preY=this.mouseEventDataPre.y,i.pressedShift=e.shiftKey,i.pressedAlt=e.altKey,i.pressedCtrl=e.ctrlKey,i.x=e.offsetX,i.y=e.offsetY,i.preWheel=this.mouseEventDataPre.wheel,i.wheel=0,i.native=e,this.mouseEventDataPre=i,this.e=i,i}},{key:"stopPropagation",get:function(){return this._stopPropagation},set:function(e){var i=this;e?this._stopPropagation=e:setTimeout((function(){i._stopPropagation=e}),500)}},{key:"MouseEvenEmitting",value:function(e){this.MouseEventEmittingForViewController(e),this._stopPropagation||this.MouseEventEmittingForModel(e)}},{key:"MouseEventEmittingForViewController",value:function(e){this.mouseInteractionUI&&this.mouseInteractionUI.MouseInteractionMenu(e)}},{key:"MouseEventEmittingForModel",value:function(e){e.model.controllerCoreWrapper.activeCommandController.MouseEventController(e)}}]),e}(),a=function(){function e(i){(0,o.Z)(this,e),this.appCoreWrapper=void 0,this.mouseInteraction=void 0,this.appCoreWrapper=i,this.mouseInteraction=new h(this.appCoreWrapper.model)}return(0,n.Z)(e,[{key:"InitEventListener",value:function(e){this.mouseInteraction.InitNativeMouseEvent(e),this.Resize()}},{key:"Resize",value:function(){var e=this;window.addEventListener("resize",(function(i){return e.ReSizeWindow(i)}))}},{key:"ReSizeWindow",value:function(e){var i=this.appCoreWrapper.model.modelViewCoreWrapper.viewWrapper.divHost;this.appCoreWrapper.model.graphicsCoreWrapper.canvasWrapper.canvas.ResizeCanvas(i.clientWidth,i.clientHeight)}}]),e}(),p=(0,n.Z)((function e(i,t){(0,o.Z)(this,e),this.model=void 0,this.appProperties=void 0,this.appAccessibility=void 0,this.browserUtility=void 0,this.ioWrapper=void 0,this.model=i,this.appProperties=new r.gj,this.browserUtility=new r.R7,this.ioWrapper=new a(this)})),u=function(){function e(i){(0,o.Z)(this,e),this.controllerCoreWrapper=void 0,this.controllerCoreWrapper=i}return(0,n.Z)(e,[{key:"MouseEventController",value:function(e){this.controllerCoreWrapper.model.graphicsCoreWrapper.sceneWrapper.MouseEventController(e),e.CLICK_TYPE!==r.uh.LEFT?e.CLICK_TYPE!==r.uh.MIDDLE?e.CLICK_TYPE!==r.uh.DOWN_RIGHT?e.CLICK_TYPE!==r.uh.DOUBLE?e.CLICK_TYPE!==r.uh.MOVE?e.CLICK_TYPE!==r.uh.DRAG?e.CLICK_TYPE!==r.uh.DOWN?e.CLICK_TYPE!==r.uh.WHEEL?e.CLICK_TYPE!==r.uh.UP||this.MouseUpPre(e):this.MouseWheelPre(e):this.MouseDownPre(e):this.MouseDragPre(e):this.MouseMovePre(e):this.MouseDoubleClickPre(e):this.MouseRightClickPre(e):this.MouseMiddleClickPre(e):this.MouseLeftClickPre(e)}},{key:"MouseDown",value:function(e){}},{key:"MouseDownPre",value:function(e){this.MouseDown(e)}},{key:"MouseLeftClick",value:function(e){}},{key:"MouseLeftClickPre",value:function(e){this.MouseLeftClick(e)}},{key:"MouseMiddleClick",value:function(e){}},{key:"MouseMiddleClickPre",value:function(e){this.MouseMiddleClick(e)}},{key:"MouseRightClick",value:function(e){}},{key:"MouseRightClickPre",value:function(e){this.MouseRightClick(e)}},{key:"MouseUp",value:function(e){}},{key:"MouseUpPre",value:function(e){this.MouseUp(e)}},{key:"MouseDoubleClick",value:function(e){}},{key:"MouseDoubleClickPre",value:function(e){this.MouseDoubleClick(e)}},{key:"MouseMove",value:function(e){}},{key:"MouseMovePre",value:function(e){this.MouseMove(e)}},{key:"MouseDrag",value:function(e){}},{key:"MouseDragPre",value:function(e){this.MouseDrag(e)}},{key:"MouseWheel",value:function(e){}},{key:"MouseWheelPre",value:function(e){this.MouseWheel(e)}},{key:"ShfitScene",value:function(e){this.controllerCoreWrapper.model.graphicsCoreWrapper.sceneWrapper.ShiftScene(e)}},{key:"RemoveScene",value:function(){this.controllerCoreWrapper.model.graphicsCoreWrapper.sceneWrapper.RemoveAllScene()}},{key:"LoadDefinition",value:function(e){this.controllerCoreWrapper.model.graphicsCoreWrapper.sceneWrapper.LoadDefinition(e)}},{key:"Test",value:function(){}}]),e}(),v=function(){function e(i){(0,o.Z)(this,e),this.model=void 0,this.activeCommandController=void 0,this.model=i,this.activeCommandController=new u(this)}return(0,n.Z)(e,[{key:"SetActiveCommand",value:function(e){}}]),e}(),l=function(){function e(i,t){(0,o.Z)(this,e),this.canvasWrapper=void 0,this.hostDiv=void 0,this.canvas=void 0,this.ctx=void 0,this.canvasWrapper=i,this.hostDiv=t,this.InitCanvas(this.hostDiv)}return(0,n.Z)(e,[{key:"InitCanvas",value:function(e){this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.zIndex="0",this.hostDiv=e,this.hostDiv.appendChild(this.canvas),this.canvas.id="CanvasRenderer",this.canvas.className="njslab-web-core-canvas-renderer",this.canvas.style.pointerEvents="none",this.ctx=this.canvas.getContext("2d"),this.canvas.width=this.hostDiv.clientWidth,this.canvas.height=this.hostDiv.clientHeight}},{key:"ResizeCanvas",value:function(e,i){this.canvas.width=e,this.canvas.height=i}}]),e}(),c=(0,n.Z)((function e(i){(0,o.Z)(this,e),this.graphicsCoreWrapper=void 0,this.canvas=void 0,this.graphicsCoreWrapper=i,this.canvas=new l(this,this.graphicsCoreWrapper.model.modelViewCoreWrapper.viewWrapper.div)})),d=(0,n.Z)((function e(i){(0,o.Z)(this,e),this.graphicsCoreWrapper=void 0,this.graphicsCoreWrapper=i})),C=function(){function e(i){(0,o.Z)(this,e),this.rendererWrapper=void 0,this.isActive=!0,this.msLastFrame=0,this.msFpsLimit=30,this.deltatime=void 0,this.ctx=void 0,this.sceneWrapper=void 0,this.rendererWrapper=i,this.Init()}return(0,n.Z)(e,[{key:"Init",value:function(){this.ctx=this.rendererWrapper.graphicsCoreWrapper.canvasWrapper.canvas.ctx,this.deltatime=new r.gk,this.Loop()}},{key:"Loop",value:function(){var e=this;this.isActive&&(requestAnimationFrame((function(){e.Loop()})),this.OnRender())}},{key:"OnRender",value:function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.deltatime.UpdateFPS(),this.sceneWrapper&&this.sceneWrapper.Render(this.ctx)}},{key:"Stop",value:function(){this.isActive=!1}}]),e}(),f=(0,n.Z)((function e(i){(0,o.Z)(this,e),this.renderer=void 0,this.graphicsCoreWrapper=void 0,this.graphicsCoreWrapper=i,this.renderer=new C(this)})),m=(0,n.Z)((function e(i){(0,o.Z)(this,e),this.graphicsCoreWrapper=void 0,this.graphicsCoreWrapper=i})),W=function(){function e(i){(0,o.Z)(this,e),this.graphicsCoreWrapper=void 0,this.graphicsCoreWrapper=i,this.graphicsCoreWrapper.rendererWrapper.renderer.sceneWrapper=this}return(0,n.Z)(e,[{key:"MouseEventController",value:function(e){this.graphicsCoreWrapper.model.app.implementation.MouseEventController(e)}},{key:"Render",value:function(e){this.graphicsCoreWrapper.model.app.implementation.Render(e)}},{key:"RemoveAllScene",value:function(){this.graphicsCoreWrapper.model.app.implementation.RemoveAllScene()}},{key:"ShiftScene",value:function(e){this.graphicsCoreWrapper.model.app.implementation.ShiftScene(e)}},{key:"LoadDefinition",value:function(e){this.graphicsCoreWrapper.model.app.implementation.LoadDefinition(e)}}]),e}(),w=(0,n.Z)((function e(i){(0,o.Z)(this,e),this.model=void 0,this.canvasWrapper=void 0,this.geometryCoreWrapper=void 0,this.rendererWrapper=void 0,this.themeWrapper=void 0,this.sceneWrapper=void 0,this.model=i,this.canvasWrapper=new c(this),this.geometryCoreWrapper=new d(this),this.rendererWrapper=new f(this),this.themeWrapper=new m(this),this.sceneWrapper=new W(this)})),k=(0,n.Z)((function e(i){(0,o.Z)(this,e),this.modelViewCoreWrapper=void 0,this.modelViewCoreWrapper=i})),y=(0,n.Z)((function e(i){(0,o.Z)(this,e),this.modelViewCoreWrapper=void 0,this.modelViewCoreWrapper=i})),g=function(){function e(i,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;(0,o.Z)(this,e),this.modelViewCoreWrapper=void 0,this.divHost=void 0,this.div=void 0,this.modelViewCoreWrapper=i,this.InitDiv(t,n,r),this.AppendEvent()}return(0,n.Z)(e,[{key:"InitDiv",value:function(e,i,t){var o=document.createElement("div");o.style.position="absolute",this.div=document.createElement("div"),o.appendChild(this.div);var n=document.getElementById(e);n&&(this.divHost=n,this.divHost.parentNode&&this.divHost.appendChild(o)),this.div.id="NCanvas",this.div.style.width=this.divHost.clientWidth+"px",this.div.style.height=this.divHost.clientHeight+"px",this.div.style.zIndex="1"}},{key:"AppendEvent",value:function(){var e=this;window.addEventListener("resize",(function(){e.div.style.width=e.divHost.clientWidth+"px",e.div.style.height=e.divHost.clientHeight+"px"}),!0)}}]),e}(),E=(0,n.Z)((function e(i,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;(0,o.Z)(this,e),this.model=void 0,this.logWrapper=void 0,this.uiWrapper=void 0,this.viewWrapper=void 0,this.model=i,this.logWrapper=new k(this),this.uiWrapper=new y(this),this.viewWrapper=new g(this,t,n,r)})),M=function(){function e(i,t){(0,o.Z)(this,e),this.app=void 0,this.appCoreWrapper=void 0,this.controllerCoreWrapper=void 0,this.graphicsCoreWrapper=void 0,this.modelViewCoreWrapper=void 0,this.app=i,this.appCoreWrapper=new p(this,t),this.modelViewCoreWrapper=new E(this,t),this.controllerCoreWrapper=new v(this),this.graphicsCoreWrapper=new w(this),this.Init()}return(0,n.Z)(e,[{key:"Init",value:function(){this.appCoreWrapper.ioWrapper.InitEventListener(this.modelViewCoreWrapper.viewWrapper.div)}},{key:"Restart",value:function(){}},{key:"Destroy",value:function(){this.graphicsCoreWrapper.rendererWrapper.renderer.isActive=!1}},{key:"Resize",value:function(e,i){this.graphicsCoreWrapper.canvasWrapper.canvas.ResizeCanvas(e,i),this.modelViewCoreWrapper.viewWrapper.div.style.width=e+"px",this.modelViewCoreWrapper.viewWrapper.div.style.height=i+"px"}}]),e}(),I=t(74165),P=t(15861),D=function(){function e(i){(0,o.Z)(this,e),this.app=void 0,this.tfProject=void 0,this.SceneVisMapArchGIS=void 0,this.app=i,this.InitProjects()}return(0,n.Z)(e,[{key:"InitProjects",value:function(){var e=(0,P.Z)((0,I.Z)().mark((function e(){var i=this;return(0,I.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([t.e(386),t.e(3053)]).then(t.bind(t,13053)).then((function(e){var t=e.TFProject;i.tfProject=new t(i)})).catch((function(e){})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"MouseEventController",value:function(e){this.tfProject&&this.tfProject.activeCommandController.MouseEventController(e)}},{key:"Render",value:function(e){this.tfProject&&this.tfProject.Render(e)}},{key:"RemoveAllScene",value:function(){this.tfProject&&this.tfProject.Dispose(),this.tfProject=void 0}},{key:"ShiftScene",value:function(e){}},{key:"LoadDefinition",value:function(e){this.tfProject&&this.tfProject.LoadDefinition(e)}}]),e}(),Z=function(){function e(i){(0,o.Z)(this,e),this.viewIO=void 0,this._propagation=!1,this.viewIO=i,this.viewIO.viewAppCoreWrapper.viewController.app.model.appCoreWrapper.ioWrapper.mouseInteraction.mouseInteractionUI=this}return(0,n.Z)(e,[{key:"MouseInteractionMenu",value:function(e){this.viewIO.viewAppCoreWrapper.viewController.NUIWrapper.NUI.MouseInteractionMenu(e)}},{key:"stopPropagation",get:function(){return this._propagation},set:function(e){this.viewIO.viewAppCoreWrapper.viewController.app.model.appCoreWrapper.ioWrapper.mouseInteraction.stopPropagation=e,this._propagation=e}}]),e}(),L=(0,n.Z)((function e(i){(0,o.Z)(this,e),this.viewAppCoreWrapper=void 0,this.eventInteraction=void 0,this.viewAppCoreWrapper=i,this.eventInteraction=new Z(this)})),R=(0,n.Z)((function e(i){(0,o.Z)(this,e),this.viewController=void 0,this.viewIOWrapper=void 0,this.viewController=i,this.viewIOWrapper=new L(this)})),A=(0,n.Z)((function e(i){(0,o.Z)(this,e),this.viewController=void 0,this.viewController=i})),_=function(){function e(i){(0,o.Z)(this,e),this.viewControllerWrapper=void 0,this.viewControllerWrapper=i}return(0,n.Z)(e,[{key:"Resize",value:function(e,i){this.viewControllerWrapper.viewController.NUIWrapper.Resize(e,i)}}]),e}(),T=(0,n.Z)((function e(i){(0,o.Z)(this,e),this.viewController=void 0,this.viewActiveCommandController=void 0,this.viewController=i,this.viewActiveCommandController=new _(this)})),b=function(){function e(i,t){(0,o.Z)(this,e),this.NUI=void 0,this.viewController=void 0,this.viewController=i,this.NUI=new r.Fc(this.viewController.app.model.modelViewCoreWrapper.viewWrapper.div,t),this.BindingActiveCommandController()}return(0,n.Z)(e,[{key:"BindingActiveCommandController",value:function(){this.NUI.BindingActiveCommandController("NTF",this.viewController.app.model.controllerCoreWrapper.activeCommandController)}},{key:"Resize",value:function(e,i){this.NUI.Resize(e,i)}},{key:"Destroy",value:function(){this.NUI.Destroy()}}]),e}(),U=function(){function e(i,t){(0,o.Z)(this,e),this.app=void 0,this.viewAppCoreWrapper=void 0,this.viewAssetWrapper=void 0,this.viewControllerWrapper=void 0,this.NUIWrapper=void 0,this.app=i,this.viewAssetWrapper=new A(this),this.viewAppCoreWrapper=new R(this),this.viewControllerWrapper=new T(this),this.NUIWrapper=new b(this,t)}return(0,n.Z)(e,[{key:"Resize",value:function(e,i){this.viewControllerWrapper.viewActiveCommandController.Resize(e,i)}},{key:"Destroy",value:function(){this.NUIWrapper.Destroy()}}]),e}(),Y=function(){function e(i){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(0,o.Z)(this,e),this.viewController=void 0,this.model=void 0,this.implementation=void 0,this.needUI=!1,this.divHost=void 0,this.needUI=t;var n=document.getElementById(i);n&&(this.divHost=n),this.model=new M(this,i),this.implementation=new D(this),this.viewController=new U(this,t)}return(0,n.Z)(e,null,[{key:"InitSubApp",value:function(i,t){var o=new e(i,!1);o.implementation.InitProjects().then((function(){o.implementation.tfProject.LoadDefinition(t)}))}},{key:"Init",value:function(i){new e(i)}}]),e}()},3156:function(e,i,t){t.d(i,{gj:function(){return o.gj},R7:function(){return o.R7},uh:function(){return o.uh},gk:function(){return o.gk},$H:function(){return o.$H},Fc:function(){return o.Fc},h9:function(){return o.h9}});var o=t(9936)}}]);
//# sourceMappingURL=9928.ae4c65bf.chunk.js.map