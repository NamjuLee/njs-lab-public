"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[5893,6818],{45893:function(t,e,i){i.r(e),i.d(e,{AppSmartDrawing:function(){return o}});var s=i(86818),r=i(87968);class o{constructor(t){this.rendererCanvas=void 0,this.smartDrawing=void 0,this.vec=[],this.divHost=void 0,this.divText=void 0,this.render=t=>{for(let e=0;e<this.vec.length;++e)t.fillStyle="rgba(255, 0, 0, 0.15)",t.beginPath(),t.arc(this.vec[e][0],this.vec[e][1],5,0,2*Math.PI),t.closePath(),t.fill()},this.mouseDrag=(t,e)=>{this.vec.push([t,e])},this.mouseUp=(t,e)=>{this.Predict(this.vec),this.vec=[]},this.divHost=document.getElementById(t);const e=document.createElement("div");this.divHost.appendChild(e),e.style.alignItems="center",e.style.marginTop="80px",e.style.marginLeft="auto",e.style.marginRight="auto",e.style.width="300px",e.style.height="400px",this.smartDrawing=new s.SmartDrawing,this.rendererCanvas=new r.RendererCanvas(e),this.rendererCanvas.canvas.style.position="unset",this.rendererCanvas.canvas.width=300,this.rendererCanvas.canvas.height=300,this.rendererCanvas.canvas.style.background="#999",this.divText=document.createElement("div"),this.divText.textContent="*** FROM DEEP LEARNING MODEL B ***",e.append(this.divText),this.rendererCanvas.start(),this.rendererCanvas.render=t=>this.render(t),this.rendererCanvas.mouseDrag=(t,e)=>this.mouseDrag(t,e),this.rendererCanvas.mouseUp=(t,e)=>this.mouseUp(t,e)}Predict(t){const e=[];for(let n of t)e.push(new r.Vector3(n[0],n[1],0));const i=n(e),s=(0,r.getInterpolatedArray)(i,501),o=this.smartDrawing.predictByLogisticRegression(s);console.debug("pridiction:%c ".concat(o," from LR Model"),"background: #ddb137; color: black");const[a,c]=this.smartDrawing.predictByMultiClassification(s);return console.debug("pridiction:%c ".concat(a," from MC model"),"background: #4e2c7e; color: white"),this.updateDivWithText(c),a}updateDivWithText(t){let e="<p>*** FROM DEEP LEARNING MODEL B *** </p>";for(let i=0;i<t.length;++i)e+="<p> ".concat(t[i],"</p>");this.divText.innerHTML=e}destroy(){try{for(;void 0!==this.divHost&&void 0!==this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}catch(t){}}}const n=t=>{let e=[];for(let i=0;i<t.length;++i)if(i<t.length-1){let s=new r.Vector3(t[i].x,t[i].y,t[i].z),o=new r.Vector3(t[i+1].x,t[i+1].y,t[i+1].z);o.x-=s.x,o.y-=s.y,o.z-=s.z;let n=(0,r.dotProduct)(new r.Vector3(1,0,0),(0,r.normalize)(o));Number.isNaN(n)?e.push(e[e.length-1]):e.push(n)}else{let s=new r.Vector3(t[i].x,t[i].y,t[i].z),o=new r.Vector3(t[0].x,t[0].y,t[0].z);o.x-=s.x,o.y-=s.y,o.z-=s.z;let n=(0,r.dotProduct)(new r.Vector3(1,0,0),(0,r.normalize)(o));Number.isNaN(n)?e.push(e[e.length-1]):e.push(n)}return e}},86818:function(t,e,i){i.r(e),i.d(e,{SmartDrawing:function(){return r}});var s=i(816);class r{constructor(){this.modelLogisticRegression=void 0,this.modelMultiClassification=void 0,this.isLoaded=!1,o().then((t=>{[this.modelLogisticRegression,this.modelMultiClassification]=t,this.isLoaded=!0}))}predictByLogisticRegression(t){if(void 0!==this.modelLogisticRegression)return(0,s.lub)((()=>{const e=(0,s.odF)([t]),i=this.modelLogisticRegression.predict(e).dataSync();return this.PredictionPostProcessingLogisticRegression(i[0])}));console.error("no model loaded")}PredictionPostProcessingLogisticRegression(t){const e=Math.floor(t+.5);return r.CLASS_TYPE[e]}predictByMultiClassification(t){if(void 0!==this.modelMultiClassification)return(0,s.lub)((()=>{const e=s.odF([t]),i=this.modelMultiClassification.predict(e),o=[];{const t=Array.from(i.dataSync()),e=n(t);for(let i of e){const e=t[i],s="class:"+r.CLASS_TYPE[i]+", probability:"+e.toFixed(5);o.push(s)}}const a=i.argMax(-1).dataSync()[0];return[r.CLASS_TYPE[a],o]}));console.error("no model loaded")}}r.CLASS_TYPE={0:"CIRCLE",1:"TRI-GON",2:"ARROW_SINGLE",3:"ARROW_DOUBLE",4:"RECTANGLE",5:"TEXT",6:"CURVE",7:"HEART",8:"CLOUD"};const o=async()=>{let t="https://raw.githubusercontent.com/NamjuLee/data/master/smart-drawing/model/modelLogisticRegression0/model.json";const e=await(0,s.FBF)(t);t="https://raw.githubusercontent.com/NamjuLee/data/master/smart-drawing/model/modelMultiClassification0/model.json";return[e,await(0,s.FBF)(t)]},n=t=>{const e=new Array(t.length);for(let i=0;i<t.length;++i)e[i]=i;return e.sort(((e,i)=>t[e]>t[i]?-1:t[e]<t[i]?1:0)),e}}}]);
//# sourceMappingURL=5893.41c3db9e.chunk.js.map