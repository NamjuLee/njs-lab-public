/*! For license information please see 4294.85f9687a.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[4294],{85854:function(t,e,n){n.d(e,{$s:function(){return A},BH:function(){return l},L:function(){return r},LL:function(){return v},P0:function(){return u},Sg:function(){return d},ZR:function(){return y},aH:function(){return h},eu:function(){return g},hl:function(){return p},m9:function(){return _},ru:function(){return f},vZ:function(){return E},zI:function(){return m}});const s=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296===(64512&i)&&s+1<t.length&&56320===(64512&t.charCodeAt(s+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++s)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},i={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<t.length;i+=3){const e=t[i],r=i+1<t.length,o=r?t[i+1]:0,a=i+2<t.length,c=a?t[i+2]:0,u=e>>2,h=(3&e)<<4|o>>4;let l=(15&o)<<2|c>>6,d=63&c;a||(d=64,r||(l=64)),s.push(n[u],n[h],n[l],n[d])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,s=0;for(;n<t.length;){const i=t[n++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=t[n++];e[s++]=String.fromCharCode((31&i)<<6|63&r)}else if(i>239&&i<365){const r=((7&i)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[s++]=String.fromCharCode(55296+(r>>10)),e[s++]=String.fromCharCode(56320+(1023&r))}else{const r=t[n++],o=t[n++];e[s++]=String.fromCharCode((15&i)<<12|(63&r)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<t.length;){const e=n[t.charAt(i++)],r=i<t.length?n[t.charAt(i)]:0;++i;const o=i<t.length?n[t.charAt(i)]:64;++i;const a=i<t.length?n[t.charAt(i)]:64;if(++i,null==e||null==r||null==o||null==a)throw Error();const c=e<<2|r>>4;if(s.push(c),64!==o){const t=r<<4&240|o>>2;if(s.push(t),64!==a){const t=o<<6&192|a;s.push(t)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},r=function(t){return function(t){const e=s(t);return i.encodeByteArray(e,!0)}(t).replace(/\./g,"")},o=function(t){try{return i.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};const a=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,c=()=>{try{return a()||(()=>{if("undefined"===typeof process)return;const t={NODE_ENV:"production",PUBLIC_URL:"/njs-lab-public",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_OPEN_WEATHER_MAP_API_KEY:"bd30a8d327da510a2972cbbec887a1e2",REACT_APP_FIREBASE_API_KEY:"AIzaSyAsGNHXVPsIjOJA5eY5XY8sLEF11ispMJg",REACT_APP_FIREBASE_DOMAIN:"njs-lab.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"njs-lab",REACT_APP_FIREBASE_STORAGE_BUCKET:"njs-lab.appspot.com",REACT_APP_FIREBASE_MEASUREMENT_SENDER_ID:"438027774199",REACT_APP_FIREBASE_APP_ID:"1:438027774199:web:d12c3a33744a9d411a8bf2",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-VH51C7700D"}.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"===typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const e=t&&o(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(t))}},u=t=>{const e=(t=>{var e,n;return null===(n=null===(e=c())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]})(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error("Invalid host ".concat(e," with no separate hostname and port!"));const s=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),s]:[e.substring(0,n),s]},h=()=>{var t;return null===(t=c())||void 0===t?void 0:t.config};class l{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"===typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function d(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[r(JSON.stringify({alg:"none",type:"JWT"})),r(JSON.stringify(o)),""].join(".")}function f(){const t="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof t&&void 0!==t.id}function p(){try{return"object"===typeof indexedDB}catch(t){return!1}}function g(){return new Promise(((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(n){e(n)}}))}function m(){return!("undefined"===typeof navigator||!navigator.cookieEnabled)}class y extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,y.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,v.prototype.create)}}class v{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t){const e=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(t),s=this.errors[t],i=s?function(t,e){return t.replace(w,((t,n)=>{const s=e[n];return null!=s?String(s):"<".concat(n,"?>")}))}(s,e):"Error",r="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new y(n,r,e)}}const w=/\{\$([^}]+)}/g;function E(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const i of n){if(!s.includes(i))return!1;const n=t[i],r=e[i];if(b(n)&&b(r)){if(!E(n,r))return!1}else if(n!==r)return!1}for(const i of s)if(!n.includes(i))return!1;return!0}function b(t){return null!==t&&"object"===typeof t}const T=1e3,I=2,S=144e5,C=.5;function A(t){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:I;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:T)*Math.pow(e,t),s=Math.round(C*n*(Math.random()-.5)*2);return Math.min(S,n+s)}function _(t){return t&&t._delegate?t._delegate:t}},89474:function(t,e,n){n.d(e,{Jn:function(){return b},KN:function(){return S},Mq:function(){return I},Xd:function(){return m},ZF:function(){return T},qX:function(){return y}});var s=n(23258),i=n(6781),r=n(85854),o=n(59073);class a{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null===e||void 0===e?void 0:e.type)}(t)){const e=t.getImmediate();return"".concat(e.library,"/").concat(e.version)}return null})).filter((t=>t)).join(" ")}}const c="@firebase/app",u="0.9.3",h=new i.Yd("@firebase/app"),l="[DEFAULT]",d={[c]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},f=new Map,p=new Map;function g(t,e){try{t.container.addComponent(e)}catch(n){h.debug("Component ".concat(e.name," failed to register with FirebaseApp ").concat(t.name),n)}}function m(t){const e=t.name;if(p.has(e))return h.debug("There were multiple attempts to register component ".concat(e,".")),!1;p.set(e,t);for(const n of f.values())g(n,t);return!0}function y(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const v={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},w=new r.LL("app","Firebase",v);class E{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new s.wA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw w.create("app-deleted",{appName:this._name})}}const b="9.17.1";function T(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t;if("object"!==typeof e){e={name:e}}const i=Object.assign({name:l,automaticDataCollectionEnabled:!1},e),o=i.name;if("string"!==typeof o||!o)throw w.create("bad-app-name",{appName:String(o)});if(n||(n=(0,r.aH)()),!n)throw w.create("no-options");const a=f.get(o);if(a){if((0,r.vZ)(n,a.options)&&(0,r.vZ)(i,a.config))return a;throw w.create("duplicate-app",{appName:o})}const c=new s.H0(o);for(const s of p.values())c.addComponent(s);const u=new E(n,i,c);return f.set(o,u),u}function I(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l;const e=f.get(t);if(!e&&t===l)return T();if(!e)throw w.create("no-app",{appName:t});return e}function S(t,e,n){var i;let r=null!==(i=d[t])&&void 0!==i?i:t;n&&(r+="-".concat(n));const o=r.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const t=['Unable to register library "'.concat(r,'" with version "').concat(e,'":')];return o&&t.push('library name "'.concat(r,'" contains illegal characters (whitespace or "/")')),o&&a&&t.push("and"),a&&t.push('version name "'.concat(e,'" contains illegal characters (whitespace or "/")')),void h.warn(t.join(" "))}m(new s.wA("".concat(r,"-version"),(()=>({library:r,version:e})),"VERSION"))}const C="firebase-heartbeat-database",A=1,_="firebase-heartbeat-store";let D=null;function k(){return D||(D=(0,o.X3)(C,A,{upgrade:(t,e)=>{if(0===e)t.createObjectStore(_)}}).catch((t=>{throw w.create("idb-open",{originalErrorMessage:t.message})}))),D}async function N(t,e){try{const n=(await k()).transaction(_,"readwrite"),s=n.objectStore(_);return await s.put(e,R(t)),n.done}catch(n){if(n instanceof r.ZR)h.warn(n.message);else{const t=w.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});h.warn(t.message)}}}function R(t){return"".concat(t.name,"!").concat(t.options.appId)}const L=1024;class O{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new M(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=x();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==e&&!this._heartbeatsCache.heartbeats.some((t=>t.date===e)))return this._heartbeatsCache.heartbeats.push({date:e,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const t=x(),{heartbeatsToSend:e,unsentEntries:n}=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:L;const n=[];let s=t.slice();for(const i of t){const t=n.find((t=>t.agent===i.agent));if(t){if(t.dates.push(i.date),P(n)>e){t.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),P(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}(this._heartbeatsCache.heartbeats),s=(0,r.L)(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function x(){return(new Date).toISOString().substring(0,10)}class M{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,r.hl)()&&(0,r.eu)().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){return await async function(t){try{return(await k()).transaction(_).objectStore(_).get(R(t))}catch(e){if(e instanceof r.ZR)h.warn(e.message);else{const t=w.create("idb-get",{originalErrorMessage:null===e||void 0===e?void 0:e.message});h.warn(t.message)}}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return N(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return N(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function P(t){return(0,r.L)(JSON.stringify({version:2,heartbeats:t})).length}var F;F="",m(new s.wA("platform-logger",(t=>new a(t)),"PRIVATE")),m(new s.wA("heartbeat",(t=>new O(t)),"PRIVATE")),S(c,u,F),S(c,u,"esm2017"),S("fire-js","")},23258:function(t,e,n){n.d(e,{H0:function(){return a},wA:function(){return i}});var s=n(85854);class i{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const r="[DEFAULT]";class o{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new s.BH;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(n){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null===t||void 0===t?void 0:t.identifier),s=null!==(e=null===t||void 0===t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(s)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(s)return null;throw i}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error("Mismatching Component ".concat(t.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:r})}catch(e){}for(const[t,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:s});n.resolve(t)}catch(e){}}}}clearInstance(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;return this.instances.has(t)}getOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;return this.instancesOptions.get(t)||{}}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const s=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[i,r]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&r.resolve(s)}return s}onInit(t,e){var n;const s=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(s))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(s,i);const r=this.instances.get(s);return r&&t(r,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(s){}}getOrInitializeService(t){let{instanceIdentifier:e,options:n={}}=t,s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===r?void 0:i),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch(o){}var i;return s||null}normalizeInstanceIdentifier(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;return this.component?this.component.multipleInstances?t:r:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component ".concat(t.name," has already been registered with ").concat(this.name));e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new o(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}},6781:function(t,e,n){n.d(e,{Yd:function(){return u},in:function(){return i}});const s=[];var i;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(i||(i={}));const r={debug:i.DEBUG,verbose:i.VERBOSE,info:i.INFO,warn:i.WARN,error:i.ERROR,silent:i.SILENT},o=i.INFO,a={[i.DEBUG]:"log",[i.VERBOSE]:"log",[i.INFO]:"info",[i.WARN]:"warn",[i.ERROR]:"error"},c=function(t,e){if(e<t.logLevel)return;const n=(new Date).toISOString(),s=a[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(e,")"));for(var i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];console[s]("[".concat(n,"]  ").concat(t.name,":"),...r)};class u{constructor(t){this.name=t,this._logLevel=o,this._logHandler=c,this._userLogHandler=null,s.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in i))throw new TypeError('Invalid value "'.concat(t,'" assigned to `logLevel`'));this._logLevel=t}setLogLevel(t){this._logLevel="string"===typeof t?r[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!==typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.DEBUG,...e),this._logHandler(this,i.DEBUG,...e)}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.VERBOSE,...e),this._logHandler(this,i.VERBOSE,...e)}info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.INFO,...e),this._logHandler(this,i.INFO,...e)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.WARN,...e),this._logHandler(this,i.WARN,...e)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.ERROR,...e),this._logHandler(this,i.ERROR,...e)}}},65390:function(t,e,n){n.d(e,{IH:function(){return Mt}});var s=n(89474),i=n(6781),r=n(85854),o=n(23258),a=n(59073);const c="@firebase/installations",u="0.6.3",h=1e4,l="w:".concat(u),d="FIS_v2",f="https://firebaseinstallations.googleapis.com/v1",p=36e5,g={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},m=new r.LL("installations","Installations",g);function y(t){return t instanceof r.ZR&&t.code.includes("request-failed")}function v(t){let{projectId:e}=t;return"".concat(f,"/projects/").concat(e,"/installations")}function w(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function E(t,e){const n=(await e.json()).error;return m.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function b(t){let{apiKey:e}=t;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function T(t,e){let{refreshToken:n}=e;const s=b(t);return s.append("Authorization",function(t){return"".concat(d," ").concat(t)}(n)),s}async function I(t){const e=await t();return e.status>=500&&e.status<600?t():e}function S(t){return new Promise((e=>{setTimeout(e,t)}))}const C=/^[cdef][\w-]{21}$/,A="";function _(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){const e=(n=t,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return e.substr(0,22)}(t);return C.test(e)?e:A}catch(t){return A}}function D(t){return"".concat(t.appName,"!").concat(t.appId)}const k=new Map;function N(t,e){const n=D(t);R(n,e),function(t,e){const n=O();n&&n.postMessage({key:t,fid:e});x()}(n,e)}function R(t,e){const n=k.get(t);if(n)for(const s of n)s(e)}let L=null;function O(){return!L&&"BroadcastChannel"in self&&(L=new BroadcastChannel("[Firebase] FID Change"),L.onmessage=t=>{R(t.data.key,t.data.fid)}),L}function x(){0===k.size&&L&&(L.close(),L=null)}const M="firebase-installations-database",P=1,F="firebase-installations-store";let V=null;function U(){return V||(V=(0,a.X3)(M,P,{upgrade:(t,e)=>{if(0===e)t.createObjectStore(F)}})),V}async function B(t,e){const n=D(t),s=(await U()).transaction(F,"readwrite"),i=s.objectStore(F),r=await i.get(n);return await i.put(e,n),await s.done,r&&r.fid===e.fid||N(t,e.fid),e}async function q(t){const e=D(t),n=(await U()).transaction(F,"readwrite");await n.objectStore(F).delete(e),await n.done}async function j(t,e){const n=D(t),s=(await U()).transaction(F,"readwrite"),i=s.objectStore(F),r=await i.get(n),o=e(r);return void 0===o?await i.delete(n):await i.put(o,n),await s.done,!o||r&&r.fid===o.fid||N(t,o.fid),o}async function K(t){let e;const n=await j(t.appConfig,(n=>{const s=function(t){const e=t||{fid:_(),registrationStatus:0};return G(e)}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine){return{installationEntry:e,registrationPromise:Promise.reject(m.create("app-offline"))}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},s=async function(t,e){try{const n=await async function(t,e){let{appConfig:n,heartbeatServiceProvider:s}=t,{fid:i}=e;const r=v(n),o=b(n),a=s.getImmediate({optional:!0});if(a){const t=await a.getHeartbeatsHeader();t&&o.append("x-firebase-client",t)}const c={fid:i,authVersion:d,appId:n.appId,sdkVersion:l},u={method:"POST",headers:o,body:JSON.stringify(c)},h=await I((()=>fetch(r,u)));if(h.ok){const t=await h.json();return{fid:t.fid||i,registrationStatus:2,refreshToken:t.refreshToken,authToken:w(t.authToken)}}throw await E("Create Installation",h)}(t,e);return B(t.appConfig,n)}catch(n){throw y(n)&&409===n.customData.serverCode?await q(t.appConfig):await B(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:s}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:H(t)}:{installationEntry:e}}(t,s);return e=i.registrationPromise,i.installationEntry}));return n.fid===A?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function H(t){let e=await z(t.appConfig);for(;1===e.registrationStatus;)await S(100),e=await z(t.appConfig);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await K(t);return n||e}return e}function z(t){return j(t,(t=>{if(!t)throw m.create("installation-not-found");return G(t)}))}function G(t){return 1===(e=t).registrationStatus&&e.registrationTime+h<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function Q(t,e){let{appConfig:n,heartbeatServiceProvider:s}=t;const i=function(t,e){let{fid:n}=e;return"".concat(v(t),"/").concat(n,"/authTokens:generate")}(n,e),r=T(n,e),o=s.getImmediate({optional:!0});if(o){const t=await o.getHeartbeatsHeader();t&&r.append("x-firebase-client",t)}const a={installation:{sdkVersion:l,appId:n.appId}},c={method:"POST",headers:r,body:JSON.stringify(a)},u=await I((()=>fetch(i,c)));if(u.ok){return w(await u.json())}throw await E("Generate Auth Token",u)}async function W(t){let e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=await j(t.appConfig,(s=>{if(!Y(s))throw m.create("not-registered");const i=s.authToken;if(!n&&function(t){return 2===t.requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+p}(t)}(i))return s;if(1===i.requestStatus)return e=async function(t,e){let n=await X(t.appConfig);for(;1===n.authToken.requestStatus;)await S(100),n=await X(t.appConfig);const s=n.authToken;return 0===s.requestStatus?W(t,e):s}(t,n),s;{if(!navigator.onLine)throw m.create("app-offline");const n=function(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}(s);return e=async function(t,e){try{const n=await Q(t,e),s=Object.assign(Object.assign({},e),{authToken:n});return await B(t.appConfig,s),n}catch(n){if(!y(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await B(t.appConfig,n)}else await q(t.appConfig);throw n}}(t,n),n}}));return e?await e:s.authToken}function X(t){return j(t,(t=>{if(!Y(t))throw m.create("not-registered");const e=t.authToken;return 1===(n=e).requestStatus&&n.requestTime+h<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t;var n}))}function Y(t){return void 0!==t&&2===t.registrationStatus}async function J(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=t;await async function(t){const{registrationPromise:e}=await K(t);e&&await e}(n);return(await W(n,e)).token}function $(t){return m.create("missing-app-config-values",{valueName:t})}const Z="installations",tt="installations-internal",et=t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw $("App Configuration");if(!t.name)throw $("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw $(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,heartbeatServiceProvider:(0,s.qX)(e,"heartbeat"),_delete:()=>Promise.resolve()}},nt=t=>{const e=t.getProvider("app").getImmediate(),n=(0,s.qX)(e,Z).getImmediate();return{getId:()=>async function(t){const e=t,{installationEntry:n,registrationPromise:s}=await K(e);return s?s.catch(console.error):W(e).catch(console.error),n.fid}(n),getToken:t=>J(n,t)}};(0,s.Xd)(new o.wA(Z,et,"PUBLIC")),(0,s.Xd)(new o.wA(tt,nt,"PRIVATE")),(0,s.KN)(c,u),(0,s.KN)(c,u,"esm2017");const st="analytics",it="firebase_id",rt="origin",ot=6e4,at="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",ct="https://www.googletagmanager.com/gtag/js",ut=new i.Yd("@firebase/analytics");function ht(t){return Promise.all(t.map((t=>t.catch((t=>t)))))}function lt(t,e,n,s){return async function(i,r,o){try{"event"===i?await async function(t,e,n,s,i){try{let r=[];if(i&&i.send_to){let t=i.send_to;Array.isArray(t)||(t=[t]);const s=await ht(n);for(const n of t){const t=s.find((t=>t.measurementId===n)),i=t&&e[t.appId];if(!i){r=[];break}r.push(i)}}0===r.length&&(r=Object.values(e)),await Promise.all(r),t("event",s,i||{})}catch(r){ut.error(r)}}(t,e,n,r,o):"config"===i?await async function(t,e,n,s,i,r){const o=s[i];try{if(o)await e[o];else{const t=(await ht(n)).find((t=>t.measurementId===i));t&&await e[t.appId]}}catch(a){ut.error(a)}t("config",i,r)}(t,e,n,s,r,o):"consent"===i?t("consent","update",o):t("set",r)}catch(a){ut.error(a)}}}const dt={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'},ft=new r.LL("analytics","Analytics",dt),pt=30;const gt=new class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function mt(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function yt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gt,n=arguments.length>2?arguments[2]:void 0;const{appId:s,apiKey:i,measurementId:r}=t.options;if(!s)throw ft.create("no-app-id");if(!i){if(r)return{measurementId:r,appId:s};throw ft.create("no-api-key")}const o=e.getThrottleMetadata(s)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new wt;return setTimeout((async()=>{a.abort()}),void 0!==n?n:ot),vt({appId:s,apiKey:i,measurementId:r},o,a,e)}async function vt(t,e,n){let{throttleEndTimeMillis:s,backoffCount:i}=e,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:gt;var a;const{appId:c,measurementId:u}=t;try{await function(t,e){return new Promise(((n,s)=>{const i=Math.max(e-Date.now(),0),r=setTimeout(n,i);t.addEventListener((()=>{clearTimeout(r),s(ft.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}(n,s)}catch(h){if(u)return ut.warn("Timed out fetching this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(u)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===h||void 0===h?void 0:h.message,"]")),{appId:c,measurementId:u};throw h}try{const e=await async function(t){var e;const{appId:n,apiKey:s}=t,i={method:"GET",headers:mt(s)},r=at.replace("{app-id}",n),o=await fetch(r,i);if(200!==o.status&&304!==o.status){let t="";try{const n=await o.json();(null===(e=n.error)||void 0===e?void 0:e.message)&&(t=n.error.message)}catch(a){}throw ft.create("config-fetch-failed",{httpStatus:o.status,responseMessage:t})}return o.json()}(t);return o.deleteThrottleMetadata(c),e}catch(h){const e=h;if(!function(t){if(!(t instanceof r.ZR)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(e)){if(o.deleteThrottleMetadata(c),u)return ut.warn("Failed to fetch this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(u)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===e||void 0===e?void 0:e.message,"]")),{appId:c,measurementId:u};throw h}const s=503===Number(null===(a=null===e||void 0===e?void 0:e.customData)||void 0===a?void 0:a.httpStatus)?(0,r.$s)(i,o.intervalMillis,pt):(0,r.$s)(i,o.intervalMillis),l={throttleEndTimeMillis:Date.now()+s,backoffCount:i+1};return o.setThrottleMetadata(c,l),ut.debug("Calling attemptFetch again in ".concat(s," millis")),vt(t,l,n,o)}}class wt{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach((t=>t()))}}let Et,bt;function Tt(t){bt=t}function It(t){Et=t}async function St(t,e,n,s,i,o,a){var c;const u=yt(t);u.then((e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&ut.warn("The measurement ID in the local Firebase config (".concat(t.options.measurementId,")")+" does not match the measurement ID fetched from the server (".concat(e.measurementId,").")+" To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((t=>ut.error(t))),e.push(u);const h=async function(){if(!(0,r.hl)())return ut.warn(ft.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await(0,r.eu)()}catch(t){return ut.warn(ft.create("indexeddb-unavailable",{errorInfo:null===t||void 0===t?void 0:t.toString()}).message),!1}return!0}().then((t=>t?s.getId():void 0)),[l,d]=await Promise.all([u,h]);(function(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(ct)&&n.src.includes(t))return n;return null})(o)||function(t,e){const n=document.createElement("script");n.src="".concat(ct,"?l=").concat(t,"&id=").concat(e),n.async=!0,document.head.appendChild(n)}(o,l.measurementId),bt&&(i("consent","default",bt),Tt(void 0)),i("js",new Date);const f=null!==(c=null===a||void 0===a?void 0:a.config)&&void 0!==c?c:{};return f[rt]="firebase",f.update=!0,null!=d&&(f[it]=d),i("config",l.measurementId,f),Et&&(i("set",Et),It(void 0)),l.measurementId}class Ct{constructor(t){this.app=t}_delete(){return delete At[this.app.options.appId],Promise.resolve()}}let At={},_t=[];const Dt={};let kt,Nt,Rt="dataLayer",Lt="gtag",Ot=!1;function xt(t,e,n){!function(){const t=[];if((0,r.ru)()&&t.push("This is a browser extension environment."),(0,r.zI)()||t.push("Cookies are not available."),t.length>0){const e=t.map(((t,e)=>"(".concat(e+1,") ").concat(t))).join(" "),n=ft.create("invalid-analytics-context",{errorInfo:e});ut.warn(n.message)}}();const s=t.options.appId;if(!s)throw ft.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw ft.create("no-api-key");ut.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest'+" measurement ID for this Firebase app. Falling back to the measurement ID ".concat(t.options.measurementId)+' provided in the "measurementId" field in the local Firebase config.')}if(null!=At[s])throw ft.create("already-exists",{id:s});if(!Ot){!function(t){let e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(Rt);const{wrappedGtag:t,gtagCore:e}=function(t,e,n,s,i){let r=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];window[s].push(arguments)};return window[i]&&"function"===typeof window[i]&&(r=window[i]),window[i]=lt(r,t,e,n),{gtagCore:r,wrappedGtag:window[i]}}(At,_t,Dt,Rt,Lt);Nt=t,kt=e,Ot=!0}At[s]=St(t,_t,Dt,e,kt,Rt,n);return new Ct(t)}function Mt(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.Mq)();t=(0,r.m9)(t);const e=(0,s.qX)(t,st);return e.isInitialized()?e.getImmediate():function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(0,s.qX)(t,st);if(n.isInitialized()){const t=n.getImmediate();if((0,r.vZ)(e,n.getOptions()))return t;throw ft.create("already-initialized")}const i=n.initialize({options:e});return i}(t)}function Pt(t,e,n,s){t=(0,r.m9)(t),async function(t,e,n,s,i){if(i&&i.global)t("event",n,s);else{const i=await e;t("event",n,Object.assign(Object.assign({},s),{send_to:i}))}}(Nt,At[t.app.options.appId],e,n,s).catch((t=>ut.error(t)))}const Ft="@firebase/analytics",Vt="0.9.3";(0,s.Xd)(new o.wA(st,((t,e)=>{let{options:n}=e;return xt(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),n)}),"PUBLIC")),(0,s.Xd)(new o.wA("analytics-internal",(function(t){try{const e=t.getProvider(st).getImmediate();return{logEvent:(t,n,s)=>Pt(e,t,n,s)}}catch(e){throw ft.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),(0,s.KN)(Ft,Vt),(0,s.KN)(Ft,Vt,"esm2017")},44702:function(t,e,n){n.d(e,{ZF:function(){return s.ZF}});var s=n(89474);(0,s.KN)("firebase","9.17.1","app")},67799:function(t,e,n){n.d(e,{hJ:function(){return ju},oe:function(){return Hh},JU:function(){return Ku},PL:function(){return qh},ad:function(){return eh},Bt:function(){return Gh},pl:function(){return jh},r7:function(){return Kh}});var s,i=n(89474),r=n(23258),o=n(6781),a=n(85854),c="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},u={},h=h||{},l=c||self;function d(){}function f(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function p(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var g="closure_uid_"+(1e9*Math.random()>>>0),m=0;function y(t,e,n){return t.call.apply(t.bind,arguments)}function v(t,e,n){if(!t)throw Error();if(2<arguments.length){var s=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,s),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function w(t,e,n){return(w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?y:v).apply(null,arguments)}function E(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function b(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Wb=function(t,n,s){for(var i=Array(arguments.length-2),r=2;r<arguments.length;r++)i[r-2]=arguments[r];return e.prototype[n].apply(t,i)}}function T(){this.s=this.s,this.o=this.o}T.prototype.s=!1,T.prototype.na=function(){var t;!this.s&&(this.s=!0,this.M(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,g)&&t[g]||(t[g]=++m))},T.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const I=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"===typeof t)return"string"!==typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function S(t){const e=t.length;if(0<e){const n=Array(e);for(let s=0;s<e;s++)n[s]=t[s];return n}return[]}function C(t,e){for(let n=1;n<arguments.length;n++){const e=arguments[n];if(f(e)){const n=t.length||0,s=e.length||0;t.length=n+s;for(let i=0;i<s;i++)t[n+i]=e[i]}else t.push(e)}}function A(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}A.prototype.h=function(){this.defaultPrevented=!0};var _=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{l.addEventListener("test",d,e),l.removeEventListener("test",d,e)}catch(n){}return t}();function D(t){return/^[\s\xa0]*$/.test(t)}var k=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function N(t,e){return t<e?-1:t>e?1:0}function R(){var t=l.navigator;return t&&(t=t.userAgent)?t:""}function L(t){return-1!=R().indexOf(t)}function O(t){return O[" "](t),t}O[" "]=d;var x,M=L("Opera"),P=L("Trident")||L("MSIE"),F=L("Edge"),V=F||P,U=L("Gecko")&&!(-1!=R().toLowerCase().indexOf("webkit")&&!L("Edge"))&&!(L("Trident")||L("MSIE"))&&!L("Edge"),B=-1!=R().toLowerCase().indexOf("webkit")&&!L("Edge");function q(){var t=l.document;return t?t.documentMode:void 0}t:{var j="",K=function(){var t=R();return U?/rv:([^\);]+)(\)|;)/.exec(t):F?/Edge\/([\d\.]+)/.exec(t):P?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):B?/WebKit\/(\S+)/.exec(t):M?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(K&&(j=K?K[1]:""),P){var H=q();if(null!=H&&H>parseFloat(j)){x=String(H);break t}}x=j}var z,G={};function Q(){return function(t){var e=G;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){let t=0;const e=k(String(x)).split("."),n=k("9").split("."),s=Math.max(e.length,n.length);for(let o=0;0==t&&o<s;o++){var i=e[o]||"",r=n[o]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],0==i[0].length&&0==r[0].length)break;t=N(0==i[1].length?0:parseInt(i[1],10),0==r[1].length?0:parseInt(r[1],10))||N(0==i[2].length,0==r[2].length)||N(i[2],r[2]),i=i[3],r=r[3]}while(0==t)}return 0<=t}))}if(l.document&&P){var W=q();z=W||(parseInt(x,10)||void 0)}else z=void 0;var X=z;function Y(t,e){if(A.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,s=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(U){t:{try{O(e.nodeName);var i=!0;break t}catch(r){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,s?(this.clientX=void 0!==s.clientX?s.clientX:s.pageX,this.clientY=void 0!==s.clientY?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"===typeof t.pointerType?t.pointerType:J[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Y.X.h.call(this)}}b(Y,A);var J={2:"touch",3:"pen",4:"mouse"};Y.prototype.h=function(){Y.X.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var $="closure_listenable_"+(1e6*Math.random()|0),Z=0;function tt(t,e,n,s,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!s,this.ha=i,this.key=++Z,this.ba=this.ea=!1}function et(t){t.ba=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function nt(t,e,n){for(const s in t)e.call(n,t[s],s,t)}function st(t){const e={};for(const n in t)e[n]=t[n];return e}const it="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rt(t,e){let n,s;for(let i=1;i<arguments.length;i++){for(n in s=arguments[i],s)t[n]=s[n];for(let e=0;e<it.length;e++)n=it[e],Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}}function ot(t){this.src=t,this.g={},this.h=0}function at(t,e){var n=e.type;if(n in t.g){var s,i=t.g[n],r=I(i,e);(s=0<=r)&&Array.prototype.splice.call(i,r,1),s&&(et(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function ct(t,e,n,s){for(var i=0;i<t.length;++i){var r=t[i];if(!r.ba&&r.listener==e&&r.capture==!!n&&r.ha==s)return i}return-1}ot.prototype.add=function(t,e,n,s,i){var r=t.toString();(t=this.g[r])||(t=this.g[r]=[],this.h++);var o=ct(t,e,s,i);return-1<o?(e=t[o],n||(e.ea=!1)):((e=new tt(e,this.src,r,!!s,i)).ea=n,t.push(e)),e};var ut="closure_lm_"+(1e6*Math.random()|0),ht={};function lt(t,e,n,s,i){if(s&&s.once)return ft(t,e,n,s,i);if(Array.isArray(e)){for(var r=0;r<e.length;r++)lt(t,e[r],n,s,i);return null}return n=Et(n),t&&t[$]?t.N(e,n,p(s)?!!s.capture:!!s,i):dt(t,e,n,!1,s,i)}function dt(t,e,n,s,i,r){if(!e)throw Error("Invalid event type");var o=p(i)?!!i.capture:!!i,a=vt(t);if(a||(t[ut]=a=new ot(t)),(n=a.add(e,n,s,o,r)).proxy)return n;if(s=function(){function t(n){return e.call(t.src,t.listener,n)}const e=yt;return t}(),n.proxy=s,s.src=t,s.listener=n,t.addEventListener)_||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),s,i);else if(t.attachEvent)t.attachEvent(mt(e.toString()),s);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(s)}return n}function ft(t,e,n,s,i){if(Array.isArray(e)){for(var r=0;r<e.length;r++)ft(t,e[r],n,s,i);return null}return n=Et(n),t&&t[$]?t.O(e,n,p(s)?!!s.capture:!!s,i):dt(t,e,n,!0,s,i)}function pt(t,e,n,s,i){if(Array.isArray(e))for(var r=0;r<e.length;r++)pt(t,e[r],n,s,i);else s=p(s)?!!s.capture:!!s,n=Et(n),t&&t[$]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=ct(r=t.g[e],n,s,i))&&(et(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete t.g[e],t.h--)))):t&&(t=vt(t))&&(e=t.g[e.toString()],t=-1,e&&(t=ct(e,n,s,i)),(n=-1<t?e[t]:null)&&gt(n))}function gt(t){if("number"!==typeof t&&t&&!t.ba){var e=t.src;if(e&&e[$])at(e.i,t);else{var n=t.type,s=t.proxy;e.removeEventListener?e.removeEventListener(n,s,t.capture):e.detachEvent?e.detachEvent(mt(n),s):e.addListener&&e.removeListener&&e.removeListener(s),(n=vt(e))?(at(n,t),0==n.h&&(n.src=null,e[ut]=null)):et(t)}}}function mt(t){return t in ht?ht[t]:ht[t]="on"+t}function yt(t,e){if(t.ba)t=!0;else{e=new Y(e,this);var n=t.listener,s=t.ha||t.src;t.ea&&gt(t),t=n.call(s,e)}return t}function vt(t){return(t=t[ut])instanceof ot?t:null}var wt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Et(t){return"function"===typeof t?t:(t[wt]||(t[wt]=function(e){return t.handleEvent(e)}),t[wt])}function bt(){T.call(this),this.i=new ot(this),this.P=this,this.I=null}function Tt(t,e){var n,s=t.I;if(s)for(n=[];s;s=s.I)n.push(s);if(t=t.P,s=e.type||e,"string"===typeof e)e=new A(e,t);else if(e instanceof A)e.target=e.target||t;else{var i=e;rt(e=new A(s,t),i)}if(i=!0,n)for(var r=n.length-1;0<=r;r--){var o=e.g=n[r];i=It(o,s,!0,e)&&i}if(i=It(o=e.g=t,s,!0,e)&&i,i=It(o,s,!1,e)&&i,n)for(r=0;r<n.length;r++)i=It(o=e.g=n[r],s,!1,e)&&i}function It(t,e,n,s){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,r=0;r<e.length;++r){var o=e[r];if(o&&!o.ba&&o.capture==n){var a=o.listener,c=o.ha||o.src;o.ea&&at(t.i,o),i=!1!==a.call(c,s)&&i}}return i&&!s.defaultPrevented}b(bt,T),bt.prototype[$]=!0,bt.prototype.removeEventListener=function(t,e,n,s){pt(this,t,e,n,s)},bt.prototype.M=function(){if(bt.X.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],s=0;s<n.length;s++)et(n[s]);delete e.g[t],e.h--}}this.I=null},bt.prototype.N=function(t,e,n,s){return this.i.add(String(t),e,!1,n,s)},bt.prototype.O=function(t,e,n,s){return this.i.add(String(t),e,!0,n,s)};var St=l.JSON.stringify;function Ct(){var t=Lt;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var At,_t=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Dt),(t=>t.reset()));class Dt{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function kt(t){l.setTimeout((()=>{throw t}),0)}function Nt(t,e){At||function(){var t=l.Promise.resolve(void 0);At=function(){t.then(Ot)}}(),Rt||(At(),Rt=!0),Lt.add(t,e)}var Rt=!1,Lt=new class{constructor(){this.h=this.g=null}add(t,e){const n=_t.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}};function Ot(){for(var t;t=Ct();){try{t.h.call(t.g)}catch(n){kt(n)}var e=_t;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Rt=!1}function xt(t,e){bt.call(this),this.h=t||1,this.g=e||l,this.j=w(this.lb,this),this.l=Date.now()}function Mt(t){t.ca=!1,t.R&&(t.g.clearTimeout(t.R),t.R=null)}function Pt(t,e,n){if("function"===typeof t)n&&(t=w(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=w(t.handleEvent,t)}return 2147483647<Number(e)?-1:l.setTimeout(t,e||0)}function Ft(t){t.g=Pt((()=>{t.g=null,t.i&&(t.i=!1,Ft(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}b(xt,bt),(s=xt.prototype).ca=!1,s.R=null,s.lb=function(){if(this.ca){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-t):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Tt(this,"tick"),this.ca&&(Mt(this),this.start()))}},s.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},s.M=function(){xt.X.M.call(this),Mt(this),delete this.g};class Vt extends T{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:Ft(this)}M(){super.M(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ut(t){T.call(this),this.h=t,this.g={}}b(Ut,T);var Bt=[];function qt(t,e,n,s){Array.isArray(n)||(n&&(Bt[0]=n.toString()),n=Bt);for(var i=0;i<n.length;i++){var r=lt(e,n[i],s||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}}function jt(t){nt(t.g,(function(t,e){this.g.hasOwnProperty(e)&&gt(t)}),t),t.g={}}function Kt(){this.g=!0}function Ht(t,e,n,s){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var s=n[t];if(!(2>s.length)){var i=s[1];if(Array.isArray(i)&&!(1>i.length)){var r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return St(n)}catch(a){return e}}(t,n)+(s?" "+s:"")}))}Ut.prototype.M=function(){Ut.X.M.call(this),jt(this)},Ut.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Kt.prototype.Aa=function(){this.g=!1},Kt.prototype.info=function(){};var zt={},Gt=null;function Qt(){return Gt=Gt||new bt}function Wt(t){A.call(this,zt.Pa,t)}function Xt(t){const e=Qt();Tt(e,new Wt(e))}function Yt(t,e){A.call(this,zt.STAT_EVENT,t),this.stat=e}function Jt(t){const e=Qt();Tt(e,new Yt(e,t))}function $t(t,e){A.call(this,zt.Qa,t),this.size=e}function Zt(t,e){if("function"!==typeof t)throw Error("Fn must not be null and must be a function");return l.setTimeout((function(){t()}),e)}zt.Pa="serverreachability",b(Wt,A),zt.STAT_EVENT="statevent",b(Yt,A),zt.Qa="timingevent",b($t,A);var te={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},ee={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function ne(){}function se(t){return t.h||(t.h=t.i())}function ie(){}ne.prototype.h=null;var re,oe={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function ae(){A.call(this,"d")}function ce(){A.call(this,"c")}function ue(){}function he(t,e,n,s){this.l=t,this.j=e,this.m=n,this.U=s||1,this.S=new Ut(this),this.O=de,t=V?125:void 0,this.T=new xt(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new le}function le(){this.i=null,this.g="",this.h=!1}b(ae,A),b(ce,A),b(ue,ne),ue.prototype.g=function(){return new XMLHttpRequest},ue.prototype.i=function(){return{}},re=new ue;var de=45e3,fe={},pe={};function ge(t,e,n){t.K=1,t.v=xe(ke(e)),t.s=n,t.P=!0,me(t,null)}function me(t,e){t.F=Date.now(),Ee(t),t.A=ke(t.v);var n=t.A,s=t.U;Array.isArray(s)||(s=[String(s)]),Qe(n.i,"t",s),t.C=0,n=t.l.H,t.h=new le,t.g=Wn(t.l,n?e:null,!t.s),0<t.N&&(t.L=new Vt(w(t.La,t,t.g),t.N)),qt(t.S,t.g,"readystatechange",t.ib),e=t.H?st(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.da(t.A,t.u,t.s,e)):(t.u="GET",t.g.da(t.A,t.u,null,e)),Xt(),function(t,e,n,s,i,r){t.info((function(){if(t.g)if(r)for(var o="",a=r.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var h=u[0];u=u[1];var l=h.split("_");o=2<=l.length&&"type"==l[1]?o+(h+"=")+u+"&":o+(h+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+s+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.U,t.s)}function ye(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Da)}function ve(t,e,n){let s,i=!0;for(;!t.I&&t.C<n.length;){if(s=we(t,n),s==pe){4==e&&(t.o=4,Jt(14),i=!1),Ht(t.j,t.m,null,"[Incomplete Response]");break}if(s==fe){t.o=4,Jt(15),Ht(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}Ht(t.j,t.m,s,null),Ce(t,s)}ye(t)&&s!=pe&&s!=fe&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Jt(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.$&&(t.$=!0,(e=t.l).g==t&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),Bn(e),e.K=!0,Jt(11))):(Ht(t.j,t.m,n,"[Invalid Chunked Response]"),Se(t),Ie(t))}function we(t,e){var n=t.C,s=e.indexOf("\n",n);return-1==s?pe:(n=Number(e.substring(n,s)),isNaN(n)?fe:(s+=1)+n>e.length?pe:(e=e.substr(s,n),t.C=s+n,e))}function Ee(t){t.V=Date.now()+t.O,be(t,t.O)}function be(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Zt(w(t.gb,t),e)}function Te(t){t.B&&(l.clearTimeout(t.B),t.B=null)}function Ie(t){0==t.l.G||t.I||Kn(t.l,t)}function Se(t){Te(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Mt(t.T),jt(t.S),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Ce(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||tn(n.h,t)))if(!t.J&&tn(n.h,t)&&3==n.G){try{var s=n.Fa.g.parse(e)}catch(u){s=null}if(Array.isArray(s)&&3==s.length){var i=s;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;jn(n),Ln(n)}Un(n),Jt(18)}}else n.Ba=i[1],0<n.Ba-n.T&&37500>i[2]&&n.L&&0==n.A&&!n.v&&(n.v=Zt(w(n.cb,n),6e3));if(1>=Ze(n.h)&&n.ja){try{n.ja()}catch(u){}n.ja=void 0}}else zn(n,11)}else if((t.J||n.g==t)&&jn(n),!D(e))for(i=n.Fa.g.parse(e),e=0;e<i.length;e++){let u=i[e];if(n.T=u[0],u=u[1],2==n.G)if("c"==u[0]){n.I=u[1],n.ka=u[2];const e=u[3];null!=e&&(n.ma=e,n.j.info("VER="+n.ma));const i=u[4];null!=i&&(n.Ca=i,n.j.info("SVER="+n.Ca));const h=u[5];null!=h&&"number"===typeof h&&0<h&&(s=1.5*h,n.J=s,n.j.info("backChannelRequestTimeoutMs_="+s)),s=n;const l=t.g;if(l){const t=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var r=s.h;r.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(r.j=r.l,r.g=new Set,r.h&&(en(r,r.h),r.h=null))}if(s.D){const t=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(s.za=t,Oe(s.F,s.D,t))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-t.F,n.j.info("Handshake RTT: "+n.P+"ms"));var o=t;if((s=n).sa=Qn(s,s.H?s.ka:null,s.V),o.J){nn(s.h,o);var a=o,c=s.J;c&&a.setTimeout(c),a.B&&(Te(a),Ee(a)),s.g=o}else Vn(s);0<n.i.length&&xn(n)}else"stop"!=u[0]&&"close"!=u[0]||zn(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?zn(n,7):Rn(n):"noop"!=u[0]&&n.l&&n.l.wa(u),n.A=0)}Xt()}catch(u){}}function Ae(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(f(t)||"string"===typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.oa&&"function"==typeof t.oa)return t.oa();if(!t.W||"function"!=typeof t.W){if("undefined"!==typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!==typeof Set&&t instanceof Set)){if(f(t)||"string"===typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const s in t)e[n++]=s;return e}}}(t),s=function(t){if(t.W&&"function"==typeof t.W)return t.W();if("undefined"!==typeof Map&&t instanceof Map||"undefined"!==typeof Set&&t instanceof Set)return Array.from(t.values());if("string"===typeof t)return t.split("");if(f(t)){for(var e=[],n=t.length,s=0;s<n;s++)e.push(t[s]);return e}for(s in e=[],n=0,t)e[n++]=t[s];return e}(t),i=s.length,r=0;r<i;r++)e.call(void 0,s[r],n&&n[r],t)}(s=he.prototype).setTimeout=function(t){this.O=t},s.ib=function(t){t=t.target;const e=this.L;e&&3==Cn(t)?e.l():this.La(t)},s.La=function(t){try{if(t==this.g)t:{const h=Cn(this.g);var e=this.g.Ea();this.g.aa();if(!(3>h)&&(3!=h||V||this.g&&(this.h.h||this.g.fa()||An(this.g)))){this.I||4!=h||7==e||Xt(),Te(this);var n=this.g.aa();this.Y=n;e:if(ye(this)){var s=An(this.g);t="";var i=s.length,r=4==Cn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Se(this),Ie(this);var o="";break e}this.h.i=new l.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(s[e],{stream:r&&e==i-1});s.splice(0,i),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==n,function(t,e,n,s,i,r,o){t.info((function(){return"XMLHTTP RESP ("+s+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+r+" "+o}))}(this.j,this.u,this.A,this.m,this.U,h,n),this.i){if(this.Z&&!this.J){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(a)){var u=a;break e}}u=null}if(!(n=u)){this.i=!1,this.o=3,Jt(12),Se(this),Ie(this);break t}Ht(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Ce(this,n)}this.P?(ve(this,h,o),V&&this.i&&3==h&&(qt(this.S,this.T,"tick",this.hb),this.T.start())):(Ht(this.j,this.m,o,null),Ce(this,o)),4==h&&Se(this),this.i&&!this.I&&(4==h?Kn(this.l,this):(this.i=!1,Ee(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,Jt(12)):(this.o=0,Jt(13)),Se(this),Ie(this)}}}catch(h){}},s.hb=function(){if(this.g){var t=Cn(this.g),e=this.g.fa();this.C<e.length&&(Te(this),ve(this,t,e),this.i&&4!=t&&Ee(this))}},s.cancel=function(){this.I=!0,Se(this)},s.gb=function(){this.B=null;const t=Date.now();0<=t-this.V?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(Xt(),Jt(17)),Se(this),this.o=2,Ie(this)):be(this,this.V-t)};var _e=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function De(t,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof De){this.h=void 0!==e?e:t.h,Ne(this,t.j),this.s=t.s,this.g=t.g,Re(this,t.m),this.l=t.l,e=t.i;var n=new Ke;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Le(this,n),this.o=t.o}else t&&(n=String(t).match(_e))?(this.h=!!e,Ne(this,n[1]||"",!0),this.s=Me(n[2]||""),this.g=Me(n[3]||"",!0),Re(this,n[4]),this.l=Me(n[5]||"",!0),Le(this,n[6]||"",!0),this.o=Me(n[7]||"")):(this.h=!!e,this.i=new Ke(null,this.h))}function ke(t){return new De(t)}function Ne(t,e,n){t.j=n?Me(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Re(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Le(t,e,n){e instanceof Ke?(t.i=e,function(t,e){e&&!t.j&&(He(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(ze(this,e),Qe(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=Pe(e,qe)),t.i=new Ke(e,t.h))}function Oe(t,e,n){t.i.set(e,n)}function xe(t){return Oe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Me(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Pe(t,e,n){return"string"===typeof t?(t=encodeURI(t).replace(e,Fe),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Fe(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}De.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Pe(e,Ve,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Pe(e,Ve,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(Pe(n,"/"==n.charAt(0)?Be:Ue,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Pe(n,je)),t.join("")};var Ve=/[#\/\?@]/g,Ue=/[#\?:]/g,Be=/[#\?]/g,qe=/[#\?@]/g,je=/#/g;function Ke(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function He(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var s=t[n].indexOf("="),i=null;if(0<=s){var r=t[n].substring(0,s);i=t[n].substring(s+1)}else r=t[n];e(r,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function ze(t,e){He(t),e=We(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Ge(t,e){return He(t),e=We(t,e),t.g.has(e)}function Qe(t,e,n){ze(t,e),0<n.length&&(t.i=null,t.g.set(We(t,e),S(n)),t.h+=n.length)}function We(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(s=Ke.prototype).add=function(t,e){He(this),this.i=null,t=We(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},s.forEach=function(t,e){He(this),this.g.forEach((function(n,s){n.forEach((function(n){t.call(e,n,s,this)}),this)}),this)},s.oa=function(){He(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let s=0;s<e.length;s++){const i=t[s];for(let t=0;t<i.length;t++)n.push(e[s])}return n},s.W=function(t){He(this);let e=[];if("string"===typeof t)Ge(this,t)&&(e=e.concat(this.g.get(We(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},s.set=function(t,e){return He(this),this.i=null,Ge(this,t=We(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},s.get=function(t,e){return t&&0<(t=this.W(t)).length?String(t[0]):e},s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var s=e[n];const r=encodeURIComponent(String(s)),o=this.W(s);for(s=0;s<o.length;s++){var i=r;""!==o[s]&&(i+="="+encodeURIComponent(String(o[s]))),t.push(i)}}return this.i=t.join("&")};function Xe(t){this.l=t||Je,l.PerformanceNavigationTiming?t=0<(t=l.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(l.g&&l.g.Ga&&l.g.Ga()&&l.g.Ga().$b),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Ye,Je=10;function $e(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Ze(t){return t.h?1:t.g?t.g.size:0}function tn(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function en(t,e){t.g?t.g.add(e):t.h=e}function nn(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function sn(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return S(t.i)}function rn(){}function on(){this.g=new rn}function an(t,e,n){const s=n||"";try{Ae(t,(function(t,n){let i=t;p(t)&&(i=St(t)),e.push(s+n+"="+encodeURIComponent(i))}))}catch(i){throw e.push(s+"type="+encodeURIComponent("_badmap")),i}}function cn(t,e,n,s,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(s)}catch(r){}}function un(t){this.l=t.ac||null,this.j=t.jb||!1}function hn(t,e){bt.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=ln,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Xe.prototype.cancel=function(){if(this.i=sn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}},rn.prototype.stringify=function(t){return l.JSON.stringify(t,void 0)},rn.prototype.parse=function(t){return l.JSON.parse(t,void 0)},b(un,ne),un.prototype.g=function(){return new hn(this.l,this.j)},un.prototype.i=(Ye={},function(){return Ye}),b(hn,bt);var ln=0;function dn(t){t.j.read().then(t.Ta.bind(t)).catch(t.ga.bind(t))}function fn(t){t.readyState=4,t.l=null,t.j=null,t.A=null,pn(t)}function pn(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(s=hn.prototype).open=function(t,e){if(this.readyState!=ln)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,pn(this)},s.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||l).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,fn(this)),this.readyState=ln},s.Wa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,pn(this)),this.g&&(this.readyState=3,pn(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if("undefined"!==typeof l.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;dn(this)}else t.text().then(this.Va.bind(this),this.ga.bind(this))},s.Ta=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?fn(this):pn(this),3==this.readyState&&dn(this)}},s.Va=function(t){this.g&&(this.response=this.responseText=t,fn(this))},s.Ua=function(t){this.g&&(this.response=t,fn(this))},s.ga=function(){this.g&&fn(this)},s.setRequestHeader=function(t,e){this.v.append(t,e)},s.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(hn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var gn=l.JSON.parse;function mn(t){bt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=yn,this.K=this.L=!1}b(mn,bt);var yn="",vn=/^https?$/i,wn=["POST","PUT"];function En(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,bn(t),In(t)}function bn(t){t.D||(t.D=!0,Tt(t,"complete"),Tt(t,"error"))}function Tn(t){if(t.h&&"undefined"!=typeof h&&(!t.C[1]||4!=Cn(t)||2!=t.aa()))if(t.v&&4==Cn(t))Pt(t.Ha,0,t);else if(Tt(t,"readystatechange"),4==Cn(t)){t.h=!1;try{const c=t.aa();t:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var s;if(s=0===c){var i=String(t.H).match(_e)[1]||null;if(!i&&l.self&&l.self.location){var r=l.self.location.protocol;i=r.substr(0,r.length-1)}s=!vn.test(i?i.toLowerCase():"")}n=s}if(n)Tt(t,"complete"),Tt(t,"success");else{t.m=6;try{var o=2<Cn(t)?t.g.statusText:""}catch(a){o=""}t.j=o+" ["+t.aa()+"]",bn(t)}}finally{In(t)}}}function In(t,e){if(t.g){Sn(t);const s=t.g,i=t.C[0]?d:null;t.g=null,t.C=null,e||Tt(t,"ready");try{s.onreadystatechange=i}catch(n){}}}function Sn(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(l.clearTimeout(t.A),t.A=null)}function Cn(t){return t.g?t.g.readyState:0}function An(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case yn:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(hs){return null}}function _n(t){let e="";return nt(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function Dn(t,e,n){t:{for(s in n){var s=!1;break t}s=!0}s||(n=_n(n),"string"===typeof t?null!=n&&encodeURIComponent(String(n)):Oe(t,e,n))}function kn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Nn(t){this.Ca=0,this.i=[],this.j=new Kt,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=kn("failFast",!1,t),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=kn("baseRetryDelayMs",5e3,t),this.bb=kn("retryDelaySeedMs",1e4,t),this.$a=kn("forwardChannelMaxRetries",2,t),this.ta=kn("forwardChannelRequestTimeoutMs",2e4,t),this.ra=t&&t.xmlHttpFactory||void 0,this.Da=t&&t.Zb||!1,this.J=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.I="",this.h=new Xe(t&&t.concurrentRequestLimit),this.Fa=new on,this.O=t&&t.fastHandshake||!1,this.N=t&&t.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=t&&t.Xb||!1,t&&t.Aa&&this.j.Aa(),t&&t.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&t&&t.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function Rn(t){if(On(t),3==t.G){var e=t.U++,n=ke(t.F);Oe(n,"SID",t.I),Oe(n,"RID",e),Oe(n,"TYPE","terminate"),Pn(t,n),(e=new he(t,t.j,e,void 0)).K=2,e.v=xe(ke(n)),n=!1,l.navigator&&l.navigator.sendBeacon&&(n=l.navigator.sendBeacon(e.v.toString(),"")),!n&&l.Image&&((new Image).src=e.v,n=!0),n||(e.g=Wn(e.l,null),e.g.da(e.v)),e.F=Date.now(),Ee(e)}Gn(t)}function Ln(t){t.g&&(Bn(t),t.g.cancel(),t.g=null)}function On(t){Ln(t),t.u&&(l.clearTimeout(t.u),t.u=null),jn(t),t.h.cancel(),t.m&&("number"===typeof t.m&&l.clearTimeout(t.m),t.m=null)}function xn(t){$e(t.h)||t.m||(t.m=!0,Nt(t.Ja,t),t.C=0)}function Mn(t,e){var n;n=e?e.m:t.U++;const s=ke(t.F);Oe(s,"SID",t.I),Oe(s,"RID",n),Oe(s,"AID",t.T),Pn(t,s),t.o&&t.s&&Dn(s,t.o,t.s),n=new he(t,t.j,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.i=e.D.concat(t.i)),e=Fn(t,n,1e3),n.setTimeout(Math.round(.5*t.ta)+Math.round(.5*t.ta*Math.random())),en(t.h,n),ge(n,s,e)}function Pn(t,e){t.ia&&nt(t.ia,(function(t,n){Oe(e,n,t)})),t.l&&Ae({},(function(t,n){Oe(e,n,t)}))}function Fn(t,e,n){n=Math.min(t.i.length,n);var s=t.l?w(t.l.Ra,t.l,t):null;t:{var i=t.i;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=i[0].h,t.push("ofs="+e)):e=0:t.push("ofs="+e);let o=!0;for(let a=0;a<n;a++){let n=i[a].h;const c=i[a].g;if(n-=e,0>n)e=Math.max(0,i[a].h-100),o=!1;else try{an(c,t,"req"+n+"_")}catch(r){s&&s(c)}}if(o){s=t.join("&");break t}}}return t=t.i.splice(0,n),e.D=t,s}function Vn(t){t.g||t.u||(t.Z=1,Nt(t.Ia,t),t.A=0)}function Un(t){return!(t.g||t.u||3<=t.A)&&(t.Z++,t.u=Zt(w(t.Ia,t),Hn(t,t.A)),t.A++,!0)}function Bn(t){null!=t.B&&(l.clearTimeout(t.B),t.B=null)}function qn(t){t.g=new he(t,t.j,"rpc",t.Z),null===t.o&&(t.g.H=t.s),t.g.N=0;var e=ke(t.sa);Oe(e,"RID","rpc"),Oe(e,"SID",t.I),Oe(e,"CI",t.L?"0":"1"),Oe(e,"AID",t.T),Oe(e,"TYPE","xmlhttp"),Pn(t,e),t.o&&t.s&&Dn(e,t.o,t.s),t.J&&t.g.setTimeout(t.J);var n=t.g;t=t.ka,n.K=1,n.v=xe(ke(e)),n.s=null,n.P=!0,me(n,t)}function jn(t){null!=t.v&&(l.clearTimeout(t.v),t.v=null)}function Kn(t,e){var n=null;if(t.g==e){jn(t),Bn(t),t.g=null;var s=2}else{if(!tn(t.h,e))return;n=e.D,nn(t.h,e),s=1}if(0!=t.G)if(t.pa=e.Y,e.i)if(1==s){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;Tt(s=Qt(),new $t(s,n)),xn(t)}else Vn(t);else if(3==(i=e.o)||0==i&&0<t.pa||!(1==s&&function(t,e){return!(Ze(t.h)>=t.h.j-(t.m?1:0))&&(t.m?(t.i=e.D.concat(t.i),!0):!(1==t.G||2==t.G||t.C>=(t.Za?0:t.$a))&&(t.m=Zt(w(t.Ja,t,e),Hn(t,t.C)),t.C++,!0))}(t,e)||2==s&&Un(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),i){case 1:zn(t,5);break;case 4:zn(t,10);break;case 3:zn(t,6);break;default:zn(t,2)}}function Hn(t,e){let n=t.Xa+Math.floor(Math.random()*t.bb);return t.l||(n*=2),n*e}function zn(t,e){if(t.j.info("Error code "+e),2==e){var n=null;t.l&&(n=null);var s=w(t.kb,t);n||(n=new De("//www.google.com/images/cleardot.gif"),l.location&&"http"==l.location.protocol||Ne(n,"https"),xe(n)),function(t,e){const n=new Kt;if(l.Image){const s=new Image;s.onload=E(cn,n,s,"TestLoadImage: loaded",!0,e),s.onerror=E(cn,n,s,"TestLoadImage: error",!1,e),s.onabort=E(cn,n,s,"TestLoadImage: abort",!1,e),s.ontimeout=E(cn,n,s,"TestLoadImage: timeout",!1,e),l.setTimeout((function(){s.ontimeout&&s.ontimeout()}),1e4),s.src=t}else e(!1)}(n.toString(),s)}else Jt(2);t.G=0,t.l&&t.l.va(e),Gn(t),On(t)}function Gn(t){if(t.G=0,t.la=[],t.l){const e=sn(t.h);0==e.length&&0==t.i.length||(C(t.la,e),C(t.la,t.i),t.h.i.length=0,S(t.i),t.i.length=0),t.l.ua()}}function Qn(t,e,n){var s=n instanceof De?ke(n):new De(n,void 0);if(""!=s.g)e&&(s.g=e+"."+s.g),Re(s,s.m);else{var i=l.location;s=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var r=new De(null,void 0);s&&Ne(r,s),e&&(r.g=e),i&&Re(r,i),n&&(r.l=n),s=r}return n=t.D,e=t.za,n&&e&&Oe(s,n,e),Oe(s,"VER",t.ma),Pn(t,s),s}function Wn(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Da&&!t.ra?new mn(new un({jb:!0})):new mn(t.ra)).Ka(t.H),e}function Xn(){}function Yn(){if(P&&!(10<=Number(X)))throw Error("Environmental error: no available transport.")}function Jn(t,e){bt.call(this),this.g=new Nn(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.S=t,(t=e&&e.Yb)&&!D(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!D(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new ts(this)}function $n(t){ae.call(this);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Zn(){ce.call(this),this.status=1}function ts(t){this.g=t}(s=mn.prototype).Ka=function(t){this.L=t},s.da=function(t,e,n,s){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():re.g(),this.C=this.u?se(this.u):se(re),this.g.onreadystatechange=w(this.Ha,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(r){return void En(this,r)}if(t=n||"",n=new Map(this.headers),s)if(Object.getPrototypeOf(s)===Object.prototype)for(var i in s)n.set(i,s[i]);else{if("function"!==typeof s.keys||"function"!==typeof s.get)throw Error("Unknown input type for opt_headers: "+String(s));for(const t of s.keys())n.set(t,s.get(t))}s=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),i=l.FormData&&t instanceof l.FormData,!(0<=I(wn,e))||s||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[o,a]of n)this.g.setRequestHeader(o,a);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Sn(this),0<this.B&&((this.K=function(t){return P&&Q()&&"number"===typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=w(this.qa,this)):this.A=Pt(this.qa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(r){En(this,r)}},s.qa=function(){"undefined"!=typeof h&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Tt(this,"timeout"),this.abort(8))},s.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Tt(this,"complete"),Tt(this,"abort"),In(this))},s.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),In(this,!0)),mn.X.M.call(this)},s.Ha=function(){this.s||(this.F||this.v||this.l?Tn(this):this.fb())},s.fb=function(){Tn(this)},s.aa=function(){try{return 2<Cn(this)?this.g.status:-1}catch(Ye){return-1}},s.fa=function(){try{return this.g?this.g.responseText:""}catch(Ye){return""}},s.Sa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),gn(e)}},s.Ea=function(){return this.m},s.Oa=function(){return"string"===typeof this.j?this.j:String(this.j)},(s=Nn.prototype).ma=8,s.G=1,s.Ja=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const i=new he(this,this.j,t,void 0);let r=this.s;if(this.S&&(r?(r=st(r),rt(r,this.S)):r=this.S),null!==this.o||this.N||(i.H=r,r=null),this.O)t:{for(var e=0,n=0;n<this.i.length;n++){var s=this.i[n];if(void 0===(s="__data__"in s.g&&"string"===typeof(s=s.g.__data__)?s.length:void 0))break;if(4096<(e+=s)){e=n;break t}if(4096===e||n===this.i.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=Fn(this,i,e),Oe(n=ke(this.F),"RID",t),Oe(n,"CVER",22),this.D&&Oe(n,"X-HTTP-Session-Id",this.D),Pn(this,n),r&&(this.N?e="headers="+encodeURIComponent(String(_n(r)))+"&"+e:this.o&&Dn(n,this.o,r)),en(this.h,i),this.Ya&&Oe(n,"TYPE","init"),this.O?(Oe(n,"$req",e),Oe(n,"SID","null"),i.Z=!0,ge(i,n,null)):ge(i,n,e),this.G=2}}else 3==this.G&&(t?Mn(this,t):0==this.i.length||$e(this.h)||Mn(this))},s.Ia=function(){if(this.u=null,qn(this),this.$&&!(this.K||null==this.g||0>=this.P)){var t=2*this.P;this.j.info("BP detection timer enabled: "+t),this.B=Zt(w(this.eb,this),t)}},s.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,Jt(10),Ln(this),qn(this))},s.cb=function(){null!=this.v&&(this.v=null,Ln(this),Un(this),Jt(19))},s.kb=function(t){t?(this.j.info("Successfully pinged google.com"),Jt(2)):(this.j.info("Failed to ping google.com"),Jt(1))},(s=Xn.prototype).xa=function(){},s.wa=function(){},s.va=function(){},s.ua=function(){},s.Ra=function(){},Yn.prototype.g=function(t,e){return new Jn(t,e)},b(Jn,bt),Jn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;Jt(0),t.V=e,t.ia=n||{},t.L=t.Y,t.F=Qn(t,null,t.V),xn(t)},Jn.prototype.close=function(){Rn(this.g)},Jn.prototype.u=function(t){var e=this.g;if("string"===typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=St(t),t=n);e.i.push(new class{constructor(t,e){this.h=t,this.g=e}}(e.ab++,t)),3==e.G&&xn(e)},Jn.prototype.M=function(){this.g.l=null,delete this.j,Rn(this.g),delete this.g,Jn.X.M.call(this)},b($n,ae),b(Zn,ce),b(ts,Xn),ts.prototype.xa=function(){Tt(this.g,"a")},ts.prototype.wa=function(t){Tt(this.g,new $n(t))},ts.prototype.va=function(t){Tt(this.g,new Zn)},ts.prototype.ua=function(){Tt(this.g,"b")},Yn.prototype.createWebChannel=Yn.prototype.g,Jn.prototype.send=Jn.prototype.u,Jn.prototype.open=Jn.prototype.m,Jn.prototype.close=Jn.prototype.close,te.NO_ERROR=0,te.TIMEOUT=8,te.HTTP_ERROR=6,ee.COMPLETE="complete",ie.EventType=oe,oe.OPEN="a",oe.CLOSE="b",oe.ERROR="c",oe.MESSAGE="d",bt.prototype.listen=bt.prototype.N,mn.prototype.listenOnce=mn.prototype.O,mn.prototype.getLastError=mn.prototype.Oa,mn.prototype.getLastErrorCode=mn.prototype.Ea,mn.prototype.getStatus=mn.prototype.aa,mn.prototype.getResponseJson=mn.prototype.Sa,mn.prototype.getResponseText=mn.prototype.fa,mn.prototype.send=mn.prototype.da,mn.prototype.setWithCredentials=mn.prototype.Ka;var es=u.createWebChannelTransport=function(){return new Yn},ns=u.getStatEventTarget=function(){return Qt()},ss=u.ErrorCode=te,is=u.EventType=ee,rs=u.Event=zt,os=u.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},as=u.FetchXmlHttpFactory=un,cs=u.WebChannel=ie,us=u.XhrIo=mn;const hs="@firebase/firestore";class ls{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}ls.UNAUTHENTICATED=new ls(null),ls.GOOGLE_CREDENTIALS=new ls("google-credentials-uid"),ls.FIRST_PARTY=new ls("first-party-uid"),ls.MOCK_USER=new ls("mock-user");let ds="9.17.1";const fs=new o.Yd("@firebase/firestore");function ps(){return fs.logLevel}function gs(t){if(fs.logLevel<=o.in.DEBUG){for(var e=arguments.length,n=new Array(e>1?e-1:0),s=1;s<e;s++)n[s-1]=arguments[s];const i=n.map(vs);fs.debug("Firestore (".concat(ds,"): ").concat(t),...i)}}function ms(t){if(fs.logLevel<=o.in.ERROR){for(var e=arguments.length,n=new Array(e>1?e-1:0),s=1;s<e;s++)n[s-1]=arguments[s];const i=n.map(vs);fs.error("Firestore (".concat(ds,"): ").concat(t),...i)}}function ys(t){if(fs.logLevel<=o.in.WARN){for(var e=arguments.length,n=new Array(e>1?e-1:0),s=1;s<e;s++)n[s-1]=arguments[s];const i=n.map(vs);fs.warn("Firestore (".concat(ds,"): ").concat(t),...i)}}function vs(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function ws(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state";const e="FIRESTORE (".concat(ds,") INTERNAL ASSERTION FAILED: ")+t;throw ms(e),new Error(e)}function Es(t,e){t||ws()}function bs(t,e){return t}const Ts={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Is extends a.ZR{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class Ss{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class Cs{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}}class As{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(ls.UNAUTHENTICATED)))}shutdown(){}}class _s{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class Ds{constructor(t){this.t=t,this.currentUser=ls.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const s=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let i=new Ss;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ss,t.enqueueRetryable((()=>s(this.currentUser)))};const r=()=>{const e=i;t.enqueueRetryable((async()=>{await e.promise,await s(this.currentUser)}))},o=t=>{gs("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),r()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(gs("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ss)}}),0),r()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(gs("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(Es("string"==typeof e.accessToken),new Cs(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Es(null===t||"string"==typeof t),new ls(t)}}class ks{constructor(t,e,n,s){this.h=t,this.l=e,this.m=n,this.g=s,this.type="FirstParty",this.user=ls.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(Es(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.p.set("Authorization",t),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class Ns{constructor(t,e,n,s){this.h=t,this.l=e,this.m=n,this.g=s}getToken(){return Promise.resolve(new ks(this.h,this.l,this.m,this.g))}start(t,e){t.enqueueRetryable((()=>e(ls.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Rs{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ls{constructor(t){this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(t,e){const n=t=>{null!=t.error&&gs("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(t.error.message));const n=t.token!==this.A;return this.A=t.token,gs("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const s=t=>{gs("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.T.onInit((t=>s(t))),setTimeout((()=>{if(!this.appCheck){const t=this.T.getImmediate({optional:!0});t?s(t):gs("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(Es("string"==typeof t.token),this.A=t.token,new Rs(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Os(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}class xs{static R(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const s=Os(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<e&&(n+=t.charAt(s[i]%t.length))}return n}}function Ms(t,e){return t<e?-1:t>e?1:0}function Ps(t,e,n){return t.length===e.length&&t.every(((t,s)=>n(t,e[s])))}class Fs{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Is(Ts.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Is(Ts.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Is(Ts.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Is(Ts.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Fs.fromMillis(Date.now())}static fromDate(t){return Fs.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new Fs(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Ms(this.nanoseconds,t.nanoseconds):Ms(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Vs{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Vs(t)}static min(){return new Vs(new Fs(0,0))}static max(){return new Vs(new Fs(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Us{constructor(t,e,n){void 0===e?e=0:e>t.length&&ws(),void 0===n?n=t.length-e:n>t.length-e&&ws(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===Us.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Us?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const n=t.get(s),i=e.get(s);if(n<i)return-1;if(n>i)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Bs extends Us{construct(t,e,n){return new Bs(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(){const t=[];for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];for(const i of n){if(i.indexOf("//")>=0)throw new Is(Ts.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));t.push(...i.split("/").filter((t=>t.length>0)))}return new Bs(t)}static emptyPath(){return new Bs([])}}const qs=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class js extends Us{construct(t,e,n){return new js(t,e,n)}static isValidIdentifier(t){return qs.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),js.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new js(["__name__"])}static fromServerFormat(t){const e=[];let n="",s=0;const i=()=>{if(0===n.length)throw new Is(Ts.INVALID_ARGUMENT,"Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));e.push(n),n=""};let r=!1;for(;s<t.length;){const e=t[s];if("\\"===e){if(s+1===t.length)throw new Is(Ts.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[s+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new Is(Ts.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,s+=2}else"`"===e?(r=!r,s++):"."!==e||r?(n+=e,s++):(i(),s++)}if(i(),r)throw new Is(Ts.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new js(e)}static emptyPath(){return new js([])}}class Ks{constructor(t){this.path=t}static fromPath(t){return new Ks(Bs.fromString(t))}static fromName(t){return new Ks(Bs.fromString(t).popFirst(5))}static empty(){return new Ks(Bs.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Bs.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Bs.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Ks(new Bs(t.slice()))}}class Hs{constructor(t,e,n,s){this.indexId=t,this.collectionGroup=e,this.fields=n,this.indexState=s}}Hs.UNKNOWN_ID=-1;function zs(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,i=Vs.fromTimestamp(1e9===s?new Fs(n+1,0):new Fs(n,s));return new Qs(i,Ks.empty(),e)}function Gs(t){return new Qs(t.readTime,t.key,-1)}class Qs{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new Qs(Vs.min(),Ks.empty(),-1)}static max(){return new Qs(Vs.max(),Ks.empty(),-1)}}function Ws(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=Ks.comparator(t.documentKey,e.documentKey),0!==n?n:Ms(t.largestBatchId,e.largestBatchId))}const Xs="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ys{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Js(t){if(t.code!==Ts.FAILED_PRECONDITION||t.message!==Xs)throw t;gs("LocalStore","Unexpectedly lost primary lease")}class $s{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&ws(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new $s(((n,s)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,s)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,s)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof $s?e:$s.resolve(e)}catch(t){return $s.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):$s.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):$s.reject(e)}static resolve(t){return new $s(((e,n)=>{e(t)}))}static reject(t){return new $s(((e,n)=>{n(t)}))}static waitFor(t){return new $s(((e,n)=>{let s=0,i=0,r=!1;t.forEach((t=>{++s,t.next((()=>{++i,r&&i===s&&e()}),(t=>n(t)))})),r=!0,i===s&&e()}))}static or(t){let e=$s.resolve(!1);for(const n of t)e=e.next((t=>t?$s.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,s)=>{n.push(e.call(this,t,s))})),this.waitFor(n)}static mapArray(t,e){return new $s(((n,s)=>{const i=t.length,r=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;e(t[c]).next((t=>{r[c]=t,++o,o===i&&n(r)}),(t=>s(t)))}}))}static doWhile(t,e){return new $s(((n,s)=>{const i=()=>{!0===t()?e().next((()=>{i()}),s):n()};i()}))}}function Zs(t){return"IndexedDbTransactionError"===t.name}class ti{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.ut(t),this.ct=t=>e.writeSequenceNumber(t))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}ti.at=-1;class ei{constructor(t,e,n,s,i,r,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=r,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class ni{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new ni("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof ni&&t.projectId===this.projectId&&t.database===this.database}}function si(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ii(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ri(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function oi(t){return null==t}function ai(t){return 0===t&&1/t==-1/0}function ci(t){return"number"==typeof t&&Number.isInteger(t)&&!ai(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}class ui{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new ui(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new ui(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Ms(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}ui.EMPTY_BYTE_STRING=new ui("");const hi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function li(t){if(Es(!!t),"string"==typeof t){let e=0;const n=hi.exec(t);if(Es(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:di(t.seconds),nanos:di(t.nanos)}}function di(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function fi(t){return"string"==typeof t?ui.fromBase64String(t):ui.fromUint8Array(t)}function pi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function gi(t){const e=t.mapValue.fields.__previous_value__;return pi(e)?gi(e):e}function mi(t){const e=li(t.mapValue.fields.__local_write_time__.timestampValue);return new Fs(e.seconds,e.nanos)}const yi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function vi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?pi(t)?4:Ri(t)?9007199254740991:10:ws()}function wi(t,e){if(t===e)return!0;const n=vi(t);if(n!==vi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return mi(t).isEqual(mi(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=li(t.timestampValue),s=li(e.timestampValue);return n.seconds===s.seconds&&n.nanos===s.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return fi(t.bytesValue).isEqual(fi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return di(t.geoPointValue.latitude)===di(e.geoPointValue.latitude)&&di(t.geoPointValue.longitude)===di(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return di(t.integerValue)===di(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=di(t.doubleValue),s=di(e.doubleValue);return n===s?ai(n)===ai(s):isNaN(n)&&isNaN(s)}return!1}(t,e);case 9:return Ps(t.arrayValue.values||[],e.arrayValue.values||[],wi);case 10:return function(t,e){const n=t.mapValue.fields||{},s=e.mapValue.fields||{};if(si(n)!==si(s))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===s[i]||!wi(n[i],s[i])))return!1;return!0}(t,e);default:return ws()}}function Ei(t,e){return void 0!==(t.values||[]).find((t=>wi(t,e)))}function bi(t,e){if(t===e)return 0;const n=vi(t),s=vi(e);if(n!==s)return Ms(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ms(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=di(t.integerValue||t.doubleValue),s=di(e.integerValue||e.doubleValue);return n<s?-1:n>s?1:n===s?0:isNaN(n)?isNaN(s)?0:-1:1}(t,e);case 3:return Ti(t.timestampValue,e.timestampValue);case 4:return Ti(mi(t),mi(e));case 5:return Ms(t.stringValue,e.stringValue);case 6:return function(t,e){const n=fi(t),s=fi(e);return n.compareTo(s)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),s=e.split("/");for(let i=0;i<n.length&&i<s.length;i++){const t=Ms(n[i],s[i]);if(0!==t)return t}return Ms(n.length,s.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=Ms(di(t.latitude),di(e.latitude));return 0!==n?n:Ms(di(t.longitude),di(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],s=e.values||[];for(let i=0;i<n.length&&i<s.length;++i){const t=bi(n[i],s[i]);if(t)return t}return Ms(n.length,s.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===yi.mapValue&&e===yi.mapValue)return 0;if(t===yi.mapValue)return 1;if(e===yi.mapValue)return-1;const n=t.fields||{},s=Object.keys(n),i=e.fields||{},r=Object.keys(i);s.sort(),r.sort();for(let o=0;o<s.length&&o<r.length;++o){const t=Ms(s[o],r[o]);if(0!==t)return t;const e=bi(n[s[o]],i[r[o]]);if(0!==e)return e}return Ms(s.length,r.length)}(t.mapValue,e.mapValue);default:throw ws()}}function Ti(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ms(t,e);const n=li(t),s=li(e),i=Ms(n.seconds,s.seconds);return 0!==i?i:Ms(n.nanos,s.nanos)}function Ii(t){return Si(t)}function Si(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=li(t);return"time(".concat(e.seconds,",").concat(e.nanos,")")}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?fi(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Ks.fromName(n).toString()):"geoPointValue"in t?"geo(".concat((e=t.geoPointValue).latitude,",").concat(e.longitude,")"):"arrayValue"in t?function(t){let e="[",n=!0;for(const s of t.values||[])n?n=!1:e+=",",e+=Si(s);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",s=!0;for(const i of e)s?s=!1:n+=",",n+="".concat(i,":").concat(Si(t.fields[i]));return n+"}"}(t.mapValue):ws();var e,n}function Ci(t){return!!t&&"integerValue"in t}function Ai(t){return!!t&&"arrayValue"in t}function _i(t){return!!t&&"nullValue"in t}function Di(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ki(t){return!!t&&"mapValue"in t}function Ni(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ii(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Ni(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ni(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Ri(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class Li{constructor(t,e){this.position=t,this.inclusive=e}}function Oi(t,e,n){let s=0;for(let i=0;i<t.position.length;i++){const r=e[i],o=t.position[i];if(s=r.field.isKeyField()?Ks.comparator(Ks.fromName(o.referenceValue),n.key):bi(o,n.data.field(r.field)),"desc"===r.dir&&(s*=-1),0!==s)break}return s}function xi(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!wi(t.position[n],e.position[n]))return!1;return!0}class Mi{}class Pi extends Mi{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new Hi(t,e,n):"array-contains"===e?new Wi(t,n):"in"===e?new Xi(t,n):"not-in"===e?new Yi(t,n):"array-contains-any"===e?new Ji(t,n):new Pi(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new zi(t,n):new Gi(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(bi(e,this.value)):null!==e&&vi(this.value)===vi(e)&&this.matchesComparison(bi(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return ws()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Fi extends Mi{constructor(t,e){super(),this.filters=t,this.op=e,this.ht=null}static create(t,e){return new Fi(t,e)}matches(t){return Vi(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.ht||(this.ht=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.ht}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const t=this.lt((t=>t.isInequality()));return null!==t?t.field:null}lt(t){for(const e of this.getFlattenedFilters())if(t(e))return e;return null}}function Vi(t){return"and"===t.op}function Ui(t){return Bi(t)&&Vi(t)}function Bi(t){for(const e of t.filters)if(e instanceof Fi)return!1;return!0}function qi(t){if(t instanceof Pi)return t.field.canonicalString()+t.op.toString()+Ii(t.value);if(Ui(t))return t.filters.map((t=>qi(t))).join(",");{const e=t.filters.map((t=>qi(t))).join(",");return"".concat(t.op,"(").concat(e,")")}}function ji(t,e){return t instanceof Pi?function(t,e){return e instanceof Pi&&t.op===e.op&&t.field.isEqual(e.field)&&wi(t.value,e.value)}(t,e):t instanceof Fi?function(t,e){return e instanceof Fi&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,s)=>t&&ji(n,e.filters[s])),!0)}(t,e):void ws()}function Ki(t){return t instanceof Pi?function(t){return"".concat(t.field.canonicalString()," ").concat(t.op," ").concat(Ii(t.value))}(t):t instanceof Fi?function(t){return t.op.toString()+" {"+t.getFilters().map(Ki).join(" ,")+"}"}(t):"Filter"}class Hi extends Pi{constructor(t,e,n){super(t,e,n),this.key=Ks.fromName(n.referenceValue)}matches(t){const e=Ks.comparator(t.key,this.key);return this.matchesComparison(e)}}class zi extends Pi{constructor(t,e){super(t,"in",e),this.keys=Qi("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Gi extends Pi{constructor(t,e){super(t,"not-in",e),this.keys=Qi("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Qi(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>Ks.fromName(t.referenceValue)))}class Wi extends Pi{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Ai(e)&&Ei(e.arrayValue,this.value)}}class Xi extends Pi{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Ei(this.value.arrayValue,e)}}class Yi extends Pi{constructor(t,e){super(t,"not-in",e)}matches(t){if(Ei(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Ei(this.value.arrayValue,e)}}class Ji extends Pi{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Ai(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Ei(this.value.arrayValue,t)))}}class $i{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=t,this.dir=e}}function Zi(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class tr{constructor(t,e){this.comparator=t,this.root=e||nr.EMPTY}insert(t,e){return new tr(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,nr.BLACK,null,null))}remove(t){return new tr(this.comparator,this.root.remove(t,this.comparator).copy(null,null,nr.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(t,n.key);if(0===s)return e+n.left.size;s<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push("".concat(e,":").concat(n)),!1))),"{".concat(t.join(", "),"}")}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new er(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new er(this.root,t,this.comparator,!1)}getReverseIterator(){return new er(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new er(this.root,t,this.comparator,!0)}}class er{constructor(t,e,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?n(t.key,e):1,e&&s&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class nr{constructor(t,e,n,s,i){this.key=t,this.value=e,this.color=null!=n?n:nr.RED,this.left=null!=s?s:nr.EMPTY,this.right=null!=i?i:nr.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,s,i){return new nr(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=s?s:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let s=this;const i=n(t,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(t,e,n),null):0===i?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return nr.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===e(t,s.key)){if(s.right.isEmpty())return nr.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,nr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,nr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ws();if(this.right.isRed())throw ws();const t=this.left.check();if(t!==this.right.check())throw ws();return t+(this.isRed()?0:1)}}nr.EMPTY=null,nr.RED=!0,nr.BLACK=!1,nr.EMPTY=new class{constructor(){this.size=0}get key(){throw ws()}get value(){throw ws()}get color(){throw ws()}get left(){throw ws()}get right(){throw ws()}copy(t,e,n,s,i){return this}insert(t,e,n){return new nr(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class sr{constructor(t){this.comparator=t,this.data=new tr(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new ir(this.data.getIterator())}getIteratorFrom(t){return new ir(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof sr))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,s=n.getNext().key;if(0!==this.comparator(t,s))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new sr(this.comparator);return e.data=t,e}}class ir{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class rr{constructor(t){this.fields=t,t.sort(js.comparator)}static empty(){return new rr([])}unionWith(t){let e=new sr(js.comparator);for(const n of this.fields)e=e.add(n);for(const n of t)e=e.add(n);return new rr(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Ps(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class or{constructor(t){this.value=t}static empty(){return new or({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!ki(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ni(e)}setAll(t){let e=js.emptyPath(),n={},s=[];t.forEach(((t,i)=>{if(!e.isImmediateParentOf(i)){const t=this.getFieldsMap(e);this.applyChanges(t,n,s),n={},s=[],e=i.popLast()}t?n[i.lastSegment()]=Ni(t):s.push(i.lastSegment())}));const i=this.getFieldsMap(e);this.applyChanges(i,n,s)}delete(t){const e=this.field(t.popLast());ki(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return wi(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let s=e.mapValue.fields[t.get(n)];ki(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,n){ii(e,((e,n)=>t[e]=n));for(const s of n)delete t[s]}clone(){return new or(Ni(this.value))}}function ar(t){const e=[];return ii(t.fields,((t,n)=>{const s=new js([t]);if(ki(n)){const t=ar(n.mapValue).fields;if(0===t.length)e.push(s);else for(const n of t)e.push(s.child(n))}else e.push(s)})),new rr(e)}class cr{constructor(t,e,n,s,i,r,o){this.key=t,this.documentType=e,this.version=n,this.readTime=s,this.createTime=i,this.data=r,this.documentState=o}static newInvalidDocument(t){return new cr(t,0,Vs.min(),Vs.min(),Vs.min(),or.empty(),0)}static newFoundDocument(t,e,n,s){return new cr(t,1,e,Vs.min(),n,s,0)}static newNoDocument(t,e){return new cr(t,2,e,Vs.min(),Vs.min(),or.empty(),0)}static newUnknownDocument(t,e){return new cr(t,3,e,Vs.min(),Vs.min(),or.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Vs.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=or.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=or.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Vs.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof cr&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new cr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class ur{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=r,this.endAt=o,this.ft=null}}function hr(t){return new ur(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function lr(t){const e=bs(t);if(null===e.ft){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>qi(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),oi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>Ii(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>Ii(t))).join(",")),e.ft=t}return e.ft}function dr(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Zi(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!ji(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!xi(t.startAt,e.startAt)&&xi(t.endAt,e.endAt)}function fr(t){return Ks.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class pr{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=r,this.startAt=o,this.endAt=a,this.dt=null,this._t=null,this.startAt,this.endAt}}function gr(t,e,n,s,i,r,o,a){return new pr(t,e,n,s,i,r,o,a)}function mr(t){return new pr(t)}function yr(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function vr(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function wr(t){for(const e of t.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function Er(t){return null!==t.collectionGroup}function br(t){const e=bs(t);if(null===e.dt){e.dt=[];const t=wr(e),n=vr(e);if(null!==t&&null===n)t.isKeyField()||e.dt.push(new $i(t)),e.dt.push(new $i(js.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e.dt.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.dt.push(new $i(js.keyField(),t))}}}return e.dt}function Tr(t){const e=bs(t);if(!e._t)if("F"===e.limitType)e._t=hr(e.path,e.collectionGroup,br(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const i of br(e)){const e="desc"===i.dir?"asc":"desc";t.push(new $i(i.field,e))}const n=e.endAt?new Li(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new Li(e.startAt.position,e.startAt.inclusive):null;e._t=hr(e.path,e.collectionGroup,t,e.filters,e.limit,n,s)}return e._t}function Ir(t,e,n){return new pr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Sr(t,e){return dr(Tr(t),Tr(e))&&t.limitType===e.limitType}function Cr(t){return"".concat(lr(Tr(t)),"|lt:").concat(t.limitType)}function Ar(t){return"Query(target=".concat(function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: [".concat(t.filters.map((t=>Ki(t))).join(", "),"]")),oi(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: [".concat(t.orderBy.map((t=>function(t){return"".concat(t.field.canonicalString()," (").concat(t.dir,")")}(t))).join(", "),"]")),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>Ii(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>Ii(t))).join(",")),"Target(".concat(e,")")}(Tr(t)),"; limitType=").concat(t.limitType,")")}function _r(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Ks.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of br(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const s=Oi(t,e,n);return t.inclusive?s<=0:s<0}(t.startAt,br(t),e))&&!(t.endAt&&!function(t,e,n){const s=Oi(t,e,n);return t.inclusive?s>=0:s>0}(t.endAt,br(t),e))}(t,e)}function Dr(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function kr(t){return(e,n)=>{let s=!1;for(const i of br(t)){const t=Nr(i,e,n);if(0!==t)return t;s=s||i.field.isKeyField()}return 0}}function Nr(t,e,n){const s=t.field.isKeyField()?Ks.comparator(e.key,n.key):function(t,e,n){const s=e.data.field(t),i=n.data.field(t);return null!==s&&null!==i?bi(s,i):ws()}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return ws()}}function Rr(t,e){if(t.wt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ai(e)?"-0":e}}function Lr(t){return{integerValue:""+t}}function Or(t,e){return ci(e)?Lr(e):Rr(t,e)}class xr{constructor(){this._=void 0}}function Mr(t,e,n){return t instanceof Vr?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ur?Br(t,e):t instanceof qr?jr(t,e):function(t,e){const n=Fr(t,e),s=Hr(n)+Hr(t.gt);return Ci(n)&&Ci(t.gt)?Lr(s):Rr(t.yt,s)}(t,e)}function Pr(t,e,n){return t instanceof Ur?Br(t,e):t instanceof qr?jr(t,e):n}function Fr(t,e){return t instanceof Kr?Ci(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}class Vr extends xr{}class Ur extends xr{constructor(t){super(),this.elements=t}}function Br(t,e){const n=zr(e);for(const s of t.elements)n.some((t=>wi(t,s)))||n.push(s);return{arrayValue:{values:n}}}class qr extends xr{constructor(t){super(),this.elements=t}}function jr(t,e){let n=zr(e);for(const s of t.elements)n=n.filter((t=>!wi(t,s)));return{arrayValue:{values:n}}}class Kr extends xr{constructor(t,e){super(),this.yt=t,this.gt=e}}function Hr(t){return di(t.integerValue||t.doubleValue)}function zr(t){return Ai(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Gr{constructor(t,e){this.field=t,this.transform=e}}class Qr{constructor(t,e){this.version=t,this.transformResults=e}}class Wr{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Wr}static exists(t){return new Wr(void 0,t)}static updateTime(t){return new Wr(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Xr(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Yr{}function Jr(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new ao(t.key,Wr.none()):new no(t.key,t.data,Wr.none());{const n=t.data,s=or.empty();let i=new sr(js.comparator);for(let t of e.fields)if(!i.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?s.delete(t):s.set(t,e),i=i.add(t)}return new so(t.key,s,new rr(i.toArray()),Wr.none())}}function $r(t,e,n){t instanceof no?function(t,e,n){const s=t.value.clone(),i=ro(t.fieldTransforms,e,n.transformResults);s.setAll(i),e.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(t,e,n):t instanceof so?function(t,e,n){if(!Xr(t.precondition,e))return void e.convertToUnknownDocument(n.version);const s=ro(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(io(t)),i.setAll(s),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Zr(t,e,n,s){return t instanceof no?function(t,e,n,s){if(!Xr(t.precondition,e))return n;const i=t.value.clone(),r=oo(t.fieldTransforms,s,e);return i.setAll(r),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null}(t,e,n,s):t instanceof so?function(t,e,n,s){if(!Xr(t.precondition,e))return n;const i=oo(t.fieldTransforms,s,e),r=e.data;return r.setAll(io(t)),r.setAll(i),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,s):function(t,e,n){return Xr(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function to(t,e){let n=null;for(const s of t.fieldTransforms){const t=e.data.field(s.field),i=Fr(s.transform,t||null);null!=i&&(null===n&&(n=or.empty()),n.set(s.field,i))}return n||null}function eo(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Ps(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ur&&e instanceof Ur||t instanceof qr&&e instanceof qr?Ps(t.elements,e.elements,wi):t instanceof Kr&&e instanceof Kr?wi(t.gt,e.gt):t instanceof Vr&&e instanceof Vr}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class no extends Yr{constructor(t,e,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class so extends Yr{constructor(t,e,n,s){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function io(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}})),e}function ro(t,e,n){const s=new Map;Es(t.length===n.length);for(let i=0;i<n.length;i++){const r=t[i],o=r.transform,a=e.data.field(r.field);s.set(r.field,Pr(o,a,n[i]))}return s}function oo(t,e,n){const s=new Map;for(const i of t){const t=i.transform,r=n.data.field(i.field);s.set(i.field,Mr(t,r,e))}return s}class ao extends Yr{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class co extends Yr{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class uo{constructor(t){this.count=t}}var ho,lo;function fo(t){switch(t){default:return ws();case Ts.CANCELLED:case Ts.UNKNOWN:case Ts.DEADLINE_EXCEEDED:case Ts.RESOURCE_EXHAUSTED:case Ts.INTERNAL:case Ts.UNAVAILABLE:case Ts.UNAUTHENTICATED:return!1;case Ts.INVALID_ARGUMENT:case Ts.NOT_FOUND:case Ts.ALREADY_EXISTS:case Ts.PERMISSION_DENIED:case Ts.FAILED_PRECONDITION:case Ts.ABORTED:case Ts.OUT_OF_RANGE:case Ts.UNIMPLEMENTED:case Ts.DATA_LOSS:return!0}}function po(t){if(void 0===t)return ms("GRPC error has no .code"),Ts.UNKNOWN;switch(t){case ho.OK:return Ts.OK;case ho.CANCELLED:return Ts.CANCELLED;case ho.UNKNOWN:return Ts.UNKNOWN;case ho.DEADLINE_EXCEEDED:return Ts.DEADLINE_EXCEEDED;case ho.RESOURCE_EXHAUSTED:return Ts.RESOURCE_EXHAUSTED;case ho.INTERNAL:return Ts.INTERNAL;case ho.UNAVAILABLE:return Ts.UNAVAILABLE;case ho.UNAUTHENTICATED:return Ts.UNAUTHENTICATED;case ho.INVALID_ARGUMENT:return Ts.INVALID_ARGUMENT;case ho.NOT_FOUND:return Ts.NOT_FOUND;case ho.ALREADY_EXISTS:return Ts.ALREADY_EXISTS;case ho.PERMISSION_DENIED:return Ts.PERMISSION_DENIED;case ho.FAILED_PRECONDITION:return Ts.FAILED_PRECONDITION;case ho.ABORTED:return Ts.ABORTED;case ho.OUT_OF_RANGE:return Ts.OUT_OF_RANGE;case ho.UNIMPLEMENTED:return Ts.UNIMPLEMENTED;case ho.DATA_LOSS:return Ts.DATA_LOSS;default:return ws()}}(lo=ho||(ho={}))[lo.OK=0]="OK",lo[lo.CANCELLED=1]="CANCELLED",lo[lo.UNKNOWN=2]="UNKNOWN",lo[lo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",lo[lo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",lo[lo.NOT_FOUND=5]="NOT_FOUND",lo[lo.ALREADY_EXISTS=6]="ALREADY_EXISTS",lo[lo.PERMISSION_DENIED=7]="PERMISSION_DENIED",lo[lo.UNAUTHENTICATED=16]="UNAUTHENTICATED",lo[lo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",lo[lo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",lo[lo.ABORTED=10]="ABORTED",lo[lo.OUT_OF_RANGE=11]="OUT_OF_RANGE",lo[lo.UNIMPLEMENTED=12]="UNIMPLEMENTED",lo[lo.INTERNAL=13]="INTERNAL",lo[lo.UNAVAILABLE=14]="UNAVAILABLE",lo[lo.DATA_LOSS=15]="DATA_LOSS";class go{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[s,i]of n)if(this.equalsFn(s,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),s=this.inner[n];if(void 0===s)return this.inner[n]=[[t,e]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],t))return void(s[i]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],t))return 1===n.length?delete this.inner[e]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(t){ii(this.inner,((e,n)=>{for(const[s,i]of n)t(s,i)}))}isEmpty(){return ri(this.inner)}size(){return this.innerSize}}const mo=new tr(Ks.comparator);function yo(){return mo}const vo=new tr(Ks.comparator);function wo(){let t=vo;for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];for(const i of n)t=t.insert(i.key,i);return t}function Eo(t){let e=vo;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function bo(){return Io()}function To(){return Io()}function Io(){return new go((t=>t.toString()),((t,e)=>t.isEqual(e)))}const So=new tr(Ks.comparator),Co=new sr(Ks.comparator);function Ao(){let t=Co;for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];for(const i of n)t=t.add(i);return t}const _o=new sr(Ms);function Do(){return _o}class ko{constructor(t,e,n,s,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const s=new Map;return s.set(t,No.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new ko(Vs.min(),s,Do(),yo(),Ao())}}class No{constructor(t,e,n,s,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new No(n,e,Ao(),Ao(),Ao())}}class Ro{constructor(t,e,n,s){this.It=t,this.removedTargetIds=e,this.key=n,this.Tt=s}}class Lo{constructor(t,e){this.targetId=t,this.Et=e}}class Oo{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ui.EMPTY_BYTE_STRING,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=s}}class xo{constructor(){this.At=0,this.Rt=Fo(),this.bt=ui.EMPTY_BYTE_STRING,this.Pt=!1,this.vt=!0}get current(){return this.Pt}get resumeToken(){return this.bt}get Vt(){return 0!==this.At}get St(){return this.vt}Dt(t){t.approximateByteSize()>0&&(this.vt=!0,this.bt=t)}Ct(){let t=Ao(),e=Ao(),n=Ao();return this.Rt.forEach(((s,i)=>{switch(i){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:n=n.add(s);break;default:ws()}})),new No(this.bt,this.Pt,t,e,n)}xt(){this.vt=!1,this.Rt=Fo()}Nt(t,e){this.vt=!0,this.Rt=this.Rt.insert(t,e)}kt(t){this.vt=!0,this.Rt=this.Rt.remove(t)}Ot(){this.At+=1}Mt(){this.At-=1}Ft(){this.vt=!0,this.Pt=!0}}class Mo{constructor(t){this.$t=t,this.Bt=new Map,this.Lt=yo(),this.qt=Po(),this.Ut=new sr(Ms)}Kt(t){for(const e of t.It)t.Tt&&t.Tt.isFoundDocument()?this.Gt(e,t.Tt):this.Qt(e,t.key,t.Tt);for(const e of t.removedTargetIds)this.Qt(e,t.key,t.Tt)}jt(t){this.forEachTarget(t,(e=>{const n=this.Wt(e);switch(t.state){case 0:this.zt(e)&&n.Dt(t.resumeToken);break;case 1:n.Mt(),n.Vt||n.xt(),n.Dt(t.resumeToken);break;case 2:n.Mt(),n.Vt||this.removeTarget(e);break;case 3:this.zt(e)&&(n.Ft(),n.Dt(t.resumeToken));break;case 4:this.zt(e)&&(this.Ht(e),n.Dt(t.resumeToken));break;default:ws()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Bt.forEach(((t,n)=>{this.zt(n)&&e(n)}))}Jt(t){const e=t.targetId,n=t.Et.count,s=this.Yt(e);if(s){const t=s.target;if(fr(t))if(0===n){const n=new Ks(t.path);this.Qt(e,n,cr.newNoDocument(n,Vs.min()))}else Es(1===n);else this.Xt(e)!==n&&(this.Ht(e),this.Ut=this.Ut.add(e))}}Zt(t){const e=new Map;this.Bt.forEach(((n,s)=>{const i=this.Yt(s);if(i){if(n.current&&fr(i.target)){const e=new Ks(i.target.path);null!==this.Lt.get(e)||this.te(s,e)||this.Qt(s,e,cr.newNoDocument(e,t))}n.St&&(e.set(s,n.Ct()),n.xt())}}));let n=Ao();this.qt.forEach(((t,e)=>{let s=!0;e.forEachWhile((t=>{const e=this.Yt(t);return!e||2===e.purpose||(s=!1,!1)})),s&&(n=n.add(t))})),this.Lt.forEach(((e,n)=>n.setReadTime(t)));const s=new ko(t,e,this.Ut,this.Lt,n);return this.Lt=yo(),this.qt=Po(),this.Ut=new sr(Ms),s}Gt(t,e){if(!this.zt(t))return;const n=this.te(t,e.key)?2:0;this.Wt(t).Nt(e.key,n),this.Lt=this.Lt.insert(e.key,e),this.qt=this.qt.insert(e.key,this.ee(e.key).add(t))}Qt(t,e,n){if(!this.zt(t))return;const s=this.Wt(t);this.te(t,e)?s.Nt(e,1):s.kt(e),this.qt=this.qt.insert(e,this.ee(e).delete(t)),n&&(this.Lt=this.Lt.insert(e,n))}removeTarget(t){this.Bt.delete(t)}Xt(t){const e=this.Wt(t).Ct();return this.$t.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ot(t){this.Wt(t).Ot()}Wt(t){let e=this.Bt.get(t);return e||(e=new xo,this.Bt.set(t,e)),e}ee(t){let e=this.qt.get(t);return e||(e=new sr(Ms),this.qt=this.qt.insert(t,e)),e}zt(t){const e=null!==this.Yt(t);return e||gs("WatchChangeAggregator","Detected inactive target",t),e}Yt(t){const e=this.Bt.get(t);return e&&e.Vt?null:this.$t.ne(t)}Ht(t){this.Bt.set(t,new xo),this.$t.getRemoteKeysForTarget(t).forEach((e=>{this.Qt(t,e,null)}))}te(t,e){return this.$t.getRemoteKeysForTarget(t).has(e)}}function Po(){return new tr(Ks.comparator)}function Fo(){return new tr(Ks.comparator)}const Vo={asc:"ASCENDING",desc:"DESCENDING"},Uo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Bo={and:"AND",or:"OR"};class qo{constructor(t,e){this.databaseId=t,this.wt=e}}function jo(t,e){return t.wt?"".concat(new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+e.nanoseconds).slice(-9),"Z"):{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ko(t,e){return t.wt?e.toBase64():e.toUint8Array()}function Ho(t,e){return jo(t,e.toTimestamp())}function zo(t){return Es(!!t),Vs.fromTimestamp(function(t){const e=li(t);return new Fs(e.seconds,e.nanos)}(t))}function Go(t,e){return function(t){return new Bs(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Qo(t){const e=Bs.fromString(t);return Es(fa(e)),e}function Wo(t,e){return Go(t.databaseId,e.path)}function Xo(t,e){const n=Qo(e);if(n.get(1)!==t.databaseId.projectId)throw new Is(Ts.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Is(Ts.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ks(Zo(n))}function Yo(t,e){return Go(t.databaseId,e)}function Jo(t){const e=Qo(t);return 4===e.length?Bs.emptyPath():Zo(e)}function $o(t){return new Bs(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Zo(t){return Es(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function ta(t,e,n){return{name:Wo(t,e),fields:n.value.mapValue.fields}}function ea(t,e){let n;if(e instanceof no)n={update:ta(t,e.key,e.value)};else if(e instanceof ao)n={delete:Wo(t,e.key)};else if(e instanceof so)n={update:ta(t,e.key,e.data),updateMask:da(e.fieldMask)};else{if(!(e instanceof co))return ws();n={verify:Wo(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof Vr)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ur)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof qr)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Kr)return{fieldPath:e.field.canonicalString(),increment:n.gt};throw ws()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Ho(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:ws()}(t,e.precondition)),n}function na(t,e){return{documents:[Yo(t,e.path)]}}function sa(t,e){const n={structuredQuery:{}},s=e.path;null!==e.collectionGroup?(n.parent=Yo(t,s),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Yo(t,s.popLast()),n.structuredQuery.from=[{collectionId:s.lastSegment()}]);const i=function(t){if(0!==t.length)return la(Fi.create(t,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const r=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:ua(t.field),direction:oa(t.dir)}}(t)))}(e.orderBy);r&&(n.structuredQuery.orderBy=r);const o=function(t,e){return t.wt||oi(e)?e:{value:e}}(t,e.limit);var a;return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),n}function ia(t){let e=Jo(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let i=null;if(s>0){Es(1===s);const t=n.from[0];t.allDescendants?i=t.collectionId:e=e.child(t.collectionId)}let r=[];n.where&&(r=function(t){const e=ra(t);return e instanceof Fi&&Ui(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((t=>function(t){return new $i(ha(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,oi(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new Li(n,e)}(n.startAt));let u=null;return n.endAt&&(u=function(t){const e=!t.before,n=t.values||[];return new Li(n,e)}(n.endAt)),gr(e,i,o,r,a,"F",c,u)}function ra(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=ha(t.unaryFilter.field);return Pi.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=ha(t.unaryFilter.field);return Pi.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ha(t.unaryFilter.field);return Pi.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=ha(t.unaryFilter.field);return Pi.create(i,"!=",{nullValue:"NULL_VALUE"});default:return ws()}}(t):void 0!==t.fieldFilter?function(t){return Pi.create(ha(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ws()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return Fi.create(t.compositeFilter.filters.map((t=>ra(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return ws()}}(t.compositeFilter.op))}(t):ws()}function oa(t){return Vo[t]}function aa(t){return Uo[t]}function ca(t){return Bo[t]}function ua(t){return{fieldPath:t.canonicalString()}}function ha(t){return js.fromServerFormat(t.fieldPath)}function la(t){return t instanceof Pi?function(t){if("=="===t.op){if(Di(t.value))return{unaryFilter:{field:ua(t.field),op:"IS_NAN"}};if(_i(t.value))return{unaryFilter:{field:ua(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Di(t.value))return{unaryFilter:{field:ua(t.field),op:"IS_NOT_NAN"}};if(_i(t.value))return{unaryFilter:{field:ua(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ua(t.field),op:aa(t.op),value:t.value}}}(t):t instanceof Fi?function(t){const e=t.getFilters().map((t=>la(t)));return 1===e.length?e[0]:{compositeFilter:{op:ca(t.op),filters:e}}}(t):ws()}function da(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function fa(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}const pa=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],ga=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],ma=ga;class ya{constructor(t,e,n,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let s=0;s<this.mutations.length;s++){const e=this.mutations[s];e.key.isEqual(t.key)&&$r(e,t,n[s])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=Zr(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=Zr(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=To();return this.mutations.forEach((s=>{const i=t.get(s.key),r=i.overlayedDocument;let o=this.applyToLocalView(r,i.mutatedFields);o=e.has(s.key)?null:o;const a=Jr(r,o);null!==a&&n.set(s.key,a),r.isValidDocument()||r.convertToNoDocument(Vs.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),Ao())}isEqual(t){return this.batchId===t.batchId&&Ps(this.mutations,t.mutations,((t,e)=>eo(t,e)))&&Ps(this.baseMutations,t.baseMutations,((t,e)=>eo(t,e)))}}class va{constructor(t,e,n,s){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=s}static from(t,e,n){Es(t.mutations.length===n.length);let s=So;const i=t.mutations;for(let r=0;r<i.length;r++)s=s.insert(i[r].key,n[r].version);return new va(t,e,n,s)}}class wa{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class Ea{constructor(t,e,n,s){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Vs.min(),r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Vs.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ui.EMPTY_BYTE_STRING;this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=r,this.resumeToken=o}withSequenceNumber(t){return new Ea(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,e){return new Ea(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new Ea(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}class ba{constructor(t){this.ie=t}}function Ta(t){const e=ia({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Ir(e,e.limit,"L"):e}class Ia{constructor(){}ue(t,e){this.ce(t,e),e.ae()}ce(t,e){if("nullValue"in t)this.he(e,5);else if("booleanValue"in t)this.he(e,10),e.le(t.booleanValue?1:0);else if("integerValue"in t)this.he(e,15),e.le(di(t.integerValue));else if("doubleValue"in t){const n=di(t.doubleValue);isNaN(n)?this.he(e,13):(this.he(e,15),ai(n)?e.le(0):e.le(n))}else if("timestampValue"in t){const n=t.timestampValue;this.he(e,20),"string"==typeof n?e.fe(n):(e.fe("".concat(n.seconds||"")),e.le(n.nanos||0))}else if("stringValue"in t)this.de(t.stringValue,e),this._e(e);else if("bytesValue"in t)this.he(e,30),e.we(fi(t.bytesValue)),this._e(e);else if("referenceValue"in t)this.me(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.he(e,45),e.le(n.latitude||0),e.le(n.longitude||0)}else"mapValue"in t?Ri(t)?this.he(e,Number.MAX_SAFE_INTEGER):(this.ge(t.mapValue,e),this._e(e)):"arrayValue"in t?(this.ye(t.arrayValue,e),this._e(e)):ws()}de(t,e){this.he(e,25),this.pe(t,e)}pe(t,e){e.fe(t)}ge(t,e){const n=t.fields||{};this.he(e,55);for(const s of Object.keys(n))this.de(s,e),this.ce(n[s],e)}ye(t,e){const n=t.values||[];this.he(e,50);for(const s of n)this.ce(s,e)}me(t,e){this.he(e,37),Ks.fromName(t).path.forEach((t=>{this.he(e,60),this.pe(t,e)}))}he(t,e){t.le(e)}_e(t){t.le(2)}}Ia.Ie=new Ia;class Sa{constructor(){this.Je=new Ca}addToCollectionParentIndex(t,e){return this.Je.add(e),$s.resolve()}getCollectionParents(t,e){return $s.resolve(this.Je.getEntries(e))}addFieldIndex(t,e){return $s.resolve()}deleteFieldIndex(t,e){return $s.resolve()}getDocumentsMatchingTarget(t,e){return $s.resolve(null)}getIndexType(t,e){return $s.resolve(0)}getFieldIndexes(t,e){return $s.resolve([])}getNextCollectionGroupToUpdate(t){return $s.resolve(null)}getMinOffset(t,e){return $s.resolve(Qs.min())}getMinOffsetFromCollectionGroup(t,e){return $s.resolve(Qs.min())}updateCollectionGroup(t,e,n){return $s.resolve()}updateIndexEntries(t,e){return $s.resolve()}}class Ca{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),s=this.index[e]||new sr(Bs.comparator),i=!s.has(n);return this.index[e]=s.add(n),i}has(t){const e=t.lastSegment(),n=t.popLast(),s=this.index[e];return s&&s.has(n)}getEntries(t){return(this.index[t]||new sr(Bs.comparator)).toArray()}}new Uint8Array(0);class Aa{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new Aa(t,Aa.DEFAULT_COLLECTION_PERCENTILE,Aa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Aa.DEFAULT_COLLECTION_PERCENTILE=10,Aa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Aa.DEFAULT=new Aa(41943040,Aa.DEFAULT_COLLECTION_PERCENTILE,Aa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Aa.DISABLED=new Aa(-1,0,0);class _a{constructor(t){this.bn=t}next(){return this.bn+=2,this.bn}static Pn(){return new _a(0)}static vn(){return new _a(-1)}}class Da{constructor(){this.changes=new go((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,cr.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?$s.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class ka{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class Na{constructor(t,e,n,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=s}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((s=>(n=s,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&Zr(n.mutation,t,rr.empty(),Fs.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,Ao()).next((()=>e))))}getLocalViewOfDocuments(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ao();const s=bo();return this.populateOverlays(t,s,e).next((()=>this.computeViews(t,e,s,n).next((t=>{let e=wo();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=bo();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,Ao())))}populateOverlays(t,e,n){const s=[];return n.forEach((t=>{e.has(t)||s.push(t)})),this.documentOverlayCache.getOverlays(t,s).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,s){let i=yo();const r=Io(),o=Io();return e.forEach(((t,e)=>{const o=n.get(e.key);s.has(e.key)&&(void 0===o||o.mutation instanceof so)?i=i.insert(e.key,e):void 0!==o?(r.set(e.key,o.mutation.getFieldMask()),Zr(o.mutation,e,o.mutation.getFieldMask(),Fs.now())):r.set(e.key,rr.empty())})),this.recalculateAndSaveOverlays(t,i).next((t=>(t.forEach(((t,e)=>r.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new ka(e,null!==(n=r.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=Io();let s=new tr(((t,e)=>t-e)),i=Ao();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const i of t)i.keys().forEach((t=>{const r=e.get(t);if(null===r)return;let o=n.get(t)||rr.empty();o=i.applyToLocalView(r,o),n.set(t,o);const a=(s.get(i.batchId)||Ao()).add(t);s=s.insert(i.batchId,a)}))})).next((()=>{const r=[],o=s.getReverseIterator();for(;o.hasNext();){const s=o.getNext(),a=s.key,c=s.value,u=To();c.forEach((t=>{if(!i.has(t)){const s=Jr(e.get(t),n.get(t));null!==s&&u.set(t,s),i=i.add(t)}})),r.push(this.documentOverlayCache.saveOverlays(t,a,u))}return $s.waitFor(r)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n){return function(t){return Ks.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):Er(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n):this.getDocumentsMatchingCollectionQuery(t,e,n)}getNextDocuments(t,e,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,s).next((i=>{const r=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,s-i.size):$s.resolve(bo());let o=-1,a=i;return r.next((e=>$s.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(e)?$s.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,i))).next((()=>this.computeViews(t,a,e,Ao()))).next((t=>({batchId:o,changes:Eo(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Ks(e)).next((t=>{let e=wo();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n){const s=e.collectionGroup;let i=wo();return this.indexManager.getCollectionParents(t,s).next((r=>$s.forEach(r,(r=>{const o=function(t,e){return new pr(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,r.child(s));return this.getDocumentsMatchingCollectionQuery(t,o,n).next((t=>{t.forEach(((t,e)=>{i=i.insert(t,e)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(t,e,n){let s;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,s)))).next((t=>{s.forEach(((e,n)=>{const s=n.getKey();null===t.get(s)&&(t=t.insert(s,cr.newInvalidDocument(s)))}));let n=wo();return t.forEach(((t,i)=>{const r=s.get(t);void 0!==r&&Zr(r.mutation,i,rr.empty(),Fs.now()),_r(e,i)&&(n=n.insert(t,i))})),n}))}}class Ra{constructor(t){this.yt=t,this.Zn=new Map,this.ts=new Map}getBundleMetadata(t,e){return $s.resolve(this.Zn.get(e))}saveBundleMetadata(t,e){var n;return this.Zn.set(e.id,{id:(n=e).id,version:n.version,createTime:zo(n.createTime)}),$s.resolve()}getNamedQuery(t,e){return $s.resolve(this.ts.get(e))}saveNamedQuery(t,e){return this.ts.set(e.name,function(t){return{name:t.name,query:Ta(t.bundledQuery),readTime:zo(t.readTime)}}(e)),$s.resolve()}}class La{constructor(){this.overlays=new tr(Ks.comparator),this.es=new Map}getOverlay(t,e){return $s.resolve(this.overlays.get(e))}getOverlays(t,e){const n=bo();return $s.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,s)=>{this.oe(t,e,s)})),$s.resolve()}removeOverlaysForBatchId(t,e,n){const s=this.es.get(n);return void 0!==s&&(s.forEach((t=>this.overlays=this.overlays.remove(t))),this.es.delete(n)),$s.resolve()}getOverlaysForCollection(t,e,n){const s=bo(),i=e.length+1,r=new Ks(e.child("")),o=this.overlays.getIteratorFrom(r);for(;o.hasNext();){const t=o.getNext().value,r=t.getKey();if(!e.isPrefixOf(r.path))break;r.path.length===i&&t.largestBatchId>n&&s.set(t.getKey(),t)}return $s.resolve(s)}getOverlaysForCollectionGroup(t,e,n,s){let i=new tr(((t,e)=>t-e));const r=this.overlays.getIterator();for(;r.hasNext();){const t=r.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=i.get(t.largestBatchId);null===e&&(e=bo(),i=i.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=bo(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=s)););return $s.resolve(o)}oe(t,e,n){const s=this.overlays.get(n.key);if(null!==s){const t=this.es.get(s.largestBatchId).delete(n.key);this.es.set(s.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new wa(e,n));let i=this.es.get(e);void 0===i&&(i=Ao(),this.es.set(e,i)),this.es.set(e,i.add(n.key))}}class Oa{constructor(){this.ns=new sr(xa.ss),this.rs=new sr(xa.os)}isEmpty(){return this.ns.isEmpty()}addReference(t,e){const n=new xa(t,e);this.ns=this.ns.add(n),this.rs=this.rs.add(n)}us(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.cs(new xa(t,e))}hs(t,e){t.forEach((t=>this.removeReference(t,e)))}ls(t){const e=new Ks(new Bs([])),n=new xa(e,t),s=new xa(e,t+1),i=[];return this.rs.forEachInRange([n,s],(t=>{this.cs(t),i.push(t.key)})),i}fs(){this.ns.forEach((t=>this.cs(t)))}cs(t){this.ns=this.ns.delete(t),this.rs=this.rs.delete(t)}ds(t){const e=new Ks(new Bs([])),n=new xa(e,t),s=new xa(e,t+1);let i=Ao();return this.rs.forEachInRange([n,s],(t=>{i=i.add(t.key)})),i}containsKey(t){const e=new xa(t,0),n=this.ns.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class xa{constructor(t,e){this.key=t,this._s=e}static ss(t,e){return Ks.comparator(t.key,e.key)||Ms(t._s,e._s)}static os(t,e){return Ms(t._s,e._s)||Ks.comparator(t.key,e.key)}}class Ma{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.ws=1,this.gs=new sr(xa.ss)}checkEmpty(t){return $s.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,s){const i=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const r=new ya(i,e,n,s);this.mutationQueue.push(r);for(const o of s)this.gs=this.gs.add(new xa(o.key,i)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return $s.resolve(r)}lookupMutationBatch(t,e){return $s.resolve(this.ys(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,s=this.ps(n),i=s<0?0:s;return $s.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return $s.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(t){return $s.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new xa(e,0),s=new xa(e,Number.POSITIVE_INFINITY),i=[];return this.gs.forEachInRange([n,s],(t=>{const e=this.ys(t._s);i.push(e)})),$s.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new sr(Ms);return e.forEach((t=>{const e=new xa(t,0),s=new xa(t,Number.POSITIVE_INFINITY);this.gs.forEachInRange([e,s],(t=>{n=n.add(t._s)}))})),$s.resolve(this.Is(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,s=n.length+1;let i=n;Ks.isDocumentKey(i)||(i=i.child(""));const r=new xa(new Ks(i),0);let o=new sr(Ms);return this.gs.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===s&&(o=o.add(t._s)),!0)}),r),$s.resolve(this.Is(o))}Is(t){const e=[];return t.forEach((t=>{const n=this.ys(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){Es(0===this.Ts(e.batchId,"removed")),this.mutationQueue.shift();let n=this.gs;return $s.forEach(e.mutations,(s=>{const i=new xa(s.key,e.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)})).next((()=>{this.gs=n}))}An(t){}containsKey(t,e){const n=new xa(e,0),s=this.gs.firstAfterOrEqual(n);return $s.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,$s.resolve()}Ts(t,e){return this.ps(t)}ps(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}ys(t){const e=this.ps(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class Pa{constructor(t){this.Es=t,this.docs=new tr(Ks.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,s=this.docs.get(n),i=s?s.size:0,r=this.Es(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:r}),this.size+=r-i,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return $s.resolve(n?n.document.mutableCopy():cr.newInvalidDocument(e))}getEntries(t,e){let n=yo();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():cr.newInvalidDocument(t))})),$s.resolve(n)}getDocumentsMatchingQuery(t,e,n,s){let i=yo();const r=e.path,o=new Ks(r.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!r.isPrefixOf(t.path))break;t.path.length>r.length+1||Ws(Gs(o),n)<=0||(s.has(o.key)||_r(e,o))&&(i=i.insert(o.key,o.mutableCopy()))}return $s.resolve(i)}getAllFromCollectionGroup(t,e,n,s){ws()}As(t,e){return $s.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new Fa(this)}getSize(t){return $s.resolve(this.size)}}class Fa extends Da{constructor(t){super(),this.Yn=t}applyChanges(t){const e=[];return this.changes.forEach(((n,s)=>{s.isValidDocument()?e.push(this.Yn.addEntry(t,s)):this.Yn.removeEntry(n)})),$s.waitFor(e)}getFromCache(t,e){return this.Yn.getEntry(t,e)}getAllFromCache(t,e){return this.Yn.getEntries(t,e)}}class Va{constructor(t){this.persistence=t,this.Rs=new go((t=>lr(t)),dr),this.lastRemoteSnapshotVersion=Vs.min(),this.highestTargetId=0,this.bs=0,this.Ps=new Oa,this.targetCount=0,this.vs=_a.Pn()}forEachTarget(t,e){return this.Rs.forEach(((t,n)=>e(n))),$s.resolve()}getLastRemoteSnapshotVersion(t){return $s.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return $s.resolve(this.bs)}allocateTargetId(t){return this.highestTargetId=this.vs.next(),$s.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.bs&&(this.bs=e),$s.resolve()}Dn(t){this.Rs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.vs=new _a(e),this.highestTargetId=e),t.sequenceNumber>this.bs&&(this.bs=t.sequenceNumber)}addTargetData(t,e){return this.Dn(e),this.targetCount+=1,$s.resolve()}updateTargetData(t,e){return this.Dn(e),$s.resolve()}removeTargetData(t,e){return this.Rs.delete(e.target),this.Ps.ls(e.targetId),this.targetCount-=1,$s.resolve()}removeTargets(t,e,n){let s=0;const i=[];return this.Rs.forEach(((r,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Rs.delete(r),i.push(this.removeMatchingKeysForTargetId(t,o.targetId)),s++)})),$s.waitFor(i).next((()=>s))}getTargetCount(t){return $s.resolve(this.targetCount)}getTargetData(t,e){const n=this.Rs.get(e)||null;return $s.resolve(n)}addMatchingKeys(t,e,n){return this.Ps.us(e,n),$s.resolve()}removeMatchingKeys(t,e,n){this.Ps.hs(e,n);const s=this.persistence.referenceDelegate,i=[];return s&&e.forEach((e=>{i.push(s.markPotentiallyOrphaned(t,e))})),$s.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.Ps.ls(e),$s.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Ps.ds(e);return $s.resolve(n)}containsKey(t,e){return $s.resolve(this.Ps.containsKey(e))}}class Ua{constructor(t,e){this.Vs={},this.overlays={},this.Ss=new ti(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=t(this),this.Cs=new Va(this),this.indexManager=new Sa,this.remoteDocumentCache=function(t){return new Pa(t)}((t=>this.referenceDelegate.xs(t))),this.yt=new ba(e),this.Ns=new Ra(this.yt)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new La,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Vs[t.toKey()];return n||(n=new Ma(e,this.referenceDelegate),this.Vs[t.toKey()]=n),n}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(t,e,n){gs("MemoryPersistence","Starting transaction:",t);const s=new Ba(this.Ss.next());return this.referenceDelegate.ks(),n(s).next((t=>this.referenceDelegate.Os(s).next((()=>t)))).toPromise().then((t=>(s.raiseOnCommittedEvent(),t)))}Ms(t,e){return $s.or(Object.values(this.Vs).map((n=>()=>n.containsKey(t,e))))}}class Ba extends Ys{constructor(t){super(),this.currentSequenceNumber=t}}class qa{constructor(t){this.persistence=t,this.Fs=new Oa,this.$s=null}static Bs(t){return new qa(t)}get Ls(){if(this.$s)return this.$s;throw ws()}addReference(t,e,n){return this.Fs.addReference(n,e),this.Ls.delete(n.toString()),$s.resolve()}removeReference(t,e,n){return this.Fs.removeReference(n,e),this.Ls.add(n.toString()),$s.resolve()}markPotentiallyOrphaned(t,e){return this.Ls.add(e.toString()),$s.resolve()}removeTarget(t,e){this.Fs.ls(e.targetId).forEach((t=>this.Ls.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Ls.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}ks(){this.$s=new Set}Os(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $s.forEach(this.Ls,(n=>{const s=Ks.fromPath(n);return this.qs(t,s).next((t=>{t||e.removeEntry(s,Vs.min())}))})).next((()=>(this.$s=null,e.apply(t))))}updateLimboDocument(t,e){return this.qs(t,e).next((t=>{t?this.Ls.delete(e.toString()):this.Ls.add(e.toString())}))}xs(t){return 0}qs(t,e){return $s.or([()=>$s.resolve(this.Fs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ms(t,e)])}}class ja{constructor(t,e,n,s){this.targetId=t,this.fromCache=e,this.Si=n,this.Di=s}static Ci(t,e){let n=Ao(),s=Ao();for(const i of e.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new ja(t,e.fromCache,n,s)}}class Ka{constructor(){this.xi=!1}initialize(t,e){this.Ni=t,this.indexManager=e,this.xi=!0}getDocumentsMatchingQuery(t,e,n,s){return this.ki(t,e).next((i=>i||this.Oi(t,e,s,n))).next((n=>n||this.Mi(t,e)))}ki(t,e){if(yr(e))return $s.resolve(null);let n=Tr(e);return this.indexManager.getIndexType(t,n).next((s=>0===s?null:(null!==e.limit&&1===s&&(e=Ir(e,null,"F"),n=Tr(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((s=>{const i=Ao(...s);return this.Ni.getDocuments(t,i).next((s=>this.indexManager.getMinOffset(t,n).next((n=>{const r=this.Fi(e,s);return this.$i(e,r,i,n.readTime)?this.ki(t,Ir(e,null,"F")):this.Bi(t,r,e,n)}))))})))))}Oi(t,e,n,s){return yr(e)||s.isEqual(Vs.min())?this.Mi(t,e):this.Ni.getDocuments(t,n).next((i=>{const r=this.Fi(e,i);return this.$i(e,r,n,s)?this.Mi(t,e):(ps()<=o.in.DEBUG&&gs("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ar(e)),this.Bi(t,r,e,zs(s,-1)))}))}Fi(t,e){let n=new sr(kr(t));return e.forEach(((e,s)=>{_r(t,s)&&(n=n.add(s))})),n}$i(t,e,n,s){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Mi(t,e){return ps()<=o.in.DEBUG&&gs("QueryEngine","Using full collection scan to execute query:",Ar(e)),this.Ni.getDocumentsMatchingQuery(t,e,Qs.min())}Bi(t,e,n,s){return this.Ni.getDocumentsMatchingQuery(t,n,s).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class Ha{constructor(t,e,n,s){this.persistence=t,this.Li=e,this.yt=s,this.qi=new tr(Ms),this.Ui=new go((t=>lr(t)),dr),this.Ki=new Map,this.Gi=t.getRemoteDocumentCache(),this.Cs=t.getTargetCache(),this.Ns=t.getBundleCache(),this.Qi(n)}Qi(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Na(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.qi)))}}function za(t,e,n,s){return new Ha(t,e,n,s)}async function Ga(t,e){const n=bs(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let s;return n.mutationQueue.getAllMutationBatches(t).next((i=>(s=i,n.Qi(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const i=[],r=[];let o=Ao();for(const t of s){i.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({ji:t,removedBatchIds:i,addedBatchIds:r})))}))}))}function Qa(t){const e=bs(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Cs.getLastRemoteSnapshotVersion(t)))}function Wa(t,e,n){let s=Ao(),i=Ao();return n.forEach((t=>s=s.add(t))),e.getEntries(t,s).next((t=>{let s=yo();return n.forEach(((n,r)=>{const o=t.get(n);r.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),r.isNoDocument()&&r.version.isEqual(Vs.min())?(e.removeEntry(n,r.readTime),s=s.insert(n,r)):!o.isValidDocument()||r.version.compareTo(o.version)>0||0===r.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(r),s=s.insert(n,r)):gs("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",r.version)})),{Wi:s,zi:i}}))}function Xa(t,e){const n=bs(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}function Ya(t,e){const n=bs(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let s;return n.Cs.getTargetData(t,e).next((i=>i?(s=i,$s.resolve(s)):n.Cs.allocateTargetId(t).next((i=>(s=new Ea(e,i,0,t.currentSequenceNumber),n.Cs.addTargetData(t,s).next((()=>s)))))))})).then((t=>{const s=n.qi.get(t.targetId);return(null===s||t.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.qi=n.qi.insert(t.targetId,t),n.Ui.set(e,t.targetId)),t}))}async function Ja(t,e,n){const s=bs(t),i=s.qi.get(e),r=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",r,(t=>s.persistence.referenceDelegate.removeTarget(t,i)))}catch(t){if(!Zs(t))throw t;gs("LocalStore","Failed to update sequence numbers for target ".concat(e,": ").concat(t))}s.qi=s.qi.remove(e),s.Ui.delete(i.target)}function $a(t,e,n){const s=bs(t);let i=Vs.min(),r=Ao();return s.persistence.runTransaction("Execute query","readonly",(t=>function(t,e,n){const s=bs(t),i=s.Ui.get(n);return void 0!==i?$s.resolve(s.qi.get(i)):s.Cs.getTargetData(e,n)}(s,t,Tr(e)).next((e=>{if(e)return i=e.lastLimboFreeSnapshotVersion,s.Cs.getMatchingKeysForTargetId(t,e.targetId).next((t=>{r=t}))})).next((()=>s.Li.getDocumentsMatchingQuery(t,e,n?i:Vs.min(),n?r:Ao()))).next((t=>(Za(s,Dr(e),t),{documents:t,Hi:r})))))}function Za(t,e,n){let s=t.Ki.get(e)||Vs.min();n.forEach(((t,e)=>{e.readTime.compareTo(s)>0&&(s=e.readTime)})),t.Ki.set(e,s)}class tc{constructor(){this.activeTargetIds=Do()}er(t){this.activeTargetIds=this.activeTargetIds.add(t)}nr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}tr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class ec{constructor(){this.Lr=new tc,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.Lr.er(t),this.qr[t]||"not-current"}updateQueryState(t,e,n){this.qr[t]=e}removeLocalQueryTarget(t){this.Lr.nr(t)}isLocalQueryTarget(t){return this.Lr.activeTargetIds.has(t)}clearQueryState(t){delete this.qr[t]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(t){return this.Lr.activeTargetIds.has(t)}start(){return this.Lr=new tc,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class nc{Ur(t){}shutdown(){}}class sc{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}Ur(t){this.Wr.push(t)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){gs("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Wr)t(0)}jr(){gs("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Wr)t(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const ic={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class rc{constructor(t){this.Hr=t.Hr,this.Jr=t.Jr}Yr(t){this.Xr=t}Zr(t){this.eo=t}onMessage(t){this.no=t}close(){this.Jr()}send(t){this.Hr(t)}so(){this.Xr()}io(t){this.eo(t)}ro(t){this.no(t)}}class oc extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http";this.oo=e+"://"+t.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(t,e,n,s,i){const r=this.ho(t,e);gs("RestConnection","Sending: ",r,n);const o={};return this.lo(o,s,i),this.fo(t,r,o,n).then((t=>(gs("RestConnection","Received: ",t),t)),(e=>{throw ys("RestConnection","".concat(t," failed with error: "),e,"url: ",r,"request:",n),e}))}_o(t,e,n,s,i,r){return this.ao(t,e,n,s,i)}lo(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+ds,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}ho(t,e){const n=ic[t];return"".concat(this.oo,"/v1/").concat(e,":").concat(n)}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}fo(t,e,n,s){return new Promise(((i,r)=>{const o=new us;o.setWithCredentials(!0),o.listenOnce(is.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case ss.NO_ERROR:const e=o.getResponseJson();gs("Connection","XHR received:",JSON.stringify(e)),i(e);break;case ss.TIMEOUT:gs("Connection",'RPC "'+t+'" timed out'),r(new Is(Ts.DEADLINE_EXCEEDED,"Request time out"));break;case ss.HTTP_ERROR:const n=o.getStatus();if(gs("Connection",'RPC "'+t+'" failed with status:',n,"response text:",o.getResponseText()),n>0){let t=o.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Ts).indexOf(e)>=0?e:Ts.UNKNOWN}(e.status);r(new Is(t,e.message))}else r(new Is(Ts.UNKNOWN,"Server responded with status "+o.getStatus()))}else r(new Is(Ts.UNAVAILABLE,"Connection failed."));break;default:ws()}}finally{gs("Connection",'RPC "'+t+'" completed.')}}));const a=JSON.stringify(s);o.send(e,"POST",a,n,15)}))}wo(t,e,n){const s=[this.oo,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=es(),r=ns(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new as({})),this.lo(o.initMessageHeaders,e,n),o.encodeInitMessageHeaders=!0;const a=s.join("");gs("Connection","Creating WebChannel: "+a,o);const c=i.createWebChannel(a,o);let u=!1,h=!1;const l=new rc({Hr:t=>{h?gs("Connection","Not sending because WebChannel is closed:",t):(u||(gs("Connection","Opening WebChannel transport."),c.open(),u=!0),gs("Connection","WebChannel sending:",t),c.send(t))},Jr:()=>c.close()}),d=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return d(c,cs.EventType.OPEN,(()=>{h||gs("Connection","WebChannel transport opened.")})),d(c,cs.EventType.CLOSE,(()=>{h||(h=!0,gs("Connection","WebChannel transport closed"),l.io())})),d(c,cs.EventType.ERROR,(t=>{h||(h=!0,ys("Connection","WebChannel transport errored:",t),l.io(new Is(Ts.UNAVAILABLE,"The operation could not be completed")))})),d(c,cs.EventType.MESSAGE,(t=>{var e;if(!h){const n=t.data[0];Es(!!n);const s=n,i=s.error||(null===(e=s[0])||void 0===e?void 0:e.error);if(i){gs("Connection","WebChannel received error:",i);const t=i.status;let e=function(t){const e=ho[t];if(void 0!==e)return po(e)}(t),n=i.message;void 0===e&&(e=Ts.INTERNAL,n="Unknown error status: "+t+" with message "+i.message),h=!0,l.io(new Is(e,n)),c.close()}else gs("Connection","WebChannel received:",n),l.ro(n)}})),d(r,rs.STAT_EVENT,(t=>{t.stat===os.PROXY?gs("Connection","Detected buffering proxy"):t.stat===os.NOPROXY&&gs("Connection","Detected no buffering proxy")})),setTimeout((()=>{l.so()}),0),l}}function ac(){return"undefined"!=typeof document?document:null}function cc(t){return new qo(t,!0)}class uc{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Hs=t,this.timerId=e,this.mo=n,this.yo=s,this.po=i,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(t){this.cancel();const e=Math.floor(this.Io+this.bo()),n=Math.max(0,Date.now()-this.Eo),s=Math.max(0,e-n);s>0&&gs("ExponentialBackoff","Backing off for ".concat(s," ms (base delay: ").concat(this.Io," ms, delay with jitter: ").concat(e," ms, last attempt: ").concat(n," ms ago)")),this.To=this.Hs.enqueueAfterDelay(this.timerId,s,(()=>(this.Eo=Date.now(),t()))),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class hc{constructor(t,e,n,s,i,r,o,a){this.Hs=t,this.vo=n,this.Vo=s,this.connection=i,this.authCredentialsProvider=r,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new uc(t,e)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}async stop(){this.No()&&await this.close(0)}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,(()=>this.$o())))}Bo(t){this.Lo(),this.stream.send(t)}async $o(){if(this.ko())return this.close(0)}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}qo(){this.Co&&(this.Co.cancel(),this.Co=null)}async close(t,e){this.Lo(),this.qo(),this.xo.cancel(),this.So++,4!==t?this.xo.reset():e&&e.code===Ts.RESOURCE_EXHAUSTED?(ms(e.toString()),ms("Using maximum backoff delay to prevent overloading the backend."),this.xo.Ao()):e&&e.code===Ts.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Uo(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Zr(e)}Uo(){}auth(){this.state=1;const t=this.Ko(this.So),e=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((t=>{let[n,s]=t;this.So===e&&this.Go(n,s)}),(e=>{t((()=>{const t=new Is(Ts.UNKNOWN,"Fetching auth token failed: "+e.message);return this.Qo(t)}))}))}Go(t,e){const n=this.Ko(this.So);this.stream=this.jo(t,e),this.stream.Yr((()=>{n((()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,(()=>(this.ko()&&(this.state=3),Promise.resolve()))),this.listener.Yr())))})),this.stream.Zr((t=>{n((()=>this.Qo(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Oo(){this.state=5,this.xo.Ro((async()=>{this.state=0,this.start()}))}Qo(t){return gs("PersistentStream","close with error: ".concat(t)),this.stream=null,this.close(4,t)}Ko(t){return e=>{this.Hs.enqueueAndForget((()=>this.So===t?e():(gs("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class lc extends hc{constructor(t,e,n,s,i,r){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,s,r),this.yt=i}jo(t,e){return this.connection.wo("Listen",t,e)}onMessage(t){this.xo.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:ws()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],r=function(t,e){return t.wt?(Es(void 0===e||"string"==typeof e),ui.fromBase64String(e||"")):(Es(void 0===e||e instanceof Uint8Array),ui.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?Ts.UNKNOWN:po(t.code);return new Is(e,t.message||"")}(o);n=new Oo(s,i,r,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const i=Xo(t,s.document.name),r=zo(s.document.updateTime),o=s.document.createTime?zo(s.document.createTime):Vs.min(),a=new or({mapValue:{fields:s.document.fields}}),c=cr.newFoundDocument(i,r,o,a),u=s.targetIds||[],h=s.removedTargetIds||[];n=new Ro(u,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const i=Xo(t,s.document),r=s.readTime?zo(s.readTime):Vs.min(),o=cr.newNoDocument(i,r),a=s.removedTargetIds||[];n=new Ro([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const i=Xo(t,s.document),r=s.removedTargetIds||[];n=new Ro([],r,i,null)}else{if(!("filter"in e))return ws();{e.filter;const t=e.filter;t.targetId;const s=t.count||0,i=new uo(s),r=t.targetId;n=new Lo(r,i)}}return n}(this.yt,t),n=function(t){if(!("targetChange"in t))return Vs.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?Vs.min():e.readTime?zo(e.readTime):Vs.min()}(t);return this.listener.Wo(e,n)}zo(t){const e={};e.database=$o(this.yt),e.addTarget=function(t,e){let n;const s=e.target;return n=fr(s)?{documents:na(t,s)}:{query:sa(t,s)},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Ko(t,e.resumeToken):e.snapshotVersion.compareTo(Vs.min())>0&&(n.readTime=jo(t,e.snapshotVersion.toTimestamp())),n}(this.yt,t);const n=function(t,e){const n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ws()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.yt,t);n&&(e.labels=n),this.Bo(e)}Ho(t){const e={};e.database=$o(this.yt),e.removeTarget=t,this.Bo(e)}}class dc extends hc{constructor(t,e,n,s,i,r){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,s,r),this.yt=i,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}Uo(){this.Jo&&this.Xo([])}jo(t,e){return this.connection.wo("Write",t,e)}onMessage(t){if(Es(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Jo){this.xo.reset();const e=function(t,e){return t&&t.length>0?(Es(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?zo(t.updateTime):zo(e);return n.isEqual(Vs.min())&&(n=zo(e)),new Qr(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=zo(t.commitTime);return this.listener.Zo(n,e)}return Es(!t.writeResults||0===t.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const t={};t.database=$o(this.yt),this.Bo(t)}Xo(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>ea(this.yt,t)))};this.Bo(e)}}class fc extends class{}{constructor(t,e,n,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.yt=s,this.nu=!1}su(){if(this.nu)throw new Is(Ts.FAILED_PRECONDITION,"The client has already been terminated.")}ao(t,e,n){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((s=>{let[i,r]=s;return this.connection.ao(t,e,n,i,r)})).catch((t=>{throw"FirebaseError"===t.name?(t.code===Ts.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Is(Ts.UNKNOWN,t.toString())}))}_o(t,e,n,s){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[r,o]=i;return this.connection._o(t,e,n,r,o,s)})).catch((t=>{throw"FirebaseError"===t.name?(t.code===Ts.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Is(Ts.UNKNOWN,t.toString())}))}terminate(){this.nu=!0}}class pc{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve()))))}hu(t){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au("Connection failed 1 times. Most recent error: ".concat(t.toString())),this.cu("Offline")))}set(t){this.lu(),this.iu=0,"Online"===t&&(this.ou=!1),this.cu(t)}cu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}au(t){const e="Could not reach Cloud Firestore backend. ".concat(t,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.ou?(ms(e),this.ou=!1):gs("OnlineStateTracker",e)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class gc{constructor(t,e,n,s,i){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=i,this.mu.Ur((t=>{n.enqueueAndForget((async()=>{Sc(this)&&(gs("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=bs(t);e._u.add(4),await yc(e),e.gu.set("Unknown"),e._u.delete(4),await mc(e)}(this))}))})),this.gu=new pc(n,s)}}async function mc(t){if(Sc(t))for(const e of t.wu)await e(!0)}async function yc(t){for(const e of t.wu)await e(!1)}function vc(t,e){const n=bs(t);n.du.has(e.targetId)||(n.du.set(e.targetId,e),Ic(n)?Tc(n):jc(n).ko()&&Ec(n,e))}function wc(t,e){const n=bs(t),s=jc(n);n.du.delete(e),s.ko()&&bc(n,e),0===n.du.size&&(s.ko()?s.Fo():Sc(n)&&n.gu.set("Unknown"))}function Ec(t,e){t.yu.Ot(e.targetId),jc(t).zo(e)}function bc(t,e){t.yu.Ot(e),jc(t).Ho(e)}function Tc(t){t.yu=new Mo({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ne:e=>t.du.get(e)||null}),jc(t).start(),t.gu.uu()}function Ic(t){return Sc(t)&&!jc(t).No()&&t.du.size>0}function Sc(t){return 0===bs(t)._u.size}function Cc(t){t.yu=void 0}async function Ac(t){t.du.forEach(((e,n)=>{Ec(t,e)}))}async function _c(t,e){Cc(t),Ic(t)?(t.gu.hu(e),Tc(t)):t.gu.set("Unknown")}async function Dc(t,e,n){if(t.gu.set("Online"),e instanceof Oo&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const s of e.targetIds)t.du.has(s)&&(await t.remoteSyncer.rejectListen(s,n),t.du.delete(s),t.yu.removeTarget(s))}(t,e)}catch(n){gs("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await kc(t,n)}else if(e instanceof Ro?t.yu.Kt(e):e instanceof Lo?t.yu.Jt(e):t.yu.jt(e),!n.isEqual(Vs.min()))try{const e=await Qa(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.yu.Zt(e);return n.targetChanges.forEach(((n,s)=>{if(n.resumeToken.approximateByteSize()>0){const i=t.du.get(s);i&&t.du.set(s,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((e=>{const n=t.du.get(e);if(!n)return;t.du.set(e,n.withResumeToken(ui.EMPTY_BYTE_STRING,n.snapshotVersion)),bc(t,e);const s=new Ea(n.target,e,1,n.sequenceNumber);Ec(t,s)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){gs("RemoteStore","Failed to raise snapshot:",e),await kc(t,e)}}async function kc(t,e,n){if(!Zs(e))throw e;t._u.add(1),await yc(t),t.gu.set("Offline"),n||(n=()=>Qa(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{gs("RemoteStore","Retrying IndexedDB access"),await n(),t._u.delete(1),await mc(t)}))}function Nc(t,e){return e().catch((n=>kc(t,n,e)))}async function Rc(t){const e=bs(t),n=Kc(e);let s=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;Lc(e);)try{const t=await Xa(e.localStore,s);if(null===t){0===e.fu.length&&n.Fo();break}s=t.batchId,Oc(e,t)}catch(t){await kc(e,t)}xc(e)&&Mc(e)}function Lc(t){return Sc(t)&&t.fu.length<10}function Oc(t,e){t.fu.push(e);const n=Kc(t);n.ko()&&n.Yo&&n.Xo(e.mutations)}function xc(t){return Sc(t)&&!Kc(t).No()&&t.fu.length>0}function Mc(t){Kc(t).start()}async function Pc(t){Kc(t).eu()}async function Fc(t){const e=Kc(t);for(const n of t.fu)e.Xo(n.mutations)}async function Vc(t,e,n){const s=t.fu.shift(),i=va.from(s,e,n);await Nc(t,(()=>t.remoteSyncer.applySuccessfulWrite(i))),await Rc(t)}async function Uc(t,e){e&&Kc(t).Yo&&await async function(t,e){if(fo(n=e.code)&&n!==Ts.ABORTED){const n=t.fu.shift();Kc(t).Mo(),await Nc(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await Rc(t)}var n}(t,e),xc(t)&&Mc(t)}async function Bc(t,e){const n=bs(t);n.asyncQueue.verifyOperationInProgress(),gs("RemoteStore","RemoteStore received new credentials");const s=Sc(n);n._u.add(3),await yc(n),s&&n.gu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n._u.delete(3),await mc(n)}async function qc(t,e){const n=bs(t);e?(n._u.delete(2),await mc(n)):e||(n._u.add(2),await yc(n),n.gu.set("Unknown"))}function jc(t){return t.pu||(t.pu=function(t,e,n){const s=bs(t);return s.su(),new lc(e,s.connection,s.authCredentials,s.appCheckCredentials,s.yt,n)}(t.datastore,t.asyncQueue,{Yr:Ac.bind(null,t),Zr:_c.bind(null,t),Wo:Dc.bind(null,t)}),t.wu.push((async e=>{e?(t.pu.Mo(),Ic(t)?Tc(t):t.gu.set("Unknown")):(await t.pu.stop(),Cc(t))}))),t.pu}function Kc(t){return t.Iu||(t.Iu=function(t,e,n){const s=bs(t);return s.su(),new dc(e,s.connection,s.authCredentials,s.appCheckCredentials,s.yt,n)}(t.datastore,t.asyncQueue,{Yr:Pc.bind(null,t),Zr:Uc.bind(null,t),tu:Fc.bind(null,t),Zo:Vc.bind(null,t)}),t.wu.push((async e=>{e?(t.Iu.Mo(),await Rc(t)):(await t.Iu.stop(),t.fu.length>0&&(gs("RemoteStore","Stopping write stream with ".concat(t.fu.length," pending writes")),t.fu=[]))}))),t.Iu}class Hc{constructor(t,e,n,s,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new Ss,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,s,i){const r=Date.now()+n,o=new Hc(t,e,r,s,i);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Is(Ts.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zc(t,e){if(ms("AsyncQueue","".concat(e,": ").concat(t)),Zs(t))return new Is(Ts.UNAVAILABLE,"".concat(e,": ").concat(t));throw t}class Gc{constructor(t){this.comparator=t?(e,n)=>t(e,n)||Ks.comparator(e.key,n.key):(t,e)=>Ks.comparator(t.key,e.key),this.keyedMap=wo(),this.sortedSet=new tr(this.comparator)}static emptySet(t){return new Gc(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Gc))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,s=n.getNext().key;if(!t.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new Gc;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class Qc{constructor(){this.Tu=new tr(Ks.comparator)}track(t){const e=t.doc.key,n=this.Tu.get(e);n?0!==t.type&&3===n.type?this.Tu=this.Tu.insert(e,t):3===t.type&&1!==n.type?this.Tu=this.Tu.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Tu=this.Tu.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Tu=this.Tu.remove(e):1===t.type&&2===n.type?this.Tu=this.Tu.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):ws():this.Tu=this.Tu.insert(e,t)}Eu(){const t=[];return this.Tu.inorderTraversal(((e,n)=>{t.push(n)})),t}}class Wc{constructor(t,e,n,s,i,r,o,a,c){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=r,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(t,e,n,s,i){const r=[];return e.forEach((t=>{r.push({type:0,doc:t})})),new Wc(t,e,Gc.emptySet(e),r,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Sr(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let s=0;s<e.length;s++)if(e[s].type!==n[s].type||!e[s].doc.isEqual(n[s].doc))return!1;return!0}}class Xc{constructor(){this.Au=void 0,this.listeners=[]}}class Yc{constructor(){this.queries=new go((t=>Cr(t)),Sr),this.onlineState="Unknown",this.Ru=new Set}}async function Jc(t,e){const n=bs(t),s=e.query;let i=!1,r=n.queries.get(s);if(r||(i=!0,r=new Xc),i)try{r.Au=await n.onListen(s)}catch(t){const n=zc(t,"Initialization of query '".concat(Ar(e.query),"' failed"));return void e.onError(n)}n.queries.set(s,r),r.listeners.push(e),e.bu(n.onlineState),r.Au&&e.Pu(r.Au)&&eu(n)}async function $c(t,e){const n=bs(t),s=e.query;let i=!1;const r=n.queries.get(s);if(r){const t=r.listeners.indexOf(e);t>=0&&(r.listeners.splice(t,1),i=0===r.listeners.length)}if(i)return n.queries.delete(s),n.onUnlisten(s)}function Zc(t,e){const n=bs(t);let s=!1;for(const i of e){const t=i.query,e=n.queries.get(t);if(e){for(const t of e.listeners)t.Pu(i)&&(s=!0);e.Au=i}}s&&eu(n)}function tu(t,e,n){const s=bs(t),i=s.queries.get(e);if(i)for(const r of i.listeners)r.onError(n);s.queries.delete(e)}function eu(t){t.Ru.forEach((t=>{t.next()}))}class nu{constructor(t,e,n){this.query=t,this.vu=e,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=n||{}}Pu(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new Wc(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Vu?this.Du(t)&&(this.vu.next(t),e=!0):this.Cu(t,this.onlineState)&&(this.xu(t),e=!0),this.Su=t,e}onError(t){this.vu.error(t)}bu(t){this.onlineState=t;let e=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,t)&&(this.xu(this.Su),e=!0),e}Cu(t,e){if(!t.fromCache)return!0;const n="Offline"!==e;return(!this.options.Nu||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Du(t){if(t.docChanges.length>0)return!0;const e=this.Su&&this.Su.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}xu(t){t=Wc.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Vu=!0,this.vu.next(t)}}class su{constructor(t){this.key=t}}class iu{constructor(t){this.key=t}}class ru{constructor(t,e){this.query=t,this.qu=e,this.Uu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=Ao(),this.mutatedKeys=Ao(),this.Gu=kr(t),this.Qu=new Gc(this.Gu)}get ju(){return this.qu}Wu(t,e){const n=e?e.zu:new Qc,s=e?e.Qu:this.Qu;let i=e?e.mutatedKeys:this.mutatedKeys,r=s,o=!1;const a="F"===this.query.limitType&&s.size===this.query.limit?s.last():null,c="L"===this.query.limitType&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal(((t,e)=>{const u=s.get(t),h=_r(this.query,e)?e:null,l=!!u&&this.mutatedKeys.has(u.key),d=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let f=!1;u&&h?u.data.isEqual(h.data)?l!==d&&(n.track({type:3,doc:h}),f=!0):this.Hu(u,h)||(n.track({type:2,doc:h}),f=!0,(a&&this.Gu(h,a)>0||c&&this.Gu(h,c)<0)&&(o=!0)):!u&&h?(n.track({type:0,doc:h}),f=!0):u&&!h&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(h?(r=r.add(h),i=d?i.add(t):i.delete(t)):(r=r.delete(t),i=i.delete(t)))})),null!==this.query.limit)for(;r.size>this.query.limit;){const t="F"===this.query.limitType?r.last():r.first();r=r.delete(t.key),i=i.delete(t.key),n.track({type:1,doc:t})}return{Qu:r,zu:n,$i:o,mutatedKeys:i}}Hu(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n){const s=this.Qu;this.Qu=t.Qu,this.mutatedKeys=t.mutatedKeys;const i=t.zu.Eu();i.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ws()}};return n(t)-n(e)}(t.type,e.type)||this.Gu(t.doc,e.doc))),this.Ju(n);const r=e?this.Yu():[],o=0===this.Ku.size&&this.current?1:0,a=o!==this.Uu;return this.Uu=o,0!==i.length||a?{snapshot:new Wc(this.query,t.Qu,s,i,t.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),Xu:r}:{Xu:r}}bu(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new Qc,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(t){return!this.qu.has(t)&&!!this.Qu.has(t)&&!this.Qu.get(t).hasLocalMutations}Ju(t){t&&(t.addedDocuments.forEach((t=>this.qu=this.qu.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.qu=this.qu.delete(t))),this.current=t.current)}Yu(){if(!this.current)return[];const t=this.Ku;this.Ku=Ao(),this.Qu.forEach((t=>{this.Zu(t.key)&&(this.Ku=this.Ku.add(t.key))}));const e=[];return t.forEach((t=>{this.Ku.has(t)||e.push(new iu(t))})),this.Ku.forEach((n=>{t.has(n)||e.push(new su(n))})),e}tc(t){this.qu=t.Hi,this.Ku=Ao();const e=this.Wu(t.documents);return this.applyChanges(e,!0)}ec(){return Wc.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.Uu,this.hasCachedResults)}}class ou{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class au{constructor(t){this.key=t,this.nc=!1}}class cu{constructor(t,e,n,s,i,r){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=r,this.sc={},this.ic=new go((t=>Cr(t)),Sr),this.rc=new Map,this.oc=new Set,this.uc=new tr(Ks.comparator),this.cc=new Map,this.ac=new Oa,this.hc={},this.lc=new Map,this.fc=_a.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}async function uu(t,e){const n=_u(t);let s,i;const r=n.ic.get(e);if(r)s=r.targetId,n.sharedClientState.addLocalQueryTarget(s),i=r.view.ec();else{const t=await Ya(n.localStore,Tr(e));n.isPrimaryClient&&vc(n.remoteStore,t);const r=n.sharedClientState.addLocalQueryTarget(t.targetId);s=t.targetId,i=await hu(n,e,s,"current"===r,t.resumeToken)}return i}async function hu(t,e,n,s,i){t._c=(e,n,s)=>async function(t,e,n,s){let i=e.view.Wu(n);i.$i&&(i=await $a(t.localStore,e.query,!1).then((t=>{let{documents:n}=t;return e.view.Wu(n,i)})));const r=s&&s.targetChanges.get(e.targetId),o=e.view.applyChanges(i,t.isPrimaryClient,r);return bu(t,e.targetId,o.Xu),o.snapshot}(t,e,n,s);const r=await $a(t.localStore,e,!0),o=new ru(e,r.Hi),a=o.Wu(r.documents),c=No.createSynthesizedTargetChangeForCurrentChange(n,s&&"Offline"!==t.onlineState,i),u=o.applyChanges(a,t.isPrimaryClient,c);bu(t,n,u.Xu);const h=new ou(e,n,o);return t.ic.set(e,h),t.rc.has(n)?t.rc.get(n).push(e):t.rc.set(n,[e]),u.snapshot}async function lu(t,e){const n=bs(t),s=n.ic.get(e),i=n.rc.get(s.targetId);if(i.length>1)return n.rc.set(s.targetId,i.filter((t=>!Sr(t,e)))),void n.ic.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Ja(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),wc(n.remoteStore,s.targetId),wu(n,s.targetId)})).catch(Js)):(wu(n,s.targetId),await Ja(n.localStore,s.targetId,!0))}async function du(t,e){const n=bs(t);try{const t=await function(t,e){const n=bs(t),s=e.snapshotVersion;let i=n.qi;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const r=n.Gi.newChangeBuffer({trackRemovals:!0});i=n.qi;const o=[];e.targetChanges.forEach(((r,a)=>{const c=i.get(a);if(!c)return;o.push(n.Cs.removeMatchingKeys(t,r.removedDocuments,a).next((()=>n.Cs.addMatchingKeys(t,r.addedDocuments,a))));let u=c.withSequenceNumber(t.currentSequenceNumber);e.targetMismatches.has(a)?u=u.withResumeToken(ui.EMPTY_BYTE_STRING,Vs.min()).withLastLimboFreeSnapshotVersion(Vs.min()):r.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(r.resumeToken,s)),i=i.insert(a,u),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,r)&&o.push(n.Cs.updateTargetData(t,u))}));let a=yo(),c=Ao();if(e.documentUpdates.forEach((s=>{e.resolvedLimboDocuments.has(s)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,s))})),o.push(Wa(t,r,e.documentUpdates).next((t=>{a=t.Wi,c=t.zi}))),!s.isEqual(Vs.min())){const e=n.Cs.getLastRemoteSnapshotVersion(t).next((e=>n.Cs.setTargetsMetadata(t,t.currentSequenceNumber,s)));o.push(e)}return $s.waitFor(o).next((()=>r.apply(t))).next((()=>n.localDocuments.getLocalViewOfDocuments(t,a,c))).next((()=>a))})).then((t=>(n.qi=i,t)))}(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const s=n.cc.get(e);s&&(Es(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?s.nc=!0:t.modifiedDocuments.size>0?Es(s.nc):t.removedDocuments.size>0&&(Es(s.nc),s.nc=!1))})),await Su(n,t,e)}catch(t){await Js(t)}}function fu(t,e,n){const s=bs(t);if(s.isPrimaryClient&&0===n||!s.isPrimaryClient&&1===n){const t=[];s.ic.forEach(((n,s)=>{const i=s.view.bu(e);i.snapshot&&t.push(i.snapshot)})),function(t,e){const n=bs(t);n.onlineState=e;let s=!1;n.queries.forEach(((t,n)=>{for(const i of n.listeners)i.bu(e)&&(s=!0)})),s&&eu(n)}(s.eventManager,e),t.length&&s.sc.Wo(t),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function pu(t,e,n){const s=bs(t);s.sharedClientState.updateQueryState(e,"rejected",n);const i=s.cc.get(e),r=i&&i.key;if(r){let t=new tr(Ks.comparator);t=t.insert(r,cr.newNoDocument(r,Vs.min()));const n=Ao().add(r),i=new ko(Vs.min(),new Map,new sr(Ms),t,n);await du(s,i),s.uc=s.uc.remove(r),s.cc.delete(e),Iu(s)}else await Ja(s.localStore,e,!1).then((()=>wu(s,e,n))).catch(Js)}async function gu(t,e){const n=bs(t),s=e.batch.batchId;try{const t=await function(t,e){const n=bs(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const s=e.batch.keys(),i=n.Gi.newChangeBuffer({trackRemovals:!0});return function(t,e,n,s){const i=n.batch,r=i.keys();let o=$s.resolve();return r.forEach((t=>{o=o.next((()=>s.getEntry(e,t))).next((e=>{const r=n.docVersions.get(t);Es(null!==r),e.version.compareTo(r)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),s.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,i)))}(n,t,e,i).next((()=>i.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,s,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=Ao();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,s)))}))}(n.localStore,e);vu(n,s,null),yu(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await Su(n,t)}catch(t){await Js(t)}}async function mu(t,e,n){const s=bs(t);try{const t=await function(t,e){const n=bs(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let s;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(Es(null!==e),s=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,s,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,s))).next((()=>n.localDocuments.getDocuments(t,s)))}))}(s.localStore,e);vu(s,e,n),yu(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await Su(s,t)}catch(n){await Js(n)}}function yu(t,e){(t.lc.get(e)||[]).forEach((t=>{t.resolve()})),t.lc.delete(e)}function vu(t,e,n){const s=bs(t);let i=s.hc[s.currentUser.toKey()];if(i){const t=i.get(e);t&&(n?t.reject(n):t.resolve(),i=i.remove(e)),s.hc[s.currentUser.toKey()]=i}}function wu(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.rc.get(e))t.ic.delete(s),n&&t.sc.wc(s,n);t.rc.delete(e),t.isPrimaryClient&&t.ac.ls(e).forEach((e=>{t.ac.containsKey(e)||Eu(t,e)}))}function Eu(t,e){t.oc.delete(e.path.canonicalString());const n=t.uc.get(e);null!==n&&(wc(t.remoteStore,n),t.uc=t.uc.remove(e),t.cc.delete(n),Iu(t))}function bu(t,e,n){for(const s of n)s instanceof su?(t.ac.addReference(s.key,e),Tu(t,s)):s instanceof iu?(gs("SyncEngine","Document no longer in limbo: "+s.key),t.ac.removeReference(s.key,e),t.ac.containsKey(s.key)||Eu(t,s.key)):ws()}function Tu(t,e){const n=e.key,s=n.path.canonicalString();t.uc.get(n)||t.oc.has(s)||(gs("SyncEngine","New document in limbo: "+n),t.oc.add(s),Iu(t))}function Iu(t){for(;t.oc.size>0&&t.uc.size<t.maxConcurrentLimboResolutions;){const e=t.oc.values().next().value;t.oc.delete(e);const n=new Ks(Bs.fromString(e)),s=t.fc.next();t.cc.set(s,new au(n)),t.uc=t.uc.insert(n,s),vc(t.remoteStore,new Ea(Tr(mr(n.path)),s,2,ti.at))}}async function Su(t,e,n){const s=bs(t),i=[],r=[],o=[];s.ic.isEmpty()||(s.ic.forEach(((t,a)=>{o.push(s._c(a,e,n).then((t=>{if((t||n)&&s.isPrimaryClient&&s.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){i.push(t);const e=ja.Ci(a.targetId,t);r.push(e)}})))})),await Promise.all(o),s.sc.Wo(i),await async function(t,e){const n=bs(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>$s.forEach(e,(e=>$s.forEach(e.Si,(s=>n.persistence.referenceDelegate.addReference(t,e.targetId,s))).next((()=>$s.forEach(e.Di,(s=>n.persistence.referenceDelegate.removeReference(t,e.targetId,s)))))))))}catch(t){if(!Zs(t))throw t;gs("LocalStore","Failed to update sequence numbers: "+t)}for(const s of e){const t=s.targetId;if(!s.fromCache){const e=n.qi.get(t),s=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(s);n.qi=n.qi.insert(t,i)}}}(s.localStore,r))}async function Cu(t,e){const n=bs(t);if(!n.currentUser.isEqual(e)){gs("SyncEngine","User change. New user:",e.toKey());const t=await Ga(n.localStore,e);n.currentUser=e,function(t,e){t.lc.forEach((t=>{t.forEach((t=>{t.reject(new Is(Ts.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.lc.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await Su(n,t.ji)}}function Au(t,e){const n=bs(t),s=n.cc.get(e);if(s&&s.nc)return Ao().add(s.key);{let t=Ao();const s=n.rc.get(e);if(!s)return t;for(const e of s){const s=n.ic.get(e);t=t.unionWith(s.view.ju)}return t}}function _u(t){const e=bs(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=du.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Au.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=pu.bind(null,e),e.sc.Wo=Zc.bind(null,e.eventManager),e.sc.wc=tu.bind(null,e.eventManager),e}function Du(t){const e=bs(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=gu.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=mu.bind(null,e),e}class ku{constructor(){this.synchronizeTabs=!1}async initialize(t){this.yt=cc(t.databaseInfo.databaseId),this.sharedClientState=this.gc(t),this.persistence=this.yc(t),await this.persistence.start(),this.localStore=this.Ic(t),this.gcScheduler=this.Tc(t,this.localStore),this.indexBackfillerScheduler=this.Ec(t,this.localStore)}Tc(t,e){return null}Ec(t,e){return null}Ic(t){return za(this.persistence,new Ka,t.initialUser,this.yt)}yc(t){return new Ua(qa.Bs,this.yt)}gc(t){return new ec}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Nu{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>fu(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Cu.bind(null,this.syncEngine),await qc(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Yc}createDatastore(t){const e=cc(t.databaseInfo.databaseId),n=(s=t.databaseInfo,new oc(s));var s;return function(t,e,n,s){return new fc(t,e,n,s)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return e=this.localStore,n=this.datastore,s=t.asyncQueue,i=t=>fu(this.syncEngine,t,0),r=sc.C()?new sc:new nc,new gc(e,n,s,i,r);var e,n,s,i,r}createSyncEngine(t,e){return function(t,e,n,s,i,r,o){const a=new cu(t,e,n,s,i,r);return o&&(a.dc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=bs(t);gs("RemoteStore","RemoteStore shutting down."),e._u.add(5),await yc(e),e.mu.shutdown(),e.gu.set("Unknown")}(this.remoteStore)}}function Ru(t,e,n){if(!n)throw new Is(Ts.INVALID_ARGUMENT,"Function ".concat(t,"() cannot be called with an empty ").concat(e,"."))}function Lu(t){if(!Ks.isDocumentKey(t))throw new Is(Ts.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(t," has ").concat(t.length,"."))}function Ou(t){if(Ks.isDocumentKey(t))throw new Is(Ts.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(t," has ").concat(t.length,"."))}function xu(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t="".concat(t.substring(0,20),"...")),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?"a custom ".concat(e," object"):"an object"}}return"function"==typeof t?"a function":ws()}function Mu(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Is(Ts.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=xu(t);throw new Is(Ts.INVALID_ARGUMENT,"Expected type '".concat(e.name,"', but it was: ").concat(n))}}return t}const Pu=new Map;class Fu{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Is(Ts.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Is(Ts.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(t,e,n,s){if(!0===e&&!0===s)throw new Is(Ts.INVALID_ARGUMENT,"".concat(t," and ").concat(n," cannot be used together."))}("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Vu{constructor(t,e,n,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Fu({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Is(Ts.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Is(Ts.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Fu(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new As;switch(t.type){case"gapi":const e=t.client;return new Ns(e,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Is(Ts.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Pu.get(t);e&&(gs("ComponentProvider","Removing Datastore"),Pu.delete(t),e.terminate())}(this),Promise.resolve()}}class Uu{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qu(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Uu(this.firestore,t,this._key)}}class Bu{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Bu(this.firestore,t,this._query)}}class qu extends Bu{constructor(t,e,n){super(t,e,mr(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Uu(this.firestore,null,new Ks(t))}withConverter(t){return new qu(this.firestore,t,this._path)}}function ju(t,e){for(var n=arguments.length,s=new Array(n>2?n-2:0),i=2;i<n;i++)s[i-2]=arguments[i];if(t=(0,a.m9)(t),Ru("collection","path",e),t instanceof Vu){const n=Bs.fromString(e,...s);return Ou(n),new qu(t,null,n)}{if(!(t instanceof Uu||t instanceof qu))throw new Is(Ts.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Bs.fromString(e,...s));return Ou(n),new qu(t.firestore,null,n)}}function Ku(t,e){for(var n=arguments.length,s=new Array(n>2?n-2:0),i=2;i<n;i++)s[i-2]=arguments[i];if(t=(0,a.m9)(t),1===arguments.length&&(e=xs.R()),Ru("doc","path",e),t instanceof Vu){const n=Bs.fromString(e,...s);return Lu(n),new Uu(t,null,new Ks(n))}{if(!(t instanceof Uu||t instanceof qu))throw new Is(Ts.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Bs.fromString(e,...s));return Lu(n),new Uu(t.firestore,t instanceof qu?t.converter:null,new Ks(n))}}class Hu{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Rc(this.observer.next,t)}error(t){this.observer.error?this.Rc(this.observer.error,t):ms("Uncaught Error in snapshot listener:",t.toString())}bc(){this.muted=!0}Rc(t,e){this.muted||setTimeout((()=>{this.muted||t(e)}),0)}}class zu{constructor(t,e,n,s){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=s,this.user=ls.UNAUTHENTICATED,this.clientId=xs.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{gs("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(gs("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Is(Ts.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Ss;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=zc(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Gu(t,e){t.asyncQueue.verifyOperationInProgress(),gs("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener((async t=>{s.isEqual(t)||(await Ga(e.localStore,t),s=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t.offlineComponents=e}async function Qu(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Wu(t);gs("FirestoreClient","Initializing OnlineComponentProvider");const s=await t.getConfiguration();await e.initialize(n,s),t.setCredentialChangeListener((t=>Bc(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>Bc(e.remoteStore,n))),t.onlineComponents=e}async function Wu(t){return t.offlineComponents||(gs("FirestoreClient","Using default OfflineComponentProvider"),await Gu(t,new ku)),t.offlineComponents}async function Xu(t){return t.onlineComponents||(gs("FirestoreClient","Using default OnlineComponentProvider"),await Qu(t,new Nu)),t.onlineComponents}function Yu(t){return Xu(t).then((t=>t.syncEngine))}async function Ju(t){const e=await Xu(t),n=e.eventManager;return n.onListen=uu.bind(null,e.syncEngine),n.onUnlisten=lu.bind(null,e.syncEngine),n}function $u(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=new Ss;return t.asyncQueue.enqueueAndForget((async()=>function(t,e,n,s,i){const r=new Hu({next:n=>{e.enqueueAndForget((()=>$c(t,o))),n.fromCache&&"server"===s.source?i.reject(new Is(Ts.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:t=>i.reject(t)}),o=new nu(n,r,{includeMetadataChanges:!0,Nu:!0});return Jc(t,o)}(await Ju(t),t.asyncQueue,e,n,s))),s.promise}class Zu{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.qc=!1,this.Uc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new uc(this,"async_queue_retry"),this.Wc=()=>{const t=ac();t&&gs("AsyncQueue","Visibility state changed to "+t.visibilityState),this.xo.Po()};const t=ac();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.qc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.zc(),this.Hc(t)}enterRestrictedMode(t){if(!this.qc){this.qc=!0,this.Qc=t||!1;const e=ac();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Wc)}}enqueue(t){if(this.zc(),this.qc)return new Promise((()=>{}));const e=new Ss;return this.Hc((()=>this.qc&&this.Qc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Lc.push(t),this.Jc())))}async Jc(){if(0!==this.Lc.length){try{await this.Lc[0](),this.Lc.shift(),this.xo.reset()}catch(b){if(!Zs(b))throw b;gs("AsyncQueue","Operation failed with retryable error: "+b)}this.Lc.length>0&&this.xo.Ro((()=>this.Jc()))}}Hc(t){const e=this.Bc.then((()=>(this.Gc=!0,t().catch((t=>{this.Kc=t,this.Gc=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw ms("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.Gc=!1,t))))));return this.Bc=e,e}enqueueAfterDelay(t,e,n){this.zc(),this.jc.indexOf(t)>-1&&(e=0);const s=Hc.createAndSchedule(this,t,e,n,(t=>this.Yc(t)));return this.Uc.push(s),s}zc(){this.Kc&&ws()}verifyOperationInProgress(){}async Xc(){let t;do{t=this.Bc,await t}while(t!==this.Bc)}Zc(t){for(const e of this.Uc)if(e.timerId===t)return!0;return!1}ta(t){return this.Xc().then((()=>{this.Uc.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.Uc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Xc()}))}ea(t){this.jc.push(t)}Yc(t){const e=this.Uc.indexOf(t);this.Uc.splice(e,1)}}class th extends Vu{constructor(t,e,n,s){super(t,e,n,s),this.type="firestore",this._queue=new Zu,this._persistenceKey=(null==s?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||sh(this),this._firestoreClient.terminate()}}function eh(t,e){const n="object"==typeof t?t:(0,i.Mq)(),s="string"==typeof t?t:e||"(default)",r=(0,i.qX)(n,"firestore").getImmediate({identifier:s});if(!r._initialized){const t=(0,a.P0)("firestore");t&&function(t,e,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const r=(t=Mu(t,Vu))._getSettings();if("firestore.googleapis.com"!==r.host&&r.host!==e&&ys("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},r),{host:"".concat(e,":").concat(n),ssl:!1})),s.mockUserToken){let e,n;if("string"==typeof s.mockUserToken)e=s.mockUserToken,n=ls.MOCK_USER;else{e=(0,a.Sg)(s.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);const r=s.mockUserToken.sub||s.mockUserToken.user_id;if(!r)throw new Is(Ts.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new ls(r)}t._authCredentials=new _s(new Cs(e,n))}}(r,...t)}return r}function nh(t){return t._firestoreClient||sh(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function sh(t){var e;const n=t._freezeSettings(),s=function(t,e,n,s){return new ei(t,e,n,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,s.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new zu(t._authCredentials,t._appCheckCredentials,t._queue,s)}class ih{constructor(t){this._byteString=t}static fromBase64String(t){try{return new ih(ui.fromBase64String(t))}catch(t){throw new Is(Ts.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new ih(ui.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class rh{constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(let s=0;s<e.length;++s)if(0===e[s].length)throw new Is(Ts.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new js(e)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class oh{constructor(t){this._methodName=t}}class ah{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Is(Ts.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Is(Ts.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Ms(this._lat,t._lat)||Ms(this._long,t._long)}}const ch=/^__.*__$/;class uh{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new so(t,this.data,this.fieldMask,e,this.fieldTransforms):new no(t,this.data,e,this.fieldTransforms)}}class hh{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return new so(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function lh(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ws()}}class dh{constructor(t,e,n,s,i,r){this.settings=t,this.databaseId=e,this.yt=n,this.ignoreUndefinedProperties=s,void 0===i&&this.na(),this.fieldTransforms=i||[],this.fieldMask=r||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(t){return new dh(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.yt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.ia({path:n,oa:!1});return s.ua(t),s}ca(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.ia({path:n,oa:!1});return s.na(),s}aa(t){return this.ia({path:void 0,oa:!0})}ha(t){return _h(t,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}na(){if(this.path)for(let t=0;t<this.path.length;t++)this.ua(this.path.get(t))}ua(t){if(0===t.length)throw this.ha("Document fields must not be empty");if(lh(this.sa)&&ch.test(t))throw this.ha('Document fields cannot begin and end with "__"')}}class fh{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.yt=n||cc(t)}da(t,e,n){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new dh({sa:t,methodName:e,fa:n,path:js.emptyPath(),oa:!1,la:s},this.databaseId,this.yt,this.ignoreUndefinedProperties)}}function ph(t){const e=t._freezeSettings(),n=cc(t._databaseId);return new fh(t._databaseId,!!e.ignoreUndefinedProperties,n)}function gh(t,e,n,s,i){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=t.da(r.merge||r.mergeFields?2:0,e,n,i);Ih("Data must be an object, but it was:",o,s);const a=bh(s,o);let c,u;if(r.merge)c=new rr(o.fieldMask),u=o.fieldTransforms;else if(r.mergeFields){const t=[];for(const s of r.mergeFields){const i=Sh(e,s,n);if(!o.contains(i))throw new Is(Ts.INVALID_ARGUMENT,"Field '".concat(i,"' is specified in your field mask but missing from your input data."));Dh(t,i)||t.push(i)}c=new rr(t),u=o.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,u=o.fieldTransforms;return new uh(new or(a),c,u)}class mh extends oh{_toFieldTransform(t){if(2!==t.sa)throw 1===t.sa?t.ha("".concat(this._methodName,"() can only appear at the top level of your update data")):t.ha("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof mh}}class yh extends oh{_toFieldTransform(t){return new Gr(t.path,new Vr)}isEqual(t){return t instanceof yh}}function vh(t,e,n,s){const i=t.da(1,e,n);Ih("Data must be an object, but it was:",i,s);const r=[],o=or.empty();ii(s,((t,s)=>{const c=Ah(e,t,n);s=(0,a.m9)(s);const u=i.ca(c);if(s instanceof mh)r.push(c);else{const t=Eh(s,u);null!=t&&(r.push(c),o.set(c,t))}}));const c=new rr(r);return new hh(o,c,i.fieldTransforms)}function wh(t,e,n,s,i,r){const o=t.da(1,e,n),c=[Sh(e,s,n)],u=[i];if(r.length%2!=0)throw new Is(Ts.INVALID_ARGUMENT,"Function ".concat(e,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let a=0;a<r.length;a+=2)c.push(Sh(e,r[a])),u.push(r[a+1]);const h=[],l=or.empty();for(let f=c.length-1;f>=0;--f)if(!Dh(h,c[f])){const t=c[f];let e=u[f];e=(0,a.m9)(e);const n=o.ca(t);if(e instanceof mh)h.push(t);else{const s=Eh(e,n);null!=s&&(h.push(t),l.set(t,s))}}const d=new rr(h);return new hh(l,d,o.fieldTransforms)}function Eh(t,e){if(Th(t=(0,a.m9)(t)))return Ih("Unsupported field value:",e,t),bh(t,e);if(t instanceof oh)return function(t,e){if(!lh(e.sa))throw e.ha("".concat(t._methodName,"() can only be used with update() and set()"));if(!e.path)throw e.ha("".concat(t._methodName,"() is not currently supported inside arrays"));const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.oa&&4!==e.sa)throw e.ha("Nested arrays are not supported");return function(t,e){const n=[];let s=0;for(const i of t){let t=Eh(i,e.aa(s));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),s++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=(0,a.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Or(e.yt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Fs.fromDate(t);return{timestampValue:jo(e.yt,n)}}if(t instanceof Fs){const n=new Fs(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:jo(e.yt,n)}}if(t instanceof ah)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ih)return{bytesValue:Ko(e.yt,t._byteString)};if(t instanceof Uu){const n=e.databaseId,s=t.firestore._databaseId;if(!s.isEqual(n))throw e.ha("Document reference is for database ".concat(s.projectId,"/").concat(s.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:Go(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.ha("Unsupported field value: ".concat(xu(t)))}(t,e)}function bh(t,e){const n={};return ri(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ii(t,((t,s)=>{const i=Eh(s,e.ra(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Th(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Fs||t instanceof ah||t instanceof ih||t instanceof Uu||t instanceof oh)}function Ih(t,e,n){if(!Th(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const s=xu(n);throw"an object"===s?e.ha(t+" a custom object"):e.ha(t+" "+s)}}function Sh(t,e,n){if((e=(0,a.m9)(e))instanceof rh)return e._internalPath;if("string"==typeof e)return Ah(t,e);throw _h("Field path arguments must be of type string or ",t,!1,void 0,n)}const Ch=new RegExp("[~\\*/\\[\\]]");function Ah(t,e,n){if(e.search(Ch)>=0)throw _h("Invalid field path (".concat(e,"). Paths must not contain '~', '*', '/', '[', or ']'"),t,!1,void 0,n);try{return new rh(...e.split("."))._internalPath}catch(s){throw _h("Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),t,!1,void 0,n)}}function _h(t,e,n,s,i){const r=s&&!s.isEmpty(),o=void 0!==i;let a="Function ".concat(e,"() called with invalid data");n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(r||o)&&(c+=" (found",r&&(c+=" in field ".concat(s)),o&&(c+=" in document ".concat(i)),c+=")"),new Is(Ts.INVALID_ARGUMENT,a+t+c)}function Dh(t,e){return t.some((t=>t.isEqual(e)))}class kh{constructor(t,e,n,s,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Uu(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new Nh(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(Rh("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class Nh extends kh{data(){return super.data()}}function Rh(t,e){return"string"==typeof e?Ah(t,e):e instanceof rh?e._internalPath:e._delegate._internalPath}function Lh(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new Is(Ts.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Oh{convertValue(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(vi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return di(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(fi(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw ws()}}convertObject(t,e){const n={};return ii(t.fields,((t,s)=>{n[t]=this.convertValue(s,e)})),n}convertGeoPoint(t){return new ah(di(t.latitude),di(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=gi(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(mi(t));default:return null}}convertTimestamp(t){const e=li(t);return new Fs(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=Bs.fromString(t);Es(fa(n));const s=new ni(n.get(1),n.get(3)),i=new Ks(n.popFirst(5));return s.isEqual(e)||ms("Document ".concat(i," contains a document reference within a different database (").concat(s.projectId,"/").concat(s.database,") which is not supported. It will be treated as a reference in the current database (").concat(e.projectId,"/").concat(e.database,") instead.")),i}}function xh(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}class Mh{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Ph extends kh{constructor(t,e,n,s,i,r){super(t,e,n,s,r),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const e=new Fh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Rh("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class Fh extends Ph{data(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(t)}}class Vh{constructor(t,e,n,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new Mh(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new Fh(this._firestore,this._userDataWriter,n.key,n,new Mh(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const t=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Is(Ts.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>{const s=new Fh(t._firestore,t._userDataWriter,n.doc.key,n.doc,new Mh(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:s,oldIndex:-1,newIndex:e++}}))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const s=new Fh(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Mh(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let i=-1,r=-1;return 0!==e.type&&(i=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),r=n.indexOf(e.doc.key)),{type:Uh(e.type),doc:s,oldIndex:i,newIndex:r}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Uh(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ws()}}class Bh extends Oh{constructor(t){super(),this.firestore=t}convertBytes(t){return new ih(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Uu(this.firestore,null,e)}}function qh(t){t=Mu(t,Bu);const e=Mu(t.firestore,th),n=nh(e),s=new Bh(e);return Lh(t._query),$u(n,t._query).then((n=>new Vh(e,s,t,n)))}function jh(t,e,n){t=Mu(t,Uu);const s=Mu(t.firestore,th),i=xh(t.converter,e,n);return zh(s,[gh(ph(s),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Wr.none())])}function Kh(t,e,n){t=Mu(t,Uu);const s=Mu(t.firestore,th),i=ph(s);let r;for(var o=arguments.length,c=new Array(o>3?o-3:0),u=3;u<o;u++)c[u-3]=arguments[u];return r="string"==typeof(e=(0,a.m9)(e))||e instanceof rh?wh(i,"updateDoc",t._key,e,n,c):vh(i,"updateDoc",t._key,e),zh(s,[r.toMutation(t._key,Wr.exists(!0))])}function Hh(t){return zh(Mu(t.firestore,th),[new ao(t._key,Wr.none())])}function zh(t,e){return function(t,e){const n=new Ss;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const s=Du(t);try{const t=await function(t,e){const n=bs(t),s=Fs.now(),i=e.reduce(((t,e)=>t.add(e.key)),Ao());let r,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=yo(),c=Ao();return n.Gi.getEntries(t,i).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(c=c.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((i=>{r=i;const o=[];for(const t of e){const e=to(t,r.get(t.key).overlayedDocument);null!=e&&o.push(new so(t.key,e,ar(e.value.mapValue),Wr.exists(!0)))}return n.mutationQueue.addMutationBatch(t,s,o,e)})).next((e=>{o=e;const s=e.applyToLocalDocumentSet(r,c);return n.documentOverlayCache.saveOverlays(t,e.batchId,s)}))})).then((()=>({batchId:o.batchId,changes:Eo(r)})))}(s.localStore,e);s.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let s=t.hc[t.currentUser.toKey()];s||(s=new tr(Ms)),s=s.insert(e,n),t.hc[t.currentUser.toKey()]=s}(s,t.batchId,n),await Su(s,t.changes),await Rc(s.remoteStore)}catch(t){const e=zc(t,"Failed to persist write");n.reject(e)}}(await Yu(t),e,n))),n.promise}(nh(t),e)}function Gh(){return new yh("serverTimestamp")}!function(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(t){ds=t}(i.Jn),(0,i.Xd)(new r.wA("firestore",((t,n)=>{let{instanceIdentifier:s,options:i}=n;const r=t.getProvider("app").getImmediate(),o=new th(new Ds(t.getProvider("auth-internal")),new Ls(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Is(Ts.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ni(t.options.projectId,e)}(r,s),r);return i=Object.assign({useFetchStreams:e},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),(0,i.KN)(hs,"3.8.3",t),(0,i.KN)(hs,"3.8.3","esm2017")}()},59073:function(t,e,n){n.d(e,{X3:function(){return m}});const s=(t,e)=>e.some((e=>t instanceof e));let i,r;const o=new WeakMap,a=new WeakMap,c=new WeakMap,u=new WeakMap,h=new WeakMap;let l={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return a.get(t);if("objectStoreNames"===e)return t.objectStoreNames||c.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return p(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t}};function d(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return t.apply(g(this),n),p(o.get(this))}:function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return p(t.apply(g(this),n))}:function(e){for(var n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];const r=t.call(g(this),e,...s);return c.set(r,e.sort?e.sort():[e]),p(r)}}function f(t){return"function"===typeof t?d(t):(t instanceof IDBTransaction&&function(t){if(a.has(t))return;const e=new Promise(((e,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",r),t.removeEventListener("abort",r)},i=()=>{e(),s()},r=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",r),t.addEventListener("abort",r)}));a.set(t,e)}(t),s(t,i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,l):t)}function p(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",r)},i=()=>{e(p(t.result)),s()},r=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",r)}));return e.then((e=>{e instanceof IDBCursor&&o.set(e,t)})).catch((()=>{})),h.set(e,t),e}(t);if(u.has(t))return u.get(t);const e=f(t);return e!==t&&(u.set(t,e),h.set(e,t)),e}const g=t=>h.get(t);function m(t,e){let{blocked:n,upgrade:s,blocking:i,terminated:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(t,e),a=p(o);return s&&o.addEventListener("upgradeneeded",(t=>{s(p(o.result),t.oldVersion,t.newVersion,p(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((t=>{r&&t.addEventListener("close",(()=>r())),i&&t.addEventListener("versionchange",(()=>i()))})).catch((()=>{})),a}const y=["get","getKey","getAll","getAllKeys","count"],v=["put","add","delete","clear"],w=new Map;function E(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!==typeof e)return;if(w.get(e))return w.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,i=v.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!i&&!y.includes(n))return;const r=async function(t){const e=this.transaction(t,i?"readwrite":"readonly");let r=e.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];return s&&(r=r.index(a.shift())),(await Promise.all([r[n](...a),i&&e.done]))[0]};return w.set(e,r),r}l=(t=>({...t,get:(e,n,s)=>E(e,n)||t.get(e,n,s),has:(e,n)=>!!E(e,n)||t.has(e,n)}))(l)}}]);
//# sourceMappingURL=4294.85f9687a.chunk.js.map