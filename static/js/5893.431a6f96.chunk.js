"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[5893,6818],{45893:function(e,t,r){r.r(t),r.d(t,{AppSmartDrawing:function(){return d}});var n=r(29439),i=r(37762),o=r(15671),s=r(43144),a=r(86818),c=r(87968),d=function(){function e(t){var r=this;(0,o.Z)(this,e),this.rendererCanvas=void 0,this.smartDrawing=void 0,this.vec=[],this.divHost=void 0,this.divText=void 0,this.render=function(e){for(var t=0;t<r.vec.length;++t)e.fillStyle="rgba(255, 0, 0, 0.15)",e.beginPath(),e.arc(r.vec[t][0],r.vec[t][1],5,0,2*Math.PI),e.closePath(),e.fill()},this.mouseDrag=function(e,t){r.vec.push([e,t])},this.mouseUp=function(e,t){r.Predict(r.vec),r.vec=[]},this.divHost=document.getElementById(t);var n=document.createElement("div");this.divHost.appendChild(n),n.style.alignItems="center",n.style.marginTop="80px",n.style.marginLeft="auto",n.style.marginRight="auto",n.style.width="300px",n.style.height="400px",this.smartDrawing=new a.SmartDrawing,this.rendererCanvas=new c.RendererCanvas(n),this.rendererCanvas.canvas.style.position="unset",this.rendererCanvas.canvas.width=300,this.rendererCanvas.canvas.height=300,this.rendererCanvas.canvas.style.background="#999",this.divText=document.createElement("div"),this.divText.textContent="*** FROM DEEP LEARNING MODEL B ***",n.append(this.divText),this.rendererCanvas.start(),this.rendererCanvas.render=function(e){return r.render(e)},this.rendererCanvas.mouseDrag=function(e,t){return r.mouseDrag(e,t)},this.rendererCanvas.mouseUp=function(e,t){return r.mouseUp(e,t)}}return(0,s.Z)(e,[{key:"Predict",value:function(e){var t,r=[],o=(0,i.Z)(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;r.push(new c.Vector3(s[0],s[1],0))}}catch(m){o.e(m)}finally{o.f()}var a=l(r),d=(0,c.getInterpolatedArray)(a,501);console.log(d),console.log("*** FROM DEEP LEARNING MODELS ***");var u=this.smartDrawing.predictByLogisticRegression(d);console.debug("pridiction:%c ".concat(u," from LR Model"),"background: #ddb137; color: black");var h=this.smartDrawing.predictByMultiClassification(d),v=(0,n.Z)(h,2),g=v[0],f=v[1];return console.debug("pridiction:%c ".concat(g," from MC model"),"background: #4e2c7e; color: white"),this.updateDivWithText(f),g}},{key:"updateDivWithText",value:function(e){for(var t="<p>*** FROM DEEP LEARNING MODEL B *** </p>",r=0;r<e.length;++r)t+="<p> ".concat(e[r],"</p>");this.divText.innerHTML=t}},{key:"destroy",value:function(){try{for(;void 0!==this.divHost&&void 0!==this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}catch(e){}}}]),e}(),l=function(e){for(var t=[],r=0;r<e.length;++r)if(r<e.length-1){var n=new c.Vector3(e[r].x,e[r].y,e[r].z),i=new c.Vector3(e[r+1].x,e[r+1].y,e[r+1].z);i.x-=n.x,i.y-=n.y,i.z-=n.z;var o=(0,c.dotProduct)(new c.Vector3(1,0,0),(0,c.normalize)(i));Number.isNaN(o)?t.push(t[t.length-1]):t.push(o)}else{var s=new c.Vector3(e[r].x,e[r].y,e[r].z),a=new c.Vector3(e[0].x,e[0].y,e[0].z);a.x-=s.x,a.y-=s.y,a.z-=s.z;var d=(0,c.dotProduct)(new c.Vector3(1,0,0),(0,c.normalize)(a));Number.isNaN(d)?t.push(t[t.length-1]):t.push(d)}return t}},86818:function(e,t,r){r.r(t),r.d(t,{SmartDrawing:function(){return l}});var n=r(74165),i=r(15861),o=r(37762),s=r(29439),a=r(15671),c=r(43144),d=r(88859),l=function(){function e(){var t=this;(0,a.Z)(this,e),this.modelLogisticRegression=void 0,this.modelMultiClassification=void 0,this.isLoaded=!1,u().then((function(e){var r=(0,s.Z)(e,2);t.modelLogisticRegression=r[0],t.modelMultiClassification=r[1],t.isLoaded=!0,console.log(t)})),console.log("executing Smart Drawing example")}return(0,c.Z)(e,[{key:"predictByLogisticRegression",value:function(e){var t=this;if(void 0!==this.modelLogisticRegression)return console.log("=============================="),(0,d.tidy)((function(){var r=(0,d.tensor2d)([e]),n=t.modelLogisticRegression.predict(r).dataSync();return t.PredictionPostProcessingLogisticRegression(n[0])}));console.error("no model loaded")}},{key:"PredictionPostProcessingLogisticRegression",value:function(t){var r=Math.floor(t+.5);return e.CLASS_TYPE[r]}},{key:"predictByMultiClassification",value:function(t){var r=this;if(void 0!==this.modelMultiClassification)return(0,d.tidy)((function(){var n,i=d.tensor2d([t]),s=r.modelMultiClassification.predict(i),a=[],c=Array.from(s.dataSync()),l=h(c),u=(0,o.Z)(l);try{for(u.s();!(n=u.n()).done;){var v=n.value,g=c[v],f="class:"+e.CLASS_TYPE[v]+", probability:"+g.toFixed(5);console.log(f),a.push(f)}}catch(p){u.e(p)}finally{u.f()}var m=s.argMax(-1).dataSync()[0];return[e.CLASS_TYPE[m],a]}));console.error("no model loaded")}}]),e}();l.CLASS_TYPE={0:"CIRCLE",1:"TRI-GON",2:"ARROW_SINGLE",3:"ARROW_DOUBLE",4:"RECTANGLE",5:"TEXT",6:"CURVE",7:"HEART",8:"CLOUD"};var u=function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){var t,r,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="https://raw.githubusercontent.com/NamjuLee/data/master/smart-drawing/model/modelLogisticRegression0/model.json",e.next=3,(0,d.loadLayersModel)(t);case 3:return r=e.sent,t="https://raw.githubusercontent.com/NamjuLee/data/master/smart-drawing/model/modelMultiClassification0/model.json",e.next=7,(0,d.loadLayersModel)(t);case 7:return i=e.sent,e.abrupt("return",[r,i]);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=r;return t.sort((function(t,r){return e[t]>e[r]?-1:e[t]<e[r]?1:0})),t}}}]);
//# sourceMappingURL=5893.431a6f96.chunk.js.map