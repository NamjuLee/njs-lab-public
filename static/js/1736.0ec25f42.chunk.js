"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[1736,6690,2405],{46690:function(t,e,i){i.r(e),i.d(e,{Edge:function(){return r},Graph:function(){return a},Node:function(){return d}});var s=i(37762),n=i(15671),o=i(43144),h=i(9936),a=function(){function t(){(0,n.Z)(this,t),this.nodes=[],this.edges=[],this.dt=0,this.mouse=new h.h9(0,0),this.damping=.96,this.gravity=-.032,this.timeStep=.16,this.groundZ=-9.26,this.capture=void 0}return(0,o.Z)(t,[{key:"Init",value:function(t,e){this.InitGridR(t,e),this.nodes[0].fixed=!0,this.nodes[9].fixed=!0,this.nodes[this.nodes.length-1].fixed=!0,this.nodes[this.nodes.length-1-9].fixed=!0}},{key:"updateOptionA",value:function(t){this.damping=.1*t,console.log(this.damping,"damping")}},{key:"updateOptionB",value:function(t){this.timeStep=.05*t,console.log(this.timeStep,"timeStep")}},{key:"updateOptionC",value:function(t){}},{key:"shrinkage",value:function(t){this.nodes[t].fixed=!0;for(var e=0;e<this.nodes[t].edge.length;++e)this.nodes[t].edge[e].targetLength*=.8}},{key:"InitGridR",value:function(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,n=0,o=0,a=t/i+1,r=e/s+1,d=this.nodes.length,l=0;l<s;++l)for(var u=0;u<i;++u){var v=n+a*u-.5*t,p=o+r*l-.5*e;this.AddNode(v,0,p,h.h9.Zero(),1)}for(var c=0;c<s;++c)for(var f=0;f<i;++f){var g=c*i+f;0!==f&&this.AddEdge(this.nodes[d+g-1],this.nodes[d+g]),0!==c&&this.AddEdge(this.nodes[d+g-i],this.nodes[d+g])}}},{key:"Clear",value:function(){this.nodes=[],this.edges=[]}},{key:"AddNode",value:function(t,e,i){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new h.h9(0,0,0),n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=new d(new h.h9(t,e,i),s,n);return this.nodes.push(o),o.id=this.nodes.length-1,o}},{key:"AddEdge",value:function(t,e){var i=new r(t,e);return t.edge.push(i),e.edge.push(i),this.edges.push(i),i}},{key:"MouseMove",value:function(t,e){this.mouse.x=t,this.mouse.y=e,console.log("move",t,e)}},{key:"MouseDClick",value:function(t,e){this.mouse.x=t,this.mouse.y=e;var i=this.FindNode(this.mouse);i&&(i.fixed=!i.fixed),console.log("click",t,e)}},{key:"MouseDown",value:function(t,e){this.mouse.x=t,this.mouse.y=e,this.capture=this.FindNode(this.mouse),this.capture&&(this.capture.fixed=!0,this.capture.isCapture=!0),console.log("down",t,e,this.capture)}},{key:"MouseLeftClick",value:function(t,e){console.log("click",t,e,this.capture)}},{key:"MouseUp",value:function(t,e){this.mouse.x=t,this.mouse.y=e,this.capture&&(this.capture.isCapture=!1,this.capture=void 0),console.log("up",t,e)}},{key:"MouseDrag",value:function(t,e){this.mouse.x=t,this.mouse.y=e,this.capture&&(this.capture.v.x=t,this.capture.v.y=e),console.log("drag",t,e)}},{key:"Render",value:function(t){this.dt+=.1,this.Move(this.mouse.x,this.mouse.y,this.mouse.z,this.damping,0,this.timeStep,this.groundZ,1)}},{key:"FindNode",value:function(t){var e,i=(0,s.Z)(this.nodes);try{for(i.s();!(e=i.n()).done;){var n=e.value;if(n.v.Distance(t)<n.m+3)return n}}catch(o){i.e(o)}finally{i.f()}}},{key:"Move",value:function(t,e,i,n){for(var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.01,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-10,d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,l=new h.h9(t,e,i),u=0;u<d;++u){var v,p=(0,s.Z)(this.nodes);try{for(p.s();!(v=p.n()).done;){var c=v.value,f=h.h9.Sub(l,c.v),g=f.Length();f.Unitize(),c.f=h.h9.Add(h.h9.Scale(f,.1*Math.exp(-.1*g*g)),h.h9.Scale(h.h9.YAxis(),o))}}catch(T){p.e(T)}finally{p.f()}var y,m=(0,s.Z)(this.edges);try{for(m.s();!(y=m.n()).done;){var x=y.value;x.ApplySpringForce()}}catch(T){m.e(T)}finally{m.f()}var S,b=(0,s.Z)(this.nodes);try{for(b.s();!(S=b.n()).done;){var k=S.value;k.Move(a,n,r)}}catch(T){b.e(T)}finally{b.f()}}}}]),t}(),r=function(){function t(e,i){(0,n.Z)(this,t),this.n0=void 0,this.n1=void 0,this.targetLength=0,this.springConstant=.8,this.n0=e,this.n1=i,this.targetLength=.95*this.n0.v.Distance(this.n1.v)}return(0,o.Z)(t,[{key:"Render",value:function(t){t.strokeStyle="#ff0000",h.h9.Distance(this.n0.v,this.n1.v)<2*this.targetLength&&(t.strokeStyle="#0000ff"),t.beginPath(),t.moveTo(this.n0.v.x,this.n0.v.y),t.lineTo(this.n1.v.x,this.n1.v.y),t.closePath(),t.stroke()}},{key:"ApplySpringForce",value:function(){var t=h.h9.Sub(this.n1.v,this.n0.v),e=t.Length();t.Unitize();var i=h.h9.Scale(t,(e-this.targetLength)*this.springConstant);this.n0.f=h.h9.Add(this.n0.f,i),this.n1.f=h.h9.Sub(this.n1.f,i)}}]),t}(),d=function(){function t(e,i,s){(0,n.Z)(this,t),this.id=-1,this.edge=[],this.nNodes=[],this.v=h.h9.Origin(),this.f=h.h9.Origin(),this.u=h.h9.Origin(),this.m=0,this.fixed=!1,this.isCapture=!1,this.v=new h.h9(e.x,e.y,e.z),this.u=new h.h9(i.x,i.y,i.z),this.m=s}return(0,o.Z)(t,[{key:"Move",value:function(t,e){if(!this.fixed&&!this.isCapture){this.u.Mult(e),this.u.Add(h.h9.Scale(this.f,t/this.m));var i=h.h9.Scale(this.u,t);this.v.x+=i.x,this.v.y+=i.y}}},{key:"Render",value:function(t,e){t.beginPath(),e.Distance(this.v)<this.m+3?(t.fillStyle="#000000",t.arc(this.v.x,this.v.y,this.m+6,0,2*Math.PI)):(t.fillStyle="#f90000",t.arc(this.v.x,this.v.y,this.m+3,0,2*Math.PI)),this.fixed&&(t.fillStyle="#000000",t.arc(this.v.x,this.v.y,this.m+7.5,0,2*Math.PI)),t.closePath(),t.fill()}}]),t}()},61736:function(t,e,i){i.r(e),i.d(e,{Solution:function(){return v},easingMotion:function(){return p}});var s=i(15671),n=i(43144),o=i(97326),h=i(60136),a=i(29388),r=i(17760),d=i(26943),l=i(82405),u=i(46690),v=function(t){(0,h.Z)(i,t);var e=(0,a.Z)(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";(0,s.Z)(this,i),(t=e.call(this,n)).pointLight=void 0,t.pointer=new r.FM8,t.raycaster=new r.iMs,t.sphere=void 0,t.lines=[],t.linesIndex=[],t.mesh=void 0,t.lookupClass=[],t.lookupTable={},t.graph=void 0,t.needInterpolation=!0,t.preSelLine=void 0,t.ui=void 0,t.idLookupTable=void 0,t.cameraAni=new r.Pa4(0,100,100),t.ui=new l.UI((0,o.Z)(t)),t.camera.position.set(0,400,400);var h=new r.Mig(13421772,.25);t.scene.add(h),t.pointLight=new r.cek(16777215,.75),t.pointLight.position.x=10,t.pointLight.castShadow=!0,t.scene.add(t.pointLight),t.raycaster=new r.iMs,t.raycaster.params.Points.threshold=.4,t.raycaster.far=1e3;var a=new r.xo$(.1,32,32),v=new r.vBJ({color:16777215}),p=new r.Kj0(a,v);return t.sphere=p,t.scene.add(p),t.graph=new u.Graph,(0,d.Vu)("/njs-lab-public/static/data/smDataViz.csv").then((function(e){for(var i=e.split(/\r\n|\r|\n/g),s=[],n=[],o=[],h={},a=0;a<i.length;++a){var l=i[a].split(","),u=.1*+l[0],v=.1*+l[1],p=.1*+l[2];s.push(u,v,p),t.graph.AddNode(u,v,p),n.push(.5,.5,.5);var c=l[3];o.push(c);for(var f={},g=4;g<l.length;g+=2){var y=l[g].split("(")[1].replaceAll("'",""),m=+l[g+1].split(")")[0];f[y]=m}h[c]={id:a,pos:[u,v,p],neighbor:f}}for(var x=0;x<o.length;++x){var S=h[o[x]].neighbor,b=t.graph.nodes[x];for(var k in S){var T=h[k],w=t.graph.nodes[T.id];t.graph.AddEdge(b,w)}}t.lookupClass=o,t.lookupTable=h;var C=new r.u9r;C.setAttribute("position",new r.a$l(s,3)),C.setAttribute("color",new r.a$l(n,3));var D=new r.UY4({vertexColors:!0,size:2}),I=new r.woe(C,D);C.computeBoundingSphere(),t.scene.add(I),t.mesh=I;for(var L=0;L<t.graph.nodes.length;++L){for(var z=t.graph.nodes[L].edge,Z=new r.u9r,M=new r.FT0({color:3355443,dashSize:.071,gapSize:.5,opacity:1e-4}),A=[],E=0;E<z.length;E++){var N=z[E].n0,B=z[E].n1;A.push(N.v.x,N.v.y,N.v.z),A.push(B.v.x,B.v.y,B.v.z)}Z.setAttribute("position",new r.a$l(A,3)),Z.computeBoundingSphere();var U=new r.ejS(Z,M);U.computeLineDistances(),t.scene.add(U),t.lines.push(U)}(0,d._N)("/njs-lab-public/static/data/smIDLookUpTable.json").then((function(e){t.idLookupTable=JSON.parse(JSON.stringify(e)),t.start()}))})),t}return(0,n.Z)(i,[{key:"mouseMove",value:function(t){this.pointer.x=t.offsetX/this.hostDiv.clientWidth*2-1,this.pointer.y=-t.offsetY/this.hostDiv.clientHeight*2+1}},{key:"mouseDown",value:function(t){this.pointer.x=t.offsetX/this.hostDiv.clientWidth*2-1,this.pointer.y=-t.offsetY/this.hostDiv.clientHeight*2+1,this.raycaster.setFromCamera(this.pointer,this.camera);var e=this.raycaster.intersectObjects([this.mesh],!1),i=e.length>0?e[0]:null;if(null!==i){this.sphere.position.set(i.point.x,i.point.y+1,i.point.z),this.graph.shrinkage(i.index);var s=this.lookupClass[i.index];this.ui.updateSubID(this.idLookupTable[s])}}},{key:"mouseClick",value:function(t){this.needInterpolation=!0}},{key:"update",value:function(t){this.graph.Render();for(var e=this.mesh.geometry.attributes.position.count,i=0;i<e;i++){this.mesh.geometry.attributes.position;var s=this.graph.nodes[i].v.x,n=this.graph.nodes[i].v.y,o=this.graph.nodes[i].v.z;this.mesh.geometry.attributes.position.setXYZ(i,s,n,o),this.mesh.geometry.attributes.color.setXYZ(i,.3,.3,.3)}this.raycaster.setFromCamera(this.pointer,this.camera);var h=this.raycaster.intersectObjects([this.mesh],!1),a=h.length>0?h[0]:null;if(null!==a){this.sphere.position.set(a.point.x,a.point.y,a.point.z);var r=this.lookupClass[a.index],d=this.lookupTable[r];for(var l in this.ui.divTitle.textContent="Keyword: "+r,this.ui.updateSub(d.neighbor),this.mesh.geometry.attributes.color.setXYZ(a.index,0,1,1),d.neighbor){var u=this.lookupTable[l];this.mesh.geometry.attributes.color.setXYZ(u.id,1,1,0)}}this.mesh.geometry.attributes.position.needsUpdate=!0,this.mesh.geometry.attributes.color.needsUpdate=!0,this.mesh.geometry.computeVertexNormals();for(var v=0;v<this.graph.nodes.length;++v){for(var p=this.graph.nodes[v].edge,c=this.lines[v],f=[],g=0;g<p.length;g++){var y=p[g].n0,m=p[g].n1;f.push(y.v.x,y.v.y,y.v.z),f.push(m.v.x,m.v.y,m.v.z)}for(var x=0,S=0;S<f.length;S+=6)c.geometry.attributes.position.setXYZ(x++,f[S],f[S+1],f[S+2]),c.geometry.attributes.position.setXYZ(x++,f[S+3],f[S+4],f[S+5]);c.geometry.attributes.position.needsUpdate=!0}if(null!==a){if(void 0!==this.preSelLine)this.preSelLine.material.color.setRGB(.3,.3,.3),this.preSelLine=void 0;var b=a.index,k=this.lines[b].material;k.linewidth=1,k.dashSize=.3,this.lines[b].computeLineDistances(),k.color.setRGB(0,1,1),this.preSelLine=this.lines[b]}else if(void 0!==this.preSelLine){var T=this.preSelLine.material;T.dashSize=.071,T.linewidth=.1,this.preSelLine.computeLineDistances(),T.color.setRGB(.3,.3,.3),this.preSelLine=void 0}this.CameraInterpolation()}},{key:"CameraInterpolation",value:function(){if(this.needInterpolation){var t=p(this.camera.position,this.cameraAni);this.camera.position.set(t.x,t.y,t.z),this.camera.position.distanceTo(this.cameraAni)<1&&(this.needInterpolation=!1)}}}]),i}(d.TF),p=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.15,s=new r.Pa4(e.x-t.x,e.y-t.y,e.z-t.z);return new r.Pa4(t.x+s.x*i,t.y+s.y*i,t.z+s.z*i)}},82405:function(t,e,i){i.r(e),i.d(e,{UI:function(){return o}});var s=i(15671),n=i(43144),o=function(){function t(e){(0,s.Z)(this,t),this.solution=void 0,this.divTitle=void 0,this.divSub=void 0,this.divSubs=[],this.divSubID=void 0,this.divSubIDs=[],this.solution=e,this.initUI()}return(0,n.Z)(t,[{key:"initUI",value:function(){this.divTitle=document.createElement("div"),this.solution.hostDiv.insertBefore(this.divTitle,this.solution.renderer.domElement),this.divTitle.textContent="Storymaps Metrics from Jan 24-2020",this.divTitle.style.color="#fff",this.divTitle.style.fontSize="64px",this.divTitle.style.position="absolute",this.divTitle.style.padding="20px",this.divTitle.style.zIndex="1",this.divTitle.style.paddingBottom="10px";var t=document.createElement("div");this.solution.hostDiv.appendChild(t),t.style.position="absolute",t.style.padding="20px",t.style.padding="20px",t.style.marginTop="100px",this.divTitle=document.createElement("div"),t.appendChild(this.divTitle),this.divTitle.textContent="TSNE Visualization ",this.divTitle.style.fontSize="20px",this.divTitle.style.pointerEvents="none",this.divTitle.style.paddingBottom="10px",this.divTitle=document.createElement("div"),t.appendChild(this.divTitle),this.divTitle.textContent="Keyword: ",this.divTitle.style.color="#0ff",this.divTitle.style.fontSize="38px",this.divTitle.style.pointerEvents="none",this.divTitle.style.paddingBottom="10px",this.divSub=document.createElement("div"),t.appendChild(this.divSub),this.divSub.textContent="Neighbors:",this.divSub.style.paddingTop="5px",this.divSub.style.paddingBottom="18px";for(var e=0;e<10;++e){var i=document.createElement("div");i.textContent="",i.style.pointerEvents="none",i.style.paddingTop="5px",i.style.color="#cc0",this.divSubs.push(i),this.divSub.appendChild(i)}this.divSubID=document.createElement("div"),t.appendChild(this.divSubID),this.divSubID.textContent="Storymaps ID:",this.divSubID.style.paddingTop="8px",this.divSubID.style.paddingBottom="8px";for(var s=0;s<10;++s){var n=document.createElement("div");n.textContent="",this.divSubIDs.push(n),this.divSubID.appendChild(n)}}},{key:"updateSub",value:function(t){var e=0;for(var i in t)this.divSubs[e++].textContent=i}},{key:"updateSubID",value:function(t){try{for(var e=0,i=0;i<t.length;++i)this.divSubIDs[e++].innerHTML='<a href="https://storymaps.arcgis.com/stories/'.concat(t[i],'" style="font-size: 14px;" target="_blank" > ID: ').concat(t[i],"</a>")}catch(s){}}}]),t}()}}]);
//# sourceMappingURL=1736.0ec25f42.chunk.js.map