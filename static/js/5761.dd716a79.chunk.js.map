{"version":3,"file":"static/js/5761.dd716a79.chunk.js","mappings":"yOAKO,IAAKA,GAGX,SAHWA,GAAAA,EAAe,4BAAfA,EAAe,YAG1B,CAHWA,IAAAA,EAAe,KAKpB,MAAMC,EAGTC,YAAYC,GAAe,KAFpBA,aAAO,OACPC,cAAQ,EAEXC,KAAKF,QAAUA,EAGfE,KAAKF,QAAQG,MAAMC,QAAU,OAC7BF,KAAKF,QAAQG,MAAME,WAAa,SAChC,MAAMC,EAAMC,SAASC,cAAc,OACnCF,EAAIH,MAAMM,WAAa,OACvBH,EAAIH,MAAMO,YAAc,OACxBJ,EAAIH,MAAMQ,gBAAkB,OAC5BL,EAAIH,MAAMS,OAAS,OACnBN,EAAIH,MAAMU,WAAa,gBACvBX,KAAKF,QAAQc,YAAYR,GAEzBJ,KAAKD,SAAW,IAAIc,EAAST,EACjC,CACOU,UAEH,IADAd,KAAKD,SAASe,UACPd,KAAKF,QAAQiB,kBAChBf,KAAKF,QAAQkB,YAAYhB,KAAKF,QAAQiB,iBAE9C,EAGG,MAAMF,UAAiBI,EAAAA,GAQ1BpB,YAAYO,GACRc,MAAMd,GAAK,KARfe,SAAoCC,EAAS,KAC7CC,SAAW,EAAI,KACfC,EAAc,CAAC,EAAG,GAAG,KAErBC,QAAS,EAAK,KACdC,aAAc,EAAM,KACpBC,eAAkC9B,EAAgB+B,aAI9C1B,KAAK2B,IAAM3B,KAAK4B,OAAOC,WAAW,KAAM,CAAEC,oBAAoB,IAE9D9B,KAAK4B,OAAO3B,MAAM8B,SAAW,WAC7B/B,KAAK4B,OAAO3B,MAAM+B,MAAQ,OAC1BhC,KAAK4B,OAAO3B,MAAMgC,OAAS,QAG3BC,EAAAA,EAAAA,IAAc,oGAAoGC,MAAMhB,IACpHnB,KAAKmB,IAAMA,EACXnB,KAAKmB,IAAIiB,OAAUC,IACfrC,KAAKsC,OAAOnB,EAAI,CACnB,IAEL,MAAMoB,EAAWlC,SAASC,cAAc,SACxCiC,EAASC,MAAQ,6KACjBD,EAASE,iBAAiB,WAAYC,IACnB,UAAXA,EAAEC,OACFT,EAAAA,EAAAA,IAAcK,EAASC,OAAOL,MAAMhB,IAChCnB,KAAKmB,IAAMA,EACXnB,KAAKmB,IAAIiB,OAAUC,IACfrC,KAAKsC,OAAOnB,EAAI,CACnB,GAET,IAGJnB,KAAKF,QAAQc,YAAY2B,GAEzB,MAAMK,EAAavC,SAASC,cAAc,OAC1CsC,EAAW3C,MAAMC,QAAU,OAC3B0C,EAAW3C,MAAM4C,UAAY,OAC7B7C,KAAKF,QAAQc,YAAYgC,GAGzB,MAAME,EAASC,EAAU,OAAQ,EAAG,GAEpCD,EAAOE,OAAOC,aAAe,IAC7BjD,KAAKF,QAAQc,YAAYkC,EAAO1C,KAChC0C,EAAOE,OAAOE,QAAU,KAGN,IAFAC,SAASL,EAAOE,OAAOR,QAGjCxC,KAAKyB,eAAiB9B,EAAgB+B,aACtCoB,EAAOM,KAAKC,YAAc1D,EAAgB+B,eAE1C1B,KAAKyB,eAAiB9B,EAAgB2D,KACtCR,EAAOM,KAAKC,YAAc1D,EAAgB2D,MAE9CtD,KAAKuD,OAAOvD,KAAK2B,IAAK3B,KAAKyB,eAAe,EAG9C,MAAM+B,EAAmBC,GAAetC,IACpCnB,KAAKmB,IAAMA,EACXnB,KAAK4B,OAAOI,MAAQhC,KAAKmB,IAAIa,MAC7BhC,KAAK4B,OAAOK,OAASjC,KAAKmB,IAAIc,OAC9BjC,KAAKuD,OAAOvD,KAAK2B,IAAK3B,KAAKyB,eAAe,IAE9CmB,EAAWhC,YAAY4C,GAEvB,MAAME,EAAWC,IACjBD,EAASE,SAAW,KAChB5D,KAAKwB,aAAexB,KAAKwB,YACzBxB,KAAKuD,OAAOvD,KAAK2B,IAAK3B,KAAKyB,eAAe,EAE9CmB,EAAWhC,YAAY8C,GAGvB1D,KAAK6D,OACT,CACOvB,OAAOnB,GACVnB,KAAKmB,IAAMA,EACXnB,KAAK4B,OAAOI,MAAQhC,KAAKmB,IAAIa,MAC7BhC,KAAK4B,OAAOK,OAASjC,KAAKmB,IAAIc,OAC9BjC,KAAKuD,OAAOvD,KAAK2B,IAAK3B,KAAKyB,eAC/B,CACO8B,OAAO5B,EAA+BmC,GACzC,QAAiB1C,IAAbpB,KAAKmB,IAAT,CAQA,GAPAQ,EAAIoC,UAAU,EAAG,EAAGpC,EAAIC,OAAOI,MAAOL,EAAIC,OAAOK,QAE7CjC,KAAKmB,KACLnB,KAAK2B,IAAIqC,UAAUhE,KAAKmB,IAAK,EAAG,GAEpCnB,KAAK2B,IAAIsC,UAEDH,IACCnE,EAAgB+B,aCrIJC,KAEzB,MAAMuC,EAAYvC,EAAIwC,aAAa,EAAG,EAAGxC,EAAIC,OAAOI,MAAOL,EAAIC,OAAOK,QAChEmC,EAAOF,EAAUE,KAEjBC,EAAgB,CAACC,EAAGC,EAAGC,IAClB,KAAQF,EAAI,KAAQC,EAAI,KAAQC,EAG3C,IAAIC,EAAgB,EAChBC,EAAkB,EAClBC,EAAc,EACdC,EAAgB,EAEpB,IAAK,IAAIC,EAAI,EAAGA,EAAIT,EAAKU,OAAQD,GAAK,EAAG,CACrC,MAGME,EAAaV,EAHTD,EAAKS,GACLT,EAAKS,EAAI,GACTT,EAAKS,EAAI,IAEnBJ,GAAiBM,EACjBL,IAGAC,GADiBK,KAAKC,IAAIF,EAAa,KAEvCH,GACJ,CAEA,MAGMM,EAAmB,IAHHT,EAAgBC,EAIhCS,EAAiB,KAHHR,EAAcC,GAIlC,IAAK,IAAIC,EAAI,EAAGA,EAAIT,EAAKU,OAAQD,GAAK,EAAG,CACrC,IAAIP,EAAIF,EAAKS,GACTN,EAAIH,EAAKS,EAAI,GACbL,EAAIJ,EAAKS,EAAI,GACjBP,GAAKY,EACLX,GAAKW,EACLV,GAAKU,EACLZ,EAAIU,KAAKI,IAAIJ,KAAKK,IAAIL,KAAKM,MAAMhB,EAAIa,GAAiB,GAAI,KAC1DZ,EAAIS,KAAKI,IAAIJ,KAAKK,IAAIL,KAAKM,MAAMf,EAAIY,GAAiB,GAAI,KAC1DX,EAAIQ,KAAKI,IAAIJ,KAAKK,IAAIL,KAAKM,MAAMd,EAAIW,GAAiB,GAAI,KAC1Df,EAAKS,GAAKP,EACVF,EAAKS,EAAI,GAAKN,EACdH,EAAKS,EAAI,GAAKL,CAClB,CAEA7C,EAAI4D,aAAarB,EAAW,EAAG,EAAE,EDuFrBsB,CAAa7D,GAET3B,KAAKwB,cACLiE,EAAAA,EAAAA,IAAwB9D,QASxB3B,KAAKwB,cACLiE,EAAAA,EAAAA,IAAwB9D,GAMpC3B,KAAK0F,UAAW,CA7BsB,CA8B1C,EAEJ,MAAM3C,EAAY,CAAC4C,EAAeP,EAAaC,KAE3C,MAAMjF,EAAMC,SAASC,cAAc,OACnCF,EAAIH,MAAMC,QAAU,OAEpB,MAAM8C,EAAS3C,SAASC,cAAc,SACtC0C,EAAO4C,KAAO,QACd5C,EAAOoC,IAAG,UAAMA,GAChBpC,EAAOqC,IAAG,UAAMA,GAEhB,MAAMjC,EAAO/C,SAASC,cAAc,OAKpC,OAJA8C,EAAKC,YAAcsC,EACnBvC,EAAKnD,MAAM4F,MAAQ,OACnBzF,EAAIQ,YAAYoC,GAChB5C,EAAIQ,YAAYwC,GACT,CACHhD,MAAK4C,SAAQI,OAChB,EAECK,EAAiBqC,IACnB,MAAMC,EAAY1F,SAASC,cAAc,SAmBzC,OAlBAyF,EAAUH,KAAO,OACjBG,EAAUnC,SAAYlB,IAElB,GAAIA,EAAEsD,OAAOC,MAAO,CAEhB,IAAIC,EAAYxD,EAAEsD,OAAOC,MAAM,GAC/B,IAAIE,EAAS,IAAIC,WACjBD,EAAOE,cAAcH,GACrBC,EAAOG,UAAa5D,IAChB,MAAMvB,EAAM,IAAIoF,MAEhBpF,EAAIqF,IAAM9D,EAAEsD,OAAOS,OACnBtF,EAAIiB,OAAUC,IACVyD,EAAS3E,EAAI,CAChB,CAET,GAEG4E,CAAS,EAEdpC,EAAc,KAChB,MAAMoC,EAAY1F,SAASC,cAAc,SAEzC,OADAyF,EAAUH,KAAO,WACVG,CAAS,C","sources":["njslab/Lab/image-auto-tune/index.ts","njslab/Lab/image-auto-tune/autoContrast.ts"],"sourcesContent":["import { RendererCanvas, getImgFromURL, ditheringFloydSteinberg } from '../../../lib';\r\n// import { } from '../../../'\r\nimport { setData } from '../../DB/FireBase';\r\nimport { autoContrast } from './autoContrast';\r\n\r\nexport enum ColorCorrection {\r\n    AutoContrast = 'autoContrast',\r\n    None = 'None'\r\n}\r\n\r\nexport class Solution {\r\n    public divHost: HTMLElement;\r\n    public renderer: Renderer;\r\n    constructor(divHost: any) {\r\n        this.divHost = divHost;\r\n\r\n        // Center align\r\n        this.divHost.style.display = 'flex';\r\n        this.divHost.style.alignItems = 'center';\r\n        const div = document.createElement('div');\r\n        div.style.marginLeft = 'auto';\r\n        div.style.marginRight = 'auto';\r\n        div.style.backgroundColor = '#555';\r\n        div.style.margin = '50px';\r\n        div.style.background = 'rgba(0,0,0,0)';\r\n        this.divHost.appendChild(div);\r\n\r\n        this.renderer = new Renderer(div);\r\n    }\r\n    public destroy() {\r\n        this.renderer.destroy();\r\n        while (this.divHost.lastElementChild) {\r\n            this.divHost.removeChild(this.divHost.lastElementChild);\r\n        }\r\n    }\r\n}\r\n\r\nexport class Renderer extends RendererCanvas {\r\n    img: HTMLImageElement | undefined = undefined\r\n    rotation = 0.0;\r\n    m: number[] = [0, 0];\r\n\r\n    switch = true;\r\n    isDithering = false;\r\n    typeCorrection: ColorCorrection = ColorCorrection.AutoContrast;\r\n    constructor(div: any) {\r\n        super(div);\r\n\r\n        this.ctx = this.canvas.getContext('2d', { willReadFrequently: true }) as CanvasRenderingContext2D;\r\n\r\n        this.canvas.style.position = 'relative';\r\n        this.canvas.style.width = '100%';\r\n        this.canvas.style.height = '100%';\r\n\r\n        // getImgFromURL('https://raw.githubusercontent.com/NamjuLee/data/master/img/person/HaminHaram.jpg').then( (img: HTMLImageElement) => {\r\n        getImgFromURL('https://www.glenstone.org/wp-content/uploads/2018/07/AV_Landscape-Hero-Contour-2993-1276x800.jpg').then((img: HTMLImageElement) => {\r\n            this.img = img;\r\n            this.img.onload = (ev) => {\r\n                this.update(img);\r\n            }\r\n        });\r\n        const divInput = document.createElement('input');\r\n        divInput.value = 'https://media.istockphoto.com/id/664494334/photo/closeup-young-smiling-woman-face-isolated-on-white.jpg?s=612x612&w=is&k=20&c=Nni6E0gDKxCDnT66c66t1vVfawzCQEc0B8taMlItvZM=';\r\n        divInput.addEventListener('keydown', (e: KeyboardEvent) => {\r\n            if (e.code === 'Enter') {\r\n                getImgFromURL(divInput.value).then((img: HTMLImageElement) => {\r\n                    this.img = img;\r\n                    this.img.onload = (ev) => {\r\n                        this.update(img);\r\n                    }\r\n                });\r\n            }\r\n\r\n        })\r\n        this.divHost.appendChild(divInput);\r\n\r\n        const divMain_01 = document.createElement('div');\r\n        divMain_01.style.display = 'flex';\r\n        divMain_01.style.marginTop = '15px';\r\n        this.divHost.appendChild(divMain_01);\r\n\r\n\r\n        const slType = getSlider('auto', 0, 1);\r\n\r\n        slType.slider.defaultValue = '0';\r\n        this.divHost.appendChild(slType.div);\r\n        slType.slider.oninput = () => {\r\n            const value = parseInt(slType.slider.value);\r\n\r\n            if (value === 0) {\r\n                this.typeCorrection = ColorCorrection.AutoContrast;\r\n                slType.text.textContent = ColorCorrection.AutoContrast;\r\n            } else {\r\n                this.typeCorrection = ColorCorrection.None;\r\n                slType.text.textContent = ColorCorrection.None;\r\n            }\r\n            this.render(this.ctx, this.typeCorrection);\r\n        };\r\n\r\n        const divButtonImgLoad = buttonImgLoad((img: HTMLImageElement) => {\r\n            this.img = img;\r\n            this.canvas.width = this.img.width;\r\n            this.canvas.height = this.img.height;\r\n            this.render(this.ctx, this.typeCorrection);\r\n        });\r\n        divMain_01.appendChild(divButtonImgLoad);\r\n\r\n        const checkBox = getCheckBox();\r\n        checkBox.onchange = () => {\r\n            this.isDithering = !this.isDithering;\r\n            this.render(this.ctx, this.typeCorrection);\r\n        }\r\n        divMain_01.appendChild(checkBox);\r\n\r\n\r\n        this.start();\r\n    }\r\n    public update(img: HTMLImageElement) {\r\n        this.img = img;\r\n        this.canvas.width = this.img.width;\r\n        this.canvas.height = this.img.height;\r\n        this.render(this.ctx, this.typeCorrection);\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D, typeDitheringType?: ColorCorrection): void {\r\n        if (this.img === undefined) { return; }\r\n        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n\r\n        if (this.img) {\r\n            this.ctx.drawImage(this.img, 0, 0);\r\n        }\r\n        this.ctx.restore();\r\n\r\n        switch (typeDitheringType) {\r\n            case ColorCorrection.AutoContrast:\r\n                autoContrast(ctx);\r\n\r\n                if (this.isDithering) {\r\n                    ditheringFloydSteinberg(ctx);\r\n                }\r\n                // ditheringFloydSteinberg(ctx);\r\n                // DitheringFloyd.make(ctx);\r\n                break;\r\n            // case AutoContrast.BayerOrderedDithering:\r\n                // dithering4_4(ctx);\r\n                // break;\r\n            default:\r\n                if (this.isDithering) {\r\n                    ditheringFloydSteinberg(ctx);\r\n                }\r\n                break;\r\n        }\r\n\r\n        // !! can stop render after this frame.\r\n        this.isStatic = true;\r\n    }\r\n}\r\nconst getSlider = (title: string, min: number, max: number) => {\r\n    // <input type=\"range\" min=\"1\" max=\"100\" value=\"50\" class=\"slider\" id=\"myRange\">\r\n    const div = document.createElement('div');\r\n    div.style.display = 'flex';\r\n\r\n    const slider = document.createElement('input');\r\n    slider.type = 'range';\r\n    slider.min = `${min}`;\r\n    slider.max = `${max}`;\r\n\r\n    const text = document.createElement('div');\r\n    text.textContent = title;\r\n    text.style.color = '#aaa';\r\n    div.appendChild(slider);\r\n    div.appendChild(text);\r\n    return {\r\n        div, slider, text\r\n    }\r\n};\r\nconst buttonImgLoad = (callback: (img: HTMLImageElement) => void) => {\r\n    const inputFile = document.createElement('input');\r\n    inputFile.type = 'file';\r\n    inputFile.onchange = (e) => {\r\n        //@ts-ignore\r\n        if (e.target.files) {\r\n            //@ts-ignore\r\n            let imageFile = e.target.files[0]; //here we get the image file\r\n            var reader = new FileReader();\r\n            reader.readAsDataURL(imageFile);\r\n            reader.onloadend = (e) => {\r\n                const img = new Image(); // Creates image object\r\n                //@ts-ignore\r\n                img.src = e.target.result; // Assigns converted image to image object\r\n                img.onload = (ev) => {\r\n                    callback(img);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return inputFile;\r\n};\r\nconst getCheckBox = () => {\r\n    const inputFile = document.createElement('input');\r\n    inputFile.type = 'checkbox';\r\n    return inputFile;\r\n};","export const autoContrast = (ctx: CanvasRenderingContext2D) => {\n\n    const imageData = ctx.getImageData(0, 0, ctx.canvas.width, ctx.canvas.height);\n    const data = imageData.data;\n\n    const getBrightness = (r, g, b) => {\n        return 0.299 * r + 0.587 * g + 0.114 * b;\n    }\n\n    let brightnessSum = 0;\n    let brightnessCount = 0;\n    let contrastSum = 0;\n    let contrastCount = 0;\n\n    for (let i = 0; i < data.length; i += 4) {\n        const r = data[i];\n        const g = data[i + 1];\n        const b = data[i + 2];\n        const brightness = getBrightness(r, g, b);\n        brightnessSum += brightness;\n        brightnessCount++;\n\n        const contrast = Math.abs(brightness - 128);\n        contrastSum += contrast;\n        contrastCount++;\n    }\n\n    const brightnessAvg = brightnessSum / brightnessCount;\n    const contrastAvg = contrastSum / contrastCount;\n\n    const brightnessFactor = 128 - brightnessAvg;\n    const contrastFactor = 128 / contrastAvg;\n    for (let i = 0; i < data.length; i += 4) {\n        let r = data[i];\n        let g = data[i + 1];\n        let b = data[i + 2];\n        r += brightnessFactor;\n        g += brightnessFactor;\n        b += brightnessFactor;\n        r = Math.min(Math.max(Math.round(r * contrastFactor), 0), 255);\n        g = Math.min(Math.max(Math.round(g * contrastFactor), 0), 255);\n        b = Math.min(Math.max(Math.round(b * contrastFactor), 0), 255);\n        data[i] = r;\n        data[i + 1] = g;\n        data[i + 2] = b;\n    }\n\n    ctx.putImageData(imageData, 0, 0)\n    // var outputImg = document.createElement('img');\n    // outputImg.src = ctx.canvas.toDataURL();\n    // document.body.appendChild(outputImg);\n\n    // img.src = 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTFrr_PyLstPq8n38kb5Dap2ejPb7B9IreQYw&usqp=CAU';\n    // img.src = 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSMBj1TbiAQDjCAtXgTRuZKb82qOem2vUosVw&usqp=CAU';\n\n    // img.src = 'https://media.istockphoto.com/id/664494334/photo/closeup-young-smiling-woman-face-isolated-on-white.jpg?s=612x612&w=is&k=20&c=Nni6E0gDKxCDnT66c66t1vVfawzCQEc0B8taMlItvZM=';\n\n\n    // img.src = 'https://raw.githubusercontent.com/NamjuLee/data/master/img/person/HaminHaram_01.jpg'\n}"],"names":["ColorCorrection","Solution","constructor","divHost","renderer","this","style","display","alignItems","div","document","createElement","marginLeft","marginRight","backgroundColor","margin","background","appendChild","Renderer","destroy","lastElementChild","removeChild","RendererCanvas","super","img","undefined","rotation","m","switch","isDithering","typeCorrection","AutoContrast","ctx","canvas","getContext","willReadFrequently","position","width","height","getImgFromURL","then","onload","ev","update","divInput","value","addEventListener","e","code","divMain_01","marginTop","slType","getSlider","slider","defaultValue","oninput","parseInt","text","textContent","None","render","divButtonImgLoad","buttonImgLoad","checkBox","getCheckBox","onchange","start","typeDitheringType","clearRect","drawImage","restore","imageData","getImageData","data","getBrightness","r","g","b","brightnessSum","brightnessCount","contrastSum","contrastCount","i","length","brightness","Math","abs","brightnessFactor","contrastFactor","min","max","round","putImageData","autoContrast","ditheringFloydSteinberg","isStatic","title","type","color","callback","inputFile","target","files","imageFile","reader","FileReader","readAsDataURL","onloadend","Image","src","result"],"sourceRoot":""}